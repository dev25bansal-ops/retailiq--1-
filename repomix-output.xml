This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
eslint.config.js
index.html
package.json
public/vite.svg
README.md
src/App.css
src/App.tsx
src/assets/react.svg
src/components/layout/AppLayout.tsx
src/components/layout/index.ts
src/components/layout/Sidebar.tsx
src/components/layout/TopBar.tsx
src/data/sampleData.ts
src/index.css
src/main.tsx
src/pages/AlertsPage.tsx
src/pages/ChatPage.tsx
src/pages/CompetitiveIntel.tsx
src/pages/ConsumerDashboard.tsx
src/pages/FestivalDeals.tsx
src/pages/MSMEDashboard.tsx
src/pages/PriceHistory.tsx
src/pages/PricingStrategy.tsx
src/pages/ProductTracking.tsx
src/theme/theme.ts
src/types/index.ts
src/utils/chatResponses.ts
src/utils/formatters.ts
tsconfig.app.json
tsconfig.json
tsconfig.node.json
vite.config.ts
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path=".gitignore">
# Logs
logs
*.log
npm-debug.log*
yarn-debug.log*
yarn-error.log*
pnpm-debug.log*
lerna-debug.log*

node_modules
dist
dist-ssr
*.local

# Editor directories and files
.vscode/*
!.vscode/extensions.json
.idea
.DS_Store
*.suo
*.ntvs*
*.njsproj
*.sln
*.sw?
</file>

<file path="eslint.config.js">
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
  },
])
</file>

<file path="index.html">
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RetailIQ - AI-Powered Retail Intelligence for India</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
</file>

<file path="package.json">
{
  "name": "retailiq",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@emotion/react": "^11.14.0",
    "@emotion/styled": "^11.14.1",
    "@mui/icons-material": "^7.3.8",
    "@mui/lab": "^7.0.1-beta.22",
    "@mui/material": "^7.3.8",
    "chart.js": "^4.4.6",
    "react": "^18.3.1",
    "react-chartjs-2": "^5.3.1",
    "react-dom": "^18.3.1",
    "react-router-dom": "^6.30.3"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/node": "^24.10.1",
    "@types/react": "^18.3.28",
    "@types/react-dom": "^18.3.7",
    "@vitejs/plugin-react": "^5.1.4",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "typescript": "~5.9.3",
    "typescript-eslint": "^8.48.0",
    "vite": "^7.3.1"
  }
}
</file>

<file path="public/vite.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="31.88" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 257"><defs><linearGradient id="IconifyId1813088fe1fbc01fb466" x1="-.828%" x2="57.636%" y1="7.652%" y2="78.411%"><stop offset="0%" stop-color="#41D1FF"></stop><stop offset="100%" stop-color="#BD34FE"></stop></linearGradient><linearGradient id="IconifyId1813088fe1fbc01fb467" x1="43.376%" x2="50.316%" y1="2.242%" y2="89.03%"><stop offset="0%" stop-color="#FFEA83"></stop><stop offset="8.333%" stop-color="#FFDD35"></stop><stop offset="100%" stop-color="#FFA800"></stop></linearGradient></defs><path fill="url(#IconifyId1813088fe1fbc01fb466)" d="M255.153 37.938L134.897 252.976c-2.483 4.44-8.862 4.466-11.382.048L.875 37.958c-2.746-4.814 1.371-10.646 6.827-9.67l120.385 21.517a6.537 6.537 0 0 0 2.322-.004l117.867-21.483c5.438-.991 9.574 4.796 6.877 9.62Z"></path><path fill="url(#IconifyId1813088fe1fbc01fb467)" d="M185.432.063L96.44 17.501a3.268 3.268 0 0 0-2.634 3.014l-5.474 92.456a3.268 3.268 0 0 0 3.997 3.378l24.777-5.718c2.318-.535 4.413 1.507 3.936 3.838l-7.361 36.047c-.495 2.426 1.782 4.5 4.151 3.78l15.304-4.649c2.372-.72 4.652 1.36 4.15 3.788l-11.698 56.621c-.732 3.542 3.979 5.473 5.943 2.437l1.313-2.028l72.516-144.72c1.215-2.423-.88-5.186-3.54-4.672l-25.505 4.922c-2.396.462-4.435-1.77-3.759-4.114l16.646-57.705c.677-2.35-1.37-4.583-3.769-4.113Z"></path></svg>
</file>

<file path="README.md">
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) (or [oxc](https://oxc.rs) when used in [rolldown-vite](https://vite.dev/guide/rolldown)) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## React Compiler

The React Compiler is not enabled on this template because of its impact on dev & build performances. To add it, see [this documentation](https://react.dev/learn/react-compiler/installation).

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...

      // Remove tseslint.configs.recommended and replace with this
      tseslint.configs.recommendedTypeChecked,
      // Alternatively, use this for stricter rules
      tseslint.configs.strictTypeChecked,
      // Optionally, add this for stylistic rules
      tseslint.configs.stylisticTypeChecked,

      // Other configs...
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...
      // Enable lint rules for React
      reactX.configs['recommended-typescript'],
      // Enable lint rules for React DOM
      reactDom.configs.recommended,
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```
</file>

<file path="src/App.css">
/* RetailIQ - Global Application Styles */

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-20px); }
  to { opacity: 1; transform: translateX(0); }
}

@keyframes shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

.page-enter {
  animation: fadeInUp 0.35s cubic-bezier(0.22, 1, 0.36, 1) forwards;
}

.stagger-children > * {
  opacity: 0;
  animation: fadeInUp 0.4s cubic-bezier(0.22, 1, 0.36, 1) forwards;
}
.stagger-children > *:nth-child(1) { animation-delay: 0.04s; }
.stagger-children > *:nth-child(2) { animation-delay: 0.08s; }
.stagger-children > *:nth-child(3) { animation-delay: 0.12s; }
.stagger-children > *:nth-child(4) { animation-delay: 0.16s; }
.stagger-children > *:nth-child(5) { animation-delay: 0.2s; }
.stagger-children > *:nth-child(6) { animation-delay: 0.24s; }
.stagger-children > *:nth-child(7) { animation-delay: 0.28s; }
.stagger-children > *:nth-child(8) { animation-delay: 0.32s; }

.gradient-text {
  background: linear-gradient(135deg, #1a237e 0%, #534bae 50%, #ff6f00 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

*:focus-visible {
  outline: 2px solid #534bae;
  outline-offset: 2px;
  border-radius: 4px;
}

@media (prefers-reduced-motion: reduce) {
  .page-enter,
  .stagger-children > * {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
  }
}
</file>

<file path="src/App.tsx">
import { useState, useEffect } from 'react';
import { BrowserRouter as Router, Routes, Route, Navigate, useLocation, useNavigate } from 'react-router-dom';
import { AppLayout } from './components/layout';
import ConsumerDashboard from './pages/ConsumerDashboard';
import ProductTracking from './pages/ProductTracking';
import PriceHistory from './pages/PriceHistory';
import ChatPage from './pages/ChatPage';
import AlertsPage from './pages/AlertsPage';
import FestivalDeals from './pages/FestivalDeals';
import MSMEDashboard from './pages/MSMEDashboard';
import PricingStrategy from './pages/PricingStrategy';
import CompetitiveIntel from './pages/CompetitiveIntel';
import type { ViewMode } from './types';
import { sampleAlerts } from './data/sampleData';

function AppRoutes() {
  const [viewMode, setViewMode] = useState<ViewMode>('consumer');
  const unreadAlerts = sampleAlerts.filter((a) => !a.read).length;
  const location = useLocation();
  const navigate = useNavigate();

  useEffect(() => {
    if (viewMode === 'consumer' && location.pathname.startsWith('/msme')) {
      navigate('/consumer/dashboard', { replace: true });
    } else if (viewMode === 'msme' && location.pathname.startsWith('/consumer')) {
      navigate('/msme/dashboard', { replace: true });
    }
  }, [viewMode]);

  return (
    <Routes>
      <Route
        element={
          <AppLayout
            viewMode={viewMode}
            onViewModeChange={setViewMode}
            notificationCount={unreadAlerts}
          />
        }
      >
        {/* Consumer Routes */}
        <Route path="/consumer/dashboard" element={<ConsumerDashboard />} />
        <Route path="/consumer/track" element={<ProductTracking />} />
        <Route path="/consumer/history" element={<PriceHistory />} />
        <Route path="/consumer/chat" element={<ChatPage />} />
        <Route path="/consumer/alerts" element={<AlertsPage />} />
        <Route path="/consumer/festivals" element={<FestivalDeals />} />

        {/* MSME Routes */}
        <Route path="/msme/dashboard" element={<MSMEDashboard />} />
        <Route path="/msme/pricing" element={<PricingStrategy />} />
        <Route path="/msme/competitive" element={<CompetitiveIntel />} />
        <Route path="/msme/reports" element={<MSMEDashboard />} />
        <Route path="/msme/settings" element={<MSMEDashboard />} />

        {/* Default redirect */}
        <Route path="/" element={<Navigate to="/consumer/dashboard" replace />} />
        <Route path="*" element={<Navigate to="/consumer/dashboard" replace />} />
      </Route>
    </Routes>
  );
}

function App() {
  return (
    <Router>
      <AppRoutes />
    </Router>
  );
}

export default App;
</file>

<file path="src/assets/react.svg">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--logos" width="35.93" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 228"><path fill="#00D8FF" d="M210.483 73.824a171.49 171.49 0 0 0-8.24-2.597c.465-1.9.893-3.777 1.273-5.621c6.238-30.281 2.16-54.676-11.769-62.708c-13.355-7.7-35.196.329-57.254 19.526a171.23 171.23 0 0 0-6.375 5.848a155.866 155.866 0 0 0-4.241-3.917C100.759 3.829 77.587-4.822 63.673 3.233C50.33 10.957 46.379 33.89 51.995 62.588a170.974 170.974 0 0 0 1.892 8.48c-3.28.932-6.445 1.924-9.474 2.98C17.309 83.498 0 98.307 0 113.668c0 15.865 18.582 31.778 46.812 41.427a145.52 145.52 0 0 0 6.921 2.165a167.467 167.467 0 0 0-2.01 9.138c-5.354 28.2-1.173 50.591 12.134 58.266c13.744 7.926 36.812-.22 59.273-19.855a145.567 145.567 0 0 0 5.342-4.923a168.064 168.064 0 0 0 6.92 6.314c21.758 18.722 43.246 26.282 56.54 18.586c13.731-7.949 18.194-32.003 12.4-61.268a145.016 145.016 0 0 0-1.535-6.842c1.62-.48 3.21-.974 4.76-1.488c29.348-9.723 48.443-25.443 48.443-41.52c0-15.417-17.868-30.326-45.517-39.844Zm-6.365 70.984c-1.4.463-2.836.91-4.3 1.345c-3.24-10.257-7.612-21.163-12.963-32.432c5.106-11 9.31-21.767 12.459-31.957c2.619.758 5.16 1.557 7.61 2.4c23.69 8.156 38.14 20.213 38.14 29.504c0 9.896-15.606 22.743-40.946 31.14Zm-10.514 20.834c2.562 12.94 2.927 24.64 1.23 33.787c-1.524 8.219-4.59 13.698-8.382 15.893c-8.067 4.67-25.32-1.4-43.927-17.412a156.726 156.726 0 0 1-6.437-5.87c7.214-7.889 14.423-17.06 21.459-27.246c12.376-1.098 24.068-2.894 34.671-5.345a134.17 134.17 0 0 1 1.386 6.193ZM87.276 214.515c-7.882 2.783-14.16 2.863-17.955.675c-8.075-4.657-11.432-22.636-6.853-46.752a156.923 156.923 0 0 1 1.869-8.499c10.486 2.32 22.093 3.988 34.498 4.994c7.084 9.967 14.501 19.128 21.976 27.15a134.668 134.668 0 0 1-4.877 4.492c-9.933 8.682-19.886 14.842-28.658 17.94ZM50.35 144.747c-12.483-4.267-22.792-9.812-29.858-15.863c-6.35-5.437-9.555-10.836-9.555-15.216c0-9.322 13.897-21.212 37.076-29.293c2.813-.98 5.757-1.905 8.812-2.773c3.204 10.42 7.406 21.315 12.477 32.332c-5.137 11.18-9.399 22.249-12.634 32.792a134.718 134.718 0 0 1-6.318-1.979Zm12.378-84.26c-4.811-24.587-1.616-43.134 6.425-47.789c8.564-4.958 27.502 2.111 47.463 19.835a144.318 144.318 0 0 1 3.841 3.545c-7.438 7.987-14.787 17.08-21.808 26.988c-12.04 1.116-23.565 2.908-34.161 5.309a160.342 160.342 0 0 1-1.76-7.887Zm110.427 27.268a347.8 347.8 0 0 0-7.785-12.803c8.168 1.033 15.994 2.404 23.343 4.08c-2.206 7.072-4.956 14.465-8.193 22.045a381.151 381.151 0 0 0-7.365-13.322Zm-45.032-43.861c5.044 5.465 10.096 11.566 15.065 18.186a322.04 322.04 0 0 0-30.257-.006c4.974-6.559 10.069-12.652 15.192-18.18ZM82.802 87.83a323.167 323.167 0 0 0-7.227 13.238c-3.184-7.553-5.909-14.98-8.134-22.152c7.304-1.634 15.093-2.97 23.209-3.984a321.524 321.524 0 0 0-7.848 12.897Zm8.081 65.352c-8.385-.936-16.291-2.203-23.593-3.793c2.26-7.3 5.045-14.885 8.298-22.6a321.187 321.187 0 0 0 7.257 13.246c2.594 4.48 5.28 8.868 8.038 13.147Zm37.542 31.03c-5.184-5.592-10.354-11.779-15.403-18.433c4.902.192 9.899.29 14.978.29c5.218 0 10.376-.117 15.453-.343c-4.985 6.774-10.018 12.97-15.028 18.486Zm52.198-57.817c3.422 7.8 6.306 15.345 8.596 22.52c-7.422 1.694-15.436 3.058-23.88 4.071a382.417 382.417 0 0 0 7.859-13.026a347.403 347.403 0 0 0 7.425-13.565Zm-16.898 8.101a358.557 358.557 0 0 1-12.281 19.815a329.4 329.4 0 0 1-23.444.823c-7.967 0-15.716-.248-23.178-.732a310.202 310.202 0 0 1-12.513-19.846h.001a307.41 307.41 0 0 1-10.923-20.627a310.278 310.278 0 0 1 10.89-20.637l-.001.001a307.318 307.318 0 0 1 12.413-19.761c7.613-.576 15.42-.876 23.31-.876H128c7.926 0 15.743.303 23.354.883a329.357 329.357 0 0 1 12.335 19.695a358.489 358.489 0 0 1 11.036 20.54a329.472 329.472 0 0 1-11 20.722Zm22.56-122.124c8.572 4.944 11.906 24.881 6.52 51.026c-.344 1.668-.73 3.367-1.15 5.09c-10.622-2.452-22.155-4.275-34.23-5.408c-7.034-10.017-14.323-19.124-21.64-27.008a160.789 160.789 0 0 1 5.888-5.4c18.9-16.447 36.564-22.941 44.612-18.3ZM128 90.808c12.625 0 22.86 10.235 22.86 22.86s-10.235 22.86-22.86 22.86s-22.86-10.235-22.86-22.86s10.235-22.86 22.86-22.86Z"></path></svg>
</file>

<file path="src/components/layout/AppLayout.tsx">
import React, { useState } from 'react';
import {
  Box,
  Toolbar,
  useTheme,
  useMediaQuery,
  BottomNavigation,
  BottomNavigationAction,
  Paper,
} from '@mui/material';
import {
  Dashboard as DashboardIcon,
  TrackChanges as TrackChangesIcon,
  ShowChart as ShowChartIcon,
  SmartToy as SmartToyIcon,
  Notifications as NotificationsIcon,
  AttachMoney as AttachMoneyIcon,
  QueryStats as QueryStatsIcon,
  Assessment as AssessmentIcon,
  Settings as SettingsIcon,
} from '@mui/icons-material';
import { Outlet, useNavigate, useLocation } from 'react-router-dom';
import type { ViewMode } from '../../types';
import TopBar from './TopBar';
import Sidebar, { DRAWER_WIDTH } from './Sidebar';

interface AppLayoutProps {
  viewMode: ViewMode;
  onViewModeChange: (mode: ViewMode) => void;
  notificationCount?: number;
}

const AppLayout: React.FC<AppLayoutProps> = ({
  viewMode,
  onViewModeChange,
  notificationCount = 0,
}) => {
  const theme = useTheme();
  const isMobile = useMediaQuery(theme.breakpoints.down('md'));
  const [mobileDrawerOpen, setMobileDrawerOpen] = useState(false);
  const navigate = useNavigate();
  const location = useLocation();

  const handleDrawerToggle = () => {
    setMobileDrawerOpen(!mobileDrawerOpen);
  };

  const consumerBottomNavItems = [
    { label: 'Home', path: '/consumer/dashboard', icon: <DashboardIcon /> },
    { label: 'Track', path: '/consumer/track', icon: <TrackChangesIcon /> },
    { label: 'History', path: '/consumer/history', icon: <ShowChartIcon /> },
    { label: 'AI Agent', path: '/consumer/chat', icon: <SmartToyIcon /> },
    { label: 'Alerts', path: '/consumer/alerts', icon: <NotificationsIcon /> },
  ];

  const msmeBottomNavItems = [
    { label: 'Home', path: '/msme/dashboard', icon: <DashboardIcon /> },
    { label: 'Pricing', path: '/msme/pricing', icon: <AttachMoneyIcon /> },
    { label: 'Intel', path: '/msme/competitive', icon: <QueryStatsIcon /> },
    { label: 'Reports', path: '/msme/reports', icon: <AssessmentIcon /> },
    { label: 'Settings', path: '/msme/settings', icon: <SettingsIcon /> },
  ];

  const bottomNavItems = viewMode === 'consumer' ? consumerBottomNavItems : msmeBottomNavItems;

  const handleBottomNavChange = (_event: React.SyntheticEvent, newValue: string) => {
    navigate(newValue);
  };

  return (
    <Box sx={{ display: 'flex', flexDirection: 'column', minHeight: '100vh', bgcolor: 'background.default' }}>
      <TopBar
        viewMode={viewMode}
        onViewModeChange={onViewModeChange}
        notificationCount={notificationCount}
        onMenuClick={handleDrawerToggle}
      />

      <Box sx={{ display: 'flex', flex: 1 }}>
        {!isMobile && <Sidebar viewMode={viewMode} variant="permanent" open={true} />}
        {isMobile && (
          <Sidebar
            viewMode={viewMode}
            variant="temporary"
            open={mobileDrawerOpen}
            onClose={handleDrawerToggle}
          />
        )}

        <Box
          component="main"
          sx={{
            flexGrow: 1,
            width: { md: `calc(100% - ${DRAWER_WIDTH}px)` },
            minHeight: '100vh',
            backgroundColor: 'background.default',
            pb: isMobile ? 8 : 0,
          }}
        >
          <Toolbar sx={{ minHeight: { xs: 56, sm: 64 } }} />
          <Box
            className="page-enter"
            sx={{ px: { xs: 2, sm: 3 }, py: { xs: 2, sm: 3 } }}
          >
            <Outlet />
          </Box>
        </Box>
      </Box>

      {isMobile && (
        <Paper
          sx={{
            position: 'fixed',
            bottom: 0,
            left: 0,
            right: 0,
            zIndex: 1100,
            borderTop: '1px solid rgba(0,0,0,0.06)',
          }}
          elevation={0}
        >
          <BottomNavigation
            value={location.pathname}
            onChange={handleBottomNavChange}
            showLabels
            sx={{
              height: 64,
              '& .MuiBottomNavigationAction-root': {
                minWidth: 'auto',
                py: 1,
                '&.Mui-selected': {
                  color: 'primary.main',
                },
              },
              '& .MuiBottomNavigationAction-label': {
                fontSize: '0.625rem',
                fontWeight: 600,
                mt: 0.25,
                '&.Mui-selected': { fontSize: '0.625rem' },
              },
            }}
          >
            {bottomNavItems.map((item) => (
              <BottomNavigationAction
                key={item.path}
                label={item.label}
                value={item.path}
                icon={item.icon}
              />
            ))}
          </BottomNavigation>
        </Paper>
      )}
    </Box>
  );
};

export default AppLayout;
</file>

<file path="src/components/layout/index.ts">
export { default as AppLayout } from './AppLayout';
export { default as Sidebar } from './Sidebar';
export { default as TopBar } from './TopBar';
</file>

<file path="src/components/layout/Sidebar.tsx">
import React from 'react';
import {
  Drawer,
  List,
  ListItem,
  ListItemButton,
  ListItemIcon,
  ListItemText,
  Toolbar,
  Box,
  Typography,
  Divider,
  alpha,
} from '@mui/material';
import {
  Dashboard as DashboardIcon,
  TrackChanges as TrackChangesIcon,
  ShowChart as ShowChartIcon,
  SmartToy as SmartToyIcon,
  Notifications as NotificationsIcon,
  LocalOffer as LocalOfferIcon,
  AttachMoney as AttachMoneyIcon,
  QueryStats as QueryStatsIcon,
  Assessment as AssessmentIcon,
  Settings as SettingsIcon,
} from '@mui/icons-material';
import { useNavigate, useLocation } from 'react-router-dom';
import type { ViewMode } from '../../types';

const DRAWER_WIDTH = 260;

interface NavigationItem {
  label: string;
  path: string;
  icon: React.ReactElement;
  section?: string;
}

const consumerNavItems: NavigationItem[] = [
  { label: 'Dashboard', path: '/consumer/dashboard', icon: <DashboardIcon />, section: 'Overview' },
  { label: 'Track Product', path: '/consumer/track', icon: <TrackChangesIcon />, section: 'Overview' },
  { label: 'Price History', path: '/consumer/history', icon: <ShowChartIcon />, section: 'Analysis' },
  { label: 'AI Agent', path: '/consumer/chat', icon: <SmartToyIcon />, section: 'Analysis' },
  { label: 'Alerts', path: '/consumer/alerts', icon: <NotificationsIcon />, section: 'Manage' },
  { label: 'Festival Deals', path: '/consumer/festivals', icon: <LocalOfferIcon />, section: 'Manage' },
];

const msmeNavItems: NavigationItem[] = [
  { label: 'Dashboard', path: '/msme/dashboard', icon: <DashboardIcon />, section: 'Business' },
  { label: 'Pricing Strategy', path: '/msme/pricing', icon: <AttachMoneyIcon />, section: 'Business' },
  { label: 'Competitive Intel', path: '/msme/competitive', icon: <QueryStatsIcon />, section: 'Intelligence' },
  { label: 'Reports', path: '/msme/reports', icon: <AssessmentIcon />, section: 'Intelligence' },
  { label: 'Settings', path: '/msme/settings', icon: <SettingsIcon />, section: 'System' },
];

interface SidebarProps {
  viewMode: ViewMode;
  open?: boolean;
  onClose?: () => void;
  variant?: 'permanent' | 'temporary';
}

const Sidebar: React.FC<SidebarProps> = ({
  viewMode,
  open = true,
  onClose,
  variant = 'permanent',
}) => {
  const navigate = useNavigate();
  const location = useLocation();
  const navItems = viewMode === 'consumer' ? consumerNavItems : msmeNavItems;

  const handleNavigation = (path: string) => {
    navigate(path);
    if (variant === 'temporary' && onClose) onClose();
  };

  // Group items by section
  const sections: { [key: string]: NavigationItem[] } = {};
  navItems.forEach((item) => {
    const section = item.section || 'General';
    if (!sections[section]) sections[section] = [];
    sections[section].push(item);
  });

  const drawerContent = (
    <Box sx={{ display: 'flex', flexDirection: 'column', height: '100%' }}>
      <Toolbar />
      <Box sx={{ flex: 1, px: 1.5, pt: 1 }}>
        {Object.entries(sections).map(([sectionName, items], sectionIndex) => (
          <Box key={sectionName} sx={{ mb: 1 }}>
            {sectionIndex > 0 && <Divider sx={{ my: 1, mx: 1 }} />}
            <Typography
              variant="overline"
              sx={{
                px: 1.5,
                py: 0.75,
                display: 'block',
                color: 'text.secondary',
                fontSize: '0.625rem',
                fontWeight: 700,
                letterSpacing: '0.1em',
              }}
            >
              {sectionName}
            </Typography>
            <List disablePadding>
              {items.map((item) => {
                const isActive = location.pathname === item.path;
                return (
                  <ListItem key={item.path} disablePadding sx={{ mb: 0.25 }}>
                    <ListItemButton
                      selected={isActive}
                      onClick={() => handleNavigation(item.path)}
                      sx={{
                        borderRadius: '10px',
                        mx: 0.5,
                        py: 1,
                        px: 1.5,
                        minHeight: 44,
                        transition: 'all 0.15s ease',
                        '&.Mui-selected': {
                          backgroundColor: (theme) => alpha(theme.palette.primary.main, 0.08),
                          '&:hover': {
                            backgroundColor: (theme) => alpha(theme.palette.primary.main, 0.12),
                          },
                        },
                        '&:hover': {
                          backgroundColor: 'rgba(0,0,0,0.04)',
                        },
                      }}
                    >
                      <ListItemIcon
                        sx={{
                          minWidth: 36,
                          color: isActive ? 'primary.main' : 'text.secondary',
                          transition: 'color 0.15s ease',
                          '& .MuiSvgIcon-root': { fontSize: 20 },
                        }}
                      >
                        {item.icon}
                      </ListItemIcon>
                      <ListItemText
                        primary={item.label}
                        sx={{
                          '& .MuiTypography-root': {
                            fontWeight: isActive ? 600 : 500,
                            fontSize: '0.8125rem',
                            color: isActive ? 'primary.main' : 'text.primary',
                            transition: 'all 0.15s ease',
                          },
                        }}
                      />
                      {isActive && (
                        <Box
                          sx={{
                            width: 4,
                            height: 20,
                            borderRadius: 2,
                            background: 'linear-gradient(180deg, #1a237e, #534bae)',
                          }}
                        />
                      )}
                    </ListItemButton>
                  </ListItem>
                );
              })}
            </List>
          </Box>
        ))}
      </Box>

      {/* Footer branding */}
      <Box sx={{ p: 2, mt: 'auto' }}>
        <Divider sx={{ mb: 2 }} />
        <Box
          sx={{
            p: 1.5,
            borderRadius: '10px',
            background: 'linear-gradient(135deg, rgba(26,35,126,0.04), rgba(83,75,174,0.06))',
            border: '1px solid rgba(26,35,126,0.06)',
          }}
        >
          <Typography variant="caption" sx={{ color: 'text.secondary', fontWeight: 600, display: 'block' }}>
            RetailIQ {viewMode === 'msme' ? 'Pro' : ''}
          </Typography>
          <Typography variant="caption" sx={{ color: 'text.disabled', fontSize: '0.625rem' }}>
            AI-powered retail intelligence
          </Typography>
        </Box>
      </Box>
    </Box>
  );

  return (
    <Drawer
      variant={variant}
      open={open}
      onClose={onClose}
      sx={{
        width: DRAWER_WIDTH,
        flexShrink: 0,
        '& .MuiDrawer-paper': {
          width: DRAWER_WIDTH,
          boxSizing: 'border-box',
          borderRight: '1px solid rgba(0,0,0,0.06)',
          backgroundColor: '#fefefe',
        },
      }}
    >
      {drawerContent}
    </Drawer>
  );
};

export default Sidebar;
export { DRAWER_WIDTH };
</file>

<file path="src/components/layout/TopBar.tsx">
import React from 'react';
import {
  AppBar,
  Toolbar,
  Typography,
  InputBase,
  IconButton,
  Badge,
  Avatar,
  Box,
  alpha,
  styled,
  Tooltip,
  Stack,
} from '@mui/material';
import {
  Search as SearchIcon,
  Notifications as NotificationsIcon,
  Menu as MenuIcon,
} from '@mui/icons-material';
import type { ViewMode } from '../../types';

const Search = styled('div')(({ theme }) => ({
  position: 'relative',
  borderRadius: 12,
  backgroundColor: alpha(theme.palette.common.white, 0.08),
  border: `1px solid ${alpha(theme.palette.common.white, 0.12)}`,
  transition: 'all 0.2s ease',
  '&:hover': {
    backgroundColor: alpha(theme.palette.common.white, 0.12),
    borderColor: alpha(theme.palette.common.white, 0.2),
  },
  '&:focus-within': {
    backgroundColor: alpha(theme.palette.common.white, 0.15),
    borderColor: alpha(theme.palette.common.white, 0.3),
    boxShadow: `0 0 0 3px ${alpha(theme.palette.common.white, 0.06)}`,
  },
  marginLeft: 0,
  width: '100%',
  [theme.breakpoints.up('sm')]: {
    marginLeft: theme.spacing(2),
    width: 'auto',
  },
}));

const SearchIconWrapper = styled('div')(({ theme }) => ({
  padding: theme.spacing(0, 1.5),
  height: '100%',
  position: 'absolute',
  pointerEvents: 'none',
  display: 'flex',
  alignItems: 'center',
  justifyContent: 'center',
  opacity: 0.6,
}));

const StyledInputBase = styled(InputBase)(({ theme }) => ({
  color: 'inherit',
  width: '100%',
  fontSize: '0.875rem',
  '& .MuiInputBase-input': {
    padding: theme.spacing(1, 1, 1, 0),
    paddingLeft: `calc(1em + ${theme.spacing(3.5)})`,
    transition: theme.transitions.create('width'),
    [theme.breakpoints.up('sm')]: {
      width: '28ch',
      '&:focus': {
        width: '36ch',
      },
    },
  },
}));

interface TopBarProps {
  viewMode: ViewMode;
  onViewModeChange: (mode: ViewMode) => void;
  notificationCount?: number;
  onMenuClick?: () => void;
}

const TopBar: React.FC<TopBarProps> = ({
  viewMode,
  onViewModeChange,
  notificationCount = 0,
  onMenuClick,
}) => {
  const handleToggle = () => {
    onViewModeChange(viewMode === 'consumer' ? 'msme' : 'consumer');
  };

  return (
    <AppBar
      position="fixed"
      sx={{
        zIndex: (theme) => theme.zIndex.drawer + 1,
        background: 'linear-gradient(135deg, #0d1642 0%, #1a237e 50%, #283593 100%)',
        borderBottom: '1px solid rgba(255,255,255,0.06)',
        backdropFilter: 'blur(20px)',
      }}
    >
      <Toolbar sx={{ minHeight: { xs: 56, sm: 64 }, px: { xs: 1.5, sm: 3 } }}>
        {/* Mobile menu */}
        <IconButton
          color="inherit"
          edge="start"
          onClick={onMenuClick}
          sx={{ mr: 1, display: { md: 'none' }, opacity: 0.8 }}
        >
          <MenuIcon />
        </IconButton>

        {/* Logo */}
        <Stack direction="row" alignItems="center" spacing={1} sx={{ mr: { xs: 1, sm: 3 } }}>
          <Box
            sx={{
              width: 32,
              height: 32,
              borderRadius: '10px',
              background: 'linear-gradient(135deg, #ff6f00, #ffa040)',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              fontWeight: 800,
              fontSize: '0.875rem',
              color: '#fff',
              boxShadow: '0 2px 8px rgba(255,111,0,0.3)',
            }}
          >
            R
          </Box>
          <Typography
            variant="h6"
            noWrap
            sx={{
              display: { xs: 'none', sm: 'block' },
              fontWeight: 800,
              fontSize: '1.125rem',
              letterSpacing: '-0.02em',
              background: 'linear-gradient(135deg, #fff 0%, rgba(255,255,255,0.85) 100%)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
            }}
          >
            RetailIQ
          </Typography>
        </Stack>

        {/* Mode Toggle */}
        <Box
          onClick={handleToggle}
          sx={{
            display: 'flex',
            alignItems: 'center',
            borderRadius: '10px',
            overflow: 'hidden',
            cursor: 'pointer',
            border: '1px solid rgba(255,255,255,0.15)',
            mr: { xs: 1, sm: 2 },
            transition: 'all 0.2s ease',
            '&:hover': { borderColor: 'rgba(255,255,255,0.3)' },
          }}
        >
          <Box
            sx={{
              px: 1.5,
              py: 0.75,
              fontSize: '0.6875rem',
              fontWeight: 700,
              letterSpacing: '0.03em',
              color: viewMode === 'consumer' ? '#fff' : 'rgba(255,255,255,0.5)',
              background: viewMode === 'consumer' ? 'rgba(255,255,255,0.15)' : 'transparent',
              transition: 'all 0.2s ease',
            }}
          >
            Consumer
          </Box>
          <Box
            sx={{
              px: 1.5,
              py: 0.75,
              fontSize: '0.6875rem',
              fontWeight: 700,
              letterSpacing: '0.03em',
              color: viewMode === 'msme' ? '#fff' : 'rgba(255,255,255,0.5)',
              background: viewMode === 'msme' ? 'linear-gradient(135deg, #ff6f00, #c43e00)' : 'transparent',
              transition: 'all 0.2s ease',
            }}
          >
            MSME Pro
          </Box>
        </Box>

        {/* Search */}
        <Search sx={{ flexGrow: 1, maxWidth: 480, display: { xs: 'none', sm: 'block' } }}>
          <SearchIconWrapper>
            <SearchIcon sx={{ fontSize: 18 }} />
          </SearchIconWrapper>
          <StyledInputBase
            placeholder="Search products, brands, categories..."
            inputProps={{ 'aria-label': 'search products' }}
          />
        </Search>

        <Box sx={{ flexGrow: 1 }} />

        {/* Right actions */}
        <Stack direction="row" alignItems="center" spacing={0.5}>
          <Tooltip title="Search" arrow>
            <IconButton color="inherit" sx={{ display: { sm: 'none' }, opacity: 0.8 }}>
              <SearchIcon />
            </IconButton>
          </Tooltip>

          <Tooltip title="Notifications" arrow>
            <IconButton color="inherit" sx={{ opacity: 0.8, '&:hover': { opacity: 1 } }}>
              <Badge
                badgeContent={notificationCount}
                color="error"
                sx={{
                  '& .MuiBadge-badge': {
                    fontSize: '0.625rem',
                    fontWeight: 700,
                    minWidth: 18,
                    height: 18,
                    borderRadius: 9,
                    border: '2px solid #1a237e',
                  },
                }}
              >
                <NotificationsIcon sx={{ fontSize: 22 }} />
              </Badge>
            </IconButton>
          </Tooltip>

          <Tooltip title="Profile" arrow>
            <IconButton size="small" sx={{ ml: 0.5 }}>
              <Avatar
                sx={{
                  width: 34,
                  height: 34,
                  bgcolor: 'secondary.main',
                  fontSize: '0.8125rem',
                  fontWeight: 700,
                  border: '2px solid rgba(255,255,255,0.2)',
                  boxShadow: '0 2px 8px rgba(0,0,0,0.2)',
                }}
              >
                U
              </Avatar>
            </IconButton>
          </Tooltip>
        </Stack>
      </Toolbar>
    </AppBar>
  );
};

export default TopBar;
</file>

<file path="src/data/sampleData.ts">
import type { Product, Alert, Festival, PriceRecord } from '../types';

export const sampleProducts: Product[] = [
  {
    product_id: 'p1',
    product_name: 'Apple iPhone 15 Pro Max (256GB, Natural Titanium)',
    category: 'Smartphone',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/iphone-15-pro-max',
    current_price: 144900,
    original_price: 159900,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/iphone15pro.jpg',
    brand: 'Apple',
    rating: 4.7,
    review_count: 1542,
    features: {
      storage: '256GB',
      ram: '8GB',
      display: '6.7" Super Retina XDR',
      processor: 'A17 Pro',
      camera: '48MP + 12MP + 12MP'
    },
    description: 'Latest iPhone with titanium design, A17 Pro chip, and advanced camera system'
  },
  {
    product_id: 'p2',
    product_name: 'Samsung Galaxy S24 Ultra (12GB RAM, 256GB)',
    category: 'Smartphone',
    platform: 'flipkart',
    product_url: 'https://flipkart.com/samsung-s24-ultra',
    current_price: 124999,
    original_price: 134999,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/s24ultra.jpg',
    brand: 'Samsung',
    rating: 4.6,
    review_count: 2341,
    features: {
      storage: '256GB',
      ram: '12GB',
      display: '6.8" Dynamic AMOLED 2X',
      processor: 'Snapdragon 8 Gen 3',
      camera: '200MP + 50MP + 12MP + 10MP'
    },
    description: 'Flagship Samsung with S Pen, 200MP camera, and AI features'
  },
  {
    product_id: 'p3',
    product_name: 'OnePlus 12 (12GB RAM, 256GB, Flowy Emerald)',
    category: 'Smartphone',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/oneplus-12',
    current_price: 64999,
    original_price: 69999,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/oneplus12.jpg',
    brand: 'OnePlus',
    rating: 4.5,
    review_count: 1876,
    features: {
      storage: '256GB',
      ram: '12GB',
      display: '6.82" AMOLED',
      processor: 'Snapdragon 8 Gen 3',
      camera: '50MP + 64MP + 48MP'
    },
    description: 'Flagship killer with Hasselblad camera and 100W fast charging'
  },
  {
    product_id: 'p4',
    product_name: 'Google Pixel 8 Pro (12GB RAM, 256GB)',
    category: 'Smartphone',
    platform: 'flipkart',
    product_url: 'https://flipkart.com/pixel-8-pro',
    current_price: 84999,
    original_price: 106999,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/pixel8pro.jpg',
    brand: 'Google',
    rating: 4.6,
    review_count: 987,
    features: {
      storage: '256GB',
      ram: '12GB',
      display: '6.7" LTPO OLED',
      processor: 'Google Tensor G3',
      camera: '50MP + 48MP + 48MP'
    },
    description: 'Best Android camera with AI features and 7 years of updates'
  },
  {
    product_id: 'p5',
    product_name: 'Nothing Phone (2a) (8GB RAM, 128GB)',
    category: 'Smartphone',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/nothing-phone-2a',
    current_price: 23999,
    original_price: 25999,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/nothing2a.jpg',
    brand: 'Nothing',
    rating: 4.3,
    review_count: 1234,
    features: {
      storage: '128GB',
      ram: '8GB',
      display: '6.7" AMOLED',
      processor: 'MediaTek Dimensity 7200 Pro',
      camera: '50MP + 50MP'
    },
    description: 'Unique design with Glyph interface and great value'
  },
  {
    product_id: 'p6',
    product_name: 'Dell XPS 13 (13th Gen Intel i7, 16GB RAM, 512GB SSD)',
    category: 'Laptop',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/dell-xps-13',
    current_price: 119990,
    original_price: 134990,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/dell-xps13.jpg',
    brand: 'Dell',
    rating: 4.5,
    review_count: 543,
    features: {
      processor: 'Intel Core i7-1355U',
      ram: '16GB LPDDR5',
      storage: '512GB SSD',
      display: '13.4" FHD+',
      graphics: 'Intel Iris Xe'
    },
    description: 'Premium ultrabook with stunning display and long battery life'
  },
  {
    product_id: 'p7',
    product_name: 'MacBook Air M2 (8GB RAM, 256GB SSD, Midnight)',
    category: 'Laptop',
    platform: 'flipkart',
    product_url: 'https://flipkart.com/macbook-air-m2',
    current_price: 99990,
    original_price: 114900,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/macbook-air-m2.jpg',
    brand: 'Apple',
    rating: 4.8,
    review_count: 876,
    features: {
      processor: 'Apple M2',
      ram: '8GB Unified Memory',
      storage: '256GB SSD',
      display: '13.6" Liquid Retina',
      graphics: '8-core GPU'
    },
    description: 'Thin, light, and powerful with Apple M2 chip'
  },
  {
    product_id: 'p8',
    product_name: 'ASUS ROG Strix G16 (Intel i7, RTX 4060, 16GB RAM)',
    category: 'Laptop',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/asus-rog-strix-g16',
    current_price: 124990,
    original_price: 149990,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/rog-strix-g16.jpg',
    brand: 'ASUS',
    rating: 4.6,
    review_count: 432,
    features: {
      processor: 'Intel Core i7-13650HX',
      ram: '16GB DDR5',
      storage: '512GB SSD',
      display: '16" FHD 165Hz',
      graphics: 'NVIDIA RTX 4060 8GB'
    },
    description: 'Gaming laptop with powerful specs and RGB lighting'
  },
  {
    product_id: 'p9',
    product_name: 'Sony WH-1000XM5 Wireless Noise Cancelling Headphones',
    category: 'Audio',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/sony-wh1000xm5',
    current_price: 28990,
    original_price: 34990,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/sony-wh1000xm5.jpg',
    brand: 'Sony',
    rating: 4.7,
    review_count: 2341,
    features: {
      type: 'Over-Ear Wireless',
      noise_cancelling: 'Industry-leading ANC',
      battery: '30 hours',
      connectivity: 'Bluetooth 5.2',
      controls: 'Touch controls'
    },
    description: 'Best-in-class noise cancelling with premium sound quality'
  },
  {
    product_id: 'p10',
    product_name: 'Apple AirPods Pro (2nd Generation)',
    category: 'Audio',
    platform: 'flipkart',
    product_url: 'https://flipkart.com/airpods-pro-2',
    current_price: 23990,
    original_price: 26900,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/airpods-pro-2.jpg',
    brand: 'Apple',
    rating: 4.6,
    review_count: 1654,
    features: {
      type: 'In-Ear Wireless',
      noise_cancelling: 'Active Noise Cancellation',
      battery: '6 hours (30 hours with case)',
      connectivity: 'Bluetooth 5.3',
      features: 'Spatial Audio, Transparency Mode'
    },
    description: 'Premium earbuds with adaptive audio and seamless Apple integration'
  },
  {
    product_id: 'p11',
    product_name: 'boAt Airdopes 141 True Wireless Earbuds',
    category: 'Audio',
    platform: 'amazon_india',
    product_url: 'https://amazon.in/boat-airdopes-141',
    current_price: 1299,
    original_price: 2990,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/boat-airdopes-141.jpg',
    brand: 'boAt',
    rating: 4.1,
    review_count: 8765,
    features: {
      type: 'In-Ear Wireless',
      battery: '42 hours playback',
      connectivity: 'Bluetooth 5.1',
      waterproof: 'IPX4',
      drivers: '8mm drivers'
    },
    description: 'Budget TWS earbuds with good battery life'
  },
  {
    product_id: 'p12',
    product_name: 'Samsung Galaxy Watch 6 Classic (43mm, Bluetooth)',
    category: 'Wearable',
    platform: 'flipkart',
    product_url: 'https://flipkart.com/galaxy-watch-6-classic',
    current_price: 34999,
    original_price: 39999,
    currency: 'INR',
    availability: 'in_stock',
    last_updated: '2026-02-12T10:00:00Z',
    image_url: '/images/galaxy-watch-6.jpg',
    brand: 'Samsung',
    rating: 4.5,
    review_count: 432,
    features: {
      display: '1.3" Super AMOLED',
      battery: 'Up to 40 hours',
      sensors: 'Heart rate, ECG, Blood oxygen, Sleep tracking',
      waterproof: '5ATM + IP68',
      compatibility: 'Android'
    },
    description: 'Premium smartwatch with rotating bezel and advanced health tracking'
  }
];

export const sampleCompetitors = [
  { rank: 1, name: 'TechMart Electronics', avg_price: 24500, market_share: 15.2, strategy: 'Premium positioning' },
  { rank: 2, name: 'Digital Hub', avg_price: 22800, market_share: 12.8, strategy: 'Volume sales' },
  { rank: 3, name: 'Gadget Galaxy', avg_price: 26100, market_share: 11.5, strategy: 'Premium + Services' },
  { rank: 4, name: 'Smart Solutions', avg_price: 21900, market_share: 10.3, strategy: 'Competitive pricing' },
  { rank: 5, name: 'E-Retail Pro', avg_price: 23200, market_share: 9.8, strategy: 'Bundle deals' },
  { rank: 6, name: 'Tech Valley', avg_price: 24800, market_share: 8.9, strategy: 'Brand exclusives' },
  { rank: 7, name: 'Digi Store', avg_price: 22500, market_share: 7.4, strategy: 'Fast delivery' },
  { rank: 8, name: 'Your Store', avg_price: 25200, market_share: 6.2, strategy: 'Premium + Service', isUser: true },
  { rank: 9, name: 'Quick Gadgets', avg_price: 20800, market_share: 5.8, strategy: 'Discount heavy' },
  { rank: 10, name: 'Mobile World', avg_price: 23900, market_share: 5.1, strategy: 'Mid-range focus' }
];

export const sampleOpportunities = [
  {
    product: 'Wireless Earbuds (Budget)',
    demand_change: '+45% in 30 days',
    competition: 'Low' as const,
    avg_price: 1499,
    potential_margin: '35-40%'
  },
  {
    product: 'Smart Watches (Mid-range)',
    demand_change: '+28% in 30 days',
    competition: 'Medium' as const,
    avg_price: 8999,
    potential_margin: '25-30%'
  },
  {
    product: 'Power Banks (20000mAh)',
    demand_change: '+18% in 30 days',
    competition: 'Low' as const,
    avg_price: 1799,
    potential_margin: '30-35%'
  }
];

export const sampleThreats = [
  { competitor: 'TechMart Electronics', action: 'Reduced prices by 8% on premium smartphones', impact: 'High', date: '2 days ago' },
  { competitor: 'Digital Hub', action: 'Launched buy-2-get-1 offer on accessories', impact: 'Medium', date: '5 days ago' },
  { competitor: 'Smart Solutions', action: 'Started same-day delivery in your area', impact: 'Medium', date: '1 week ago' }
];

export const msmeProducts = [
  { id: 1, name: 'Samsung Galaxy M34 5G', yourPrice: 18999, marketAvg: 16999, position: 'Above Market', status: 'warning' },
  { id: 2, name: 'boAt Airdopes 141', yourPrice: 1299, marketAvg: 1450, position: 'Competitive', status: 'success' },
  { id: 3, name: 'OnePlus Nord CE 3', yourPrice: 24999, marketAvg: 26500, position: 'Best Value', status: 'success' },
  { id: 4, name: 'Noise ColorFit Pro 4', yourPrice: 3499, marketAvg: 2999, position: 'Above Market', status: 'warning' },
  { id: 5, name: 'Realme Buds Air 5', yourPrice: 2799, marketAvg: 3200, position: 'Competitive', status: 'success' }
];

export const topPerformers = [
  { name: 'OnePlus Nord CE 3', margin: '18%', sales: 45, trend: 'up' },
  { name: 'boAt Airdopes 141', margin: '22%', sales: 123, trend: 'up' },
  { name: 'Realme Buds Air 5', margin: '15%', sales: 67, trend: 'stable' }
];

export const needsAttention = [
  { name: 'Samsung Galaxy M34 5G', issue: 'Overpriced vs market', impact: 'Low sales' },
  { name: 'Noise ColorFit Pro 4', issue: 'High competition', impact: 'Margin pressure' }
];

export const priceDistribution = [
  { range: '15k-20k', count: 45 },
  { range: '20k-25k', count: 78 },
  { range: '25k-30k', count: 52 },
  { range: '30k-35k', count: 34 },
  { range: '35k-40k', count: 18 },
  { range: '40k+', count: 12 }
];

// Consumer-specific data
export const sampleAlerts: Alert[] = [
  {
    alert_id: 'ALERT001',
    user_id: 'USER001',
    product_id: 'p1',
    product_name: 'Apple iPhone 15 Pro Max (256GB, Natural Titanium)',
    alert_type: 'price_drop',
    old_price: 149900,
    new_price: 144900,
    percentage_change: -3.3,
    timestamp: '2026-02-12T10:00:00Z',
    read: false,
    platform: 'amazon_india',
  },
  {
    alert_id: 'ALERT002',
    user_id: 'USER001',
    product_id: 'p9',
    product_name: 'Sony WH-1000XM5 Wireless Noise Cancelling Headphones',
    alert_type: 'price_drop',
    old_price: 32990,
    new_price: 28990,
    percentage_change: -12.1,
    timestamp: '2026-02-12T08:30:00Z',
    read: false,
    platform: 'amazon_india',
  },
  {
    alert_id: 'ALERT003',
    user_id: 'USER001',
    product_id: 'p2',
    product_name: 'Samsung Galaxy S24 Ultra (12GB RAM, 256GB)',
    alert_type: 'festival',
    old_price: 129999,
    new_price: 124999,
    percentage_change: -3.8,
    timestamp: '2026-02-11T15:20:00Z',
    read: false,
    platform: 'flipkart',
  },
  {
    alert_id: 'ALERT004',
    user_id: 'USER001',
    product_id: 'p7',
    product_name: 'MacBook Air M2 (8GB RAM, 256GB SSD, Midnight)',
    alert_type: 'price_drop',
    old_price: 104990,
    new_price: 99990,
    percentage_change: -4.8,
    timestamp: '2026-02-11T09:00:00Z',
    read: true,
    platform: 'flipkart',
  },
  {
    alert_id: 'ALERT005',
    user_id: 'USER001',
    product_id: 'p11',
    product_name: 'boAt Airdopes 141 True Wireless Earbuds',
    alert_type: 'price_drop',
    old_price: 1599,
    new_price: 1299,
    percentage_change: -18.8,
    timestamp: '2026-02-10T16:45:00Z',
    read: true,
    platform: 'amazon_india',
  },
  {
    alert_id: 'ALERT006',
    user_id: 'USER001',
    product_id: 'p3',
    product_name: 'OnePlus 12 (12GB RAM, 256GB, Flowy Emerald)',
    alert_type: 'price_increase',
    old_price: 62999,
    new_price: 64999,
    percentage_change: 3.2,
    timestamp: '2026-02-10T12:15:00Z',
    read: true,
    platform: 'amazon_india',
  },
  {
    alert_id: 'ALERT007',
    user_id: 'USER001',
    product_id: 'p6',
    product_name: 'Dell XPS 13 (13th Gen Intel i7, 16GB RAM, 512GB SSD)',
    alert_type: 'festival',
    old_price: 124990,
    new_price: 119990,
    percentage_change: -4.0,
    timestamp: '2026-02-09T11:30:00Z',
    read: true,
    platform: 'amazon_india',
  },
  {
    alert_id: 'ALERT008',
    user_id: 'USER001',
    product_id: 'p10',
    product_name: 'Apple AirPods Pro (2nd Generation)',
    alert_type: 'price_increase',
    old_price: 22990,
    new_price: 23990,
    percentage_change: 4.3,
    timestamp: '2026-02-09T08:00:00Z',
    read: true,
    platform: 'flipkart',
  },
];

export const sampleFestivals: Festival[] = [
  {
    festival_id: 'FEST001',
    name: 'Holi Sale',
    date: '2026-03-14',
    type: 'religious',
    days_until: 30,
    historical_discount_avg: 25,
    affected_categories: ['Electronics', 'Fashion', 'Home & Kitchen', 'Beauty'],
    description: 'Major spring festival sale with significant discounts across categories',
    historical_discounts: [
      { year: 2025, discount: 22 },
      { year: 2024, discount: 25 },
      { year: 2023, discount: 28 },
      { year: 2022, discount: 24 },
    ],
  },
  {
    festival_id: 'FEST002',
    name: 'Amazon Great Indian Festival',
    date: '2026-09-20',
    type: 'sale_event',
    days_until: 220,
    historical_discount_avg: 40,
    affected_categories: ['Electronics', 'Appliances', 'Fashion', 'Mobile', 'TV', 'Laptop'],
    description: 'Amazon biggest annual sale event with deep discounts',
    historical_discounts: [
      { year: 2025, discount: 38 },
      { year: 2024, discount: 42 },
      { year: 2023, discount: 40 },
      { year: 2022, discount: 39 },
    ],
  },
  {
    festival_id: 'FEST003',
    name: 'Flipkart Big Billion Days',
    date: '2026-10-05',
    type: 'sale_event',
    days_until: 235,
    historical_discount_avg: 45,
    affected_categories: ['Electronics', 'Fashion', 'Mobile', 'Laptop', 'TV', 'Appliances'],
    description: 'Flipkart annual mega sale with massive discounts',
    historical_discounts: [
      { year: 2025, discount: 43 },
      { year: 2024, discount: 47 },
      { year: 2023, discount: 45 },
      { year: 2022, discount: 44 },
    ],
  },
  {
    festival_id: 'FEST004',
    name: 'Diwali Dhamaka',
    date: '2026-11-01',
    type: 'religious',
    days_until: 262,
    historical_discount_avg: 35,
    affected_categories: ['Electronics', 'Jewelry', 'Fashion', 'Home Decor', 'Appliances'],
    description: 'Festival of lights mega sale across all platforms',
    historical_discounts: [
      { year: 2025, discount: 33 },
      { year: 2024, discount: 37 },
      { year: 2023, discount: 35 },
      { year: 2022, discount: 35 },
    ],
  },
  {
    festival_id: 'FEST005',
    name: 'Republic Day Sale',
    date: '2027-01-26',
    type: 'national',
    days_until: 348,
    historical_discount_avg: 30,
    affected_categories: ['Electronics', 'Fashion', 'Appliances', 'Mobile'],
    description: 'Republic Day special offers and discounts',
    historical_discounts: [
      { year: 2026, discount: 28 },
      { year: 2025, discount: 32 },
      { year: 2024, discount: 30 },
      { year: 2023, discount: 30 },
    ],
  },
  {
    festival_id: 'FEST006',
    name: 'Summer Sale',
    date: '2026-05-15',
    type: 'sale_event',
    days_until: 92,
    historical_discount_avg: 28,
    affected_categories: ['Fashion', 'Beauty', 'Sports', 'Electronics'],
    description: 'Summer clearance sale with attractive deals',
    historical_discounts: [
      { year: 2025, discount: 26 },
      { year: 2024, discount: 30 },
      { year: 2023, discount: 28 },
      { year: 2022, discount: 28 },
    ],
  },
  {
    festival_id: 'FEST007',
    name: 'Raksha Bandhan Special',
    date: '2026-08-09',
    type: 'religious',
    days_until: 178,
    historical_discount_avg: 20,
    affected_categories: ['Fashion', 'Jewelry', 'Electronics', 'Gifts'],
    description: 'Special festive offers for Raksha Bandhan',
    historical_discounts: [
      { year: 2025, discount: 18 },
      { year: 2024, discount: 22 },
      { year: 2023, discount: 20 },
      { year: 2022, discount: 20 },
    ],
  },
  {
    festival_id: 'FEST008',
    name: 'Independence Day Sale',
    date: '2026-08-15',
    type: 'national',
    days_until: 184,
    historical_discount_avg: 32,
    affected_categories: ['Electronics', 'Appliances', 'Fashion', 'Mobile'],
    description: 'Independence Day mega sale with patriotic discounts',
    historical_discounts: [
      { year: 2025, discount: 30 },
      { year: 2024, discount: 34 },
      { year: 2023, discount: 32 },
      { year: 2022, discount: 32 },
    ],
  },
];

export const samplePriceHistory: PriceRecord[] = [
  // iPhone 15 Pro Max price history (last 30 days)
  { product_id: 'p1', platform: 'amazon_india', price: 154900, timestamp: '2026-01-13T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 152900, timestamp: '2026-01-16T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 151900, timestamp: '2026-01-20T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 149900, timestamp: '2026-01-25T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 148900, timestamp: '2026-01-30T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 147900, timestamp: '2026-02-03T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 146900, timestamp: '2026-02-07T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'amazon_india', price: 144900, timestamp: '2026-02-12T00:00:00Z', availability: 'in_stock' },

  { product_id: 'p1', platform: 'flipkart', price: 156900, timestamp: '2026-01-13T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'flipkart', price: 154900, timestamp: '2026-01-20T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'flipkart', price: 151900, timestamp: '2026-01-27T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'flipkart', price: 149900, timestamp: '2026-02-03T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'flipkart', price: 147900, timestamp: '2026-02-10T00:00:00Z', availability: 'in_stock' },
  { product_id: 'p1', platform: 'flipkart', price: 146900, timestamp: '2026-02-12T00:00:00Z', availability: 'in_stock' },
];

// Helper functions
export const getNextFestival = (): Festival | undefined => {
  return sampleFestivals.sort((a, b) => a.days_until - b.days_until)[0];
};

export const getPriceHistory = (productId: string): PriceRecord[] => {
  return samplePriceHistory.filter(record => record.product_id === productId);
};

export const watchlistProducts = sampleProducts.slice(0, 12);

export const getRecentAlerts = (): Alert[] => {
  return sampleAlerts.filter(alert => !alert.read).slice(0, 3);
};

export const trendingProducts = [
  { rank: 1, product: sampleProducts[0], trend_score: 95 },
  { rank: 2, product: sampleProducts[1], trend_score: 92 },
  { rank: 3, product: sampleProducts[2], trend_score: 88 },
  { rank: 4, product: sampleProducts[4], trend_score: 85 },
  { rank: 5, product: sampleProducts[5], trend_score: 82 },
];

export const recommendedProducts = sampleProducts.slice(0, 8);
</file>

<file path="src/index.css">
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background-color: #f8f9fb;
  color: #1a1a2e;
  text-rendering: optimizeLegibility;
}

::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.15);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.25);
}

::selection {
  background: rgba(26, 35, 126, 0.15);
  color: #1a237e;
}

@media (prefers-reduced-motion: reduce) {
  html { scroll-behavior: auto; }
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
</file>

<file path="src/main.tsx">
import { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';
import { ThemeProvider, CssBaseline } from '@mui/material';
import theme from './theme/theme';
import App from './App';
import './index.css';

createRoot(document.getElementById('root')!).render(
  <StrictMode>
    <ThemeProvider theme={theme}>
      <CssBaseline />
      <App />
    </ThemeProvider>
  </StrictMode>
);
</file>

<file path="src/pages/AlertsPage.tsx">
import React, { useState, useMemo } from 'react';
import {
  Box,
  Container,
  Typography,
  Card,
  CardContent,
  Button,
  Tabs,
  Tab,
  Stack,
  Paper,
  Chip,
  Switch,
  FormControlLabel,
  FormGroup,
  Checkbox,
  Divider,
  Badge,
} from '@mui/material';
import {
  TrendingUp,
  TrendingDown,
  Celebration,
  CheckCircle,
  NotificationsActive,
  Settings,
} from '@mui/icons-material';
import { formatINR, formatPercentage, formatRelativeTime, getPlatformName } from '../utils/formatters';
import { sampleAlerts } from '../data/sampleData';
import type { Alert } from '../types';

const AlertsPage: React.FC = () => {
  const [selectedTab, setSelectedTab] = useState<'all' | 'price_drop' | 'price_increase' | 'festival'>('all');
  const [showUnreadOnly, setShowUnreadOnly] = useState(false);
  const [alertsList, setAlertsList] = useState(sampleAlerts);
  const [notificationSettings, setNotificationSettings] = useState({
    emailNotifications: true,
    pushNotifications: true,
    priceDropAlerts: true,
    priceIncreaseAlerts: false,
    festivalAlerts: true,
    backInStockAlerts: true,
  });

  // Filter alerts based on selected tab and unread filter
  const filteredAlerts = useMemo(() => {
    let filtered = [...alertsList];

    // Filter by type
    if (selectedTab !== 'all') {
      filtered = filtered.filter((alert) => alert.alert_type === selectedTab);
    }

    // Filter by read status
    if (showUnreadOnly) {
      filtered = filtered.filter((alert) => !alert.read);
    }

    // Sort by timestamp (newest first)
    filtered.sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime());

    return filtered;
  }, [alertsList, selectedTab, showUnreadOnly]);

  // Count alerts by type
  const alertCounts = useMemo(() => {
    return {
      all: alertsList.length,
      price_drop: alertsList.filter((a) => a.alert_type === 'price_drop').length,
      price_increase: alertsList.filter((a) => a.alert_type === 'price_increase').length,
      festival: alertsList.filter((a) => a.alert_type === 'festival').length,
      unread: alertsList.filter((a) => !a.read).length,
    };
  }, [alertsList]);

  const handleMarkAsRead = (alertId: string) => {
    setAlertsList((prev) =>
      prev.map((alert) => (alert.alert_id === alertId ? { ...alert, read: true } : alert))
    );
  };

  const handleMarkAllAsRead = () => {
    setAlertsList((prev) => prev.map((alert) => ({ ...alert, read: true })));
  };

  const getAlertIcon = (alert: Alert) => {
    switch (alert.alert_type) {
      case 'price_drop':
        return <TrendingDown sx={{ color: 'success.main' }} />;
      case 'price_increase':
        return <TrendingUp sx={{ color: 'error.main' }} />;
      case 'festival':
        return <Celebration sx={{ color: 'warning.main' }} />;
      default:
        return <NotificationsActive />;
    }
  };

  const getAlertLabel = (alert: Alert): string => {
    switch (alert.alert_type) {
      case 'price_drop':
        return 'Price Drop';
      case 'price_increase':
        return 'Price Increase';
      case 'festival':
        return 'Festival Deal';
      case 'back_in_stock':
        return 'Back in Stock';
      default:
        return 'Alert';
    }
  };

  const getAlertColor = (alert: Alert): 'success' | 'error' | 'warning' | 'info' => {
    switch (alert.alert_type) {
      case 'price_drop':
        return 'success';
      case 'price_increase':
        return 'error';
      case 'festival':
        return 'warning';
      default:
        return 'info';
    }
  };

  return (
    <Container maxWidth="xl" disableGutters>
      <Stack direction="row" justifyContent="space-between" alignItems="center" mb={3}>
        <Box>
          <Typography variant="h4" fontWeight={800} gutterBottom>
            Price Alerts & Notifications
          </Typography>
          <Typography variant="body2" color="text.secondary">
            Stay updated on price changes for your tracked products
          </Typography>
        </Box>
        <Badge badgeContent={alertCounts.unread} color="error">
          <NotificationsActive sx={{ fontSize: 40, color: 'primary.main' }} />
        </Badge>
      </Stack>

      {/* Filter Tabs */}
      <Card sx={{ mb: 3 }}>
        <Box sx={{ borderBottom: 1, borderColor: 'divider' }}>
          <Tabs
            value={selectedTab}
            onChange={(_e, newValue) => setSelectedTab(newValue)}
            variant="scrollable"
            scrollButtons="auto"
          >
            <Tab label={`All (${alertCounts.all})`} value="all" />
            <Tab
              label={`Price Drops (${alertCounts.price_drop})`}
              value="price_drop"
              icon={<TrendingDown fontSize="small" />}
              iconPosition="start"
            />
            <Tab
              label={`Price Increases (${alertCounts.price_increase})`}
              value="price_increase"
              icon={<TrendingUp fontSize="small" />}
              iconPosition="start"
            />
            <Tab
              label={`Festival Deals (${alertCounts.festival})`}
              value="festival"
              icon={<Celebration fontSize="small" />}
              iconPosition="start"
            />
          </Tabs>
        </Box>
      </Card>

      {/* Controls */}
      <Stack direction="row" justifyContent="space-between" alignItems="center" mb={3}>
        <FormControlLabel
          control={
            <Switch
              checked={showUnreadOnly}
              onChange={(e) => setShowUnreadOnly(e.target.checked)}
            />
          }
          label={`Show unread only (${alertCounts.unread})`}
        />
        {alertCounts.unread > 0 && (
          <Button variant="outlined" size="small" onClick={handleMarkAllAsRead}>
            Mark All as Read
          </Button>
        )}
      </Stack>

      {/* Alerts List */}
      <Stack spacing={2} mb={3}>
        {filteredAlerts.length > 0 ? (
          filteredAlerts.map((alert) => (
            <Card
              key={alert.alert_id}
              sx={{
                opacity: alert.read ? 0.7 : 1,
                borderLeft: 4,
                borderColor:
                  alert.alert_type === 'price_drop'
                    ? 'success.main'
                    : alert.alert_type === 'festival'
                    ? 'warning.main'
                    : 'error.main',
                transition: 'all 0.2s ease-in-out',
                '&:hover': {
                  transform: 'translateY(-2px)',
                  boxShadow: 4,
                },
              }}
            >
              <CardContent sx={{ p: 2.5 }}>
                <Stack direction="row" spacing={2} alignItems="flex-start">
                  {/* Icon */}
                  <Box sx={{ pt: 0.5 }}>{getAlertIcon(alert)}</Box>

                  {/* Content */}
                  <Box flex={1}>
                    <Stack direction="row" spacing={1} alignItems="center" mb={1} flexWrap="wrap">
                      <Chip label={getAlertLabel(alert)} size="small" color={getAlertColor(alert)} />
                      {!alert.read && (
                        <Chip label="NEW" size="small" color="error" variant="outlined" />
                      )}
                      <Chip
                        label={getPlatformName(alert.platform)}
                        size="small"
                        variant="outlined"
                      />
                    </Stack>

                    <Typography variant="h6" gutterBottom>
                      {alert.product_name}
                    </Typography>

                    <Stack direction="row" spacing={2} alignItems="center" mb={1} flexWrap="wrap">
                      <Typography
                        variant="body2"
                        color="text.secondary"
                        sx={{ textDecoration: 'line-through' }}
                      >
                        {formatINR(alert.old_price)}
                      </Typography>
                      <Typography variant="body2" fontWeight="bold">
                        
                      </Typography>
                      <Typography
                        variant="h6"
                        color={alert.alert_type === 'price_drop' ? 'success.main' : 'error.main'}
                        fontWeight="bold"
                      >
                        {formatINR(alert.new_price)}
                      </Typography>
                      <Chip
                        label={formatPercentage(alert.percentage_change)}
                        size="small"
                        color={alert.alert_type === 'price_drop' ? 'success' : 'error'}
                        sx={{ fontWeight: 'bold' }}
                      />
                    </Stack>

                    <Typography variant="caption" color="text.secondary">
                      {formatRelativeTime(alert.timestamp)}
                    </Typography>
                  </Box>

                  {/* Actions */}
                  <Stack spacing={1}>
                    {!alert.read && (
                      <Button
                        variant="outlined"
                        size="small"
                        startIcon={<CheckCircle />}
                        onClick={() => handleMarkAsRead(alert.alert_id)}
                      >
                        Mark as Read
                      </Button>
                    )}
                    <Button variant="contained" size="small">
                      View Product
                    </Button>
                  </Stack>
                </Stack>
              </CardContent>
            </Card>
          ))
        ) : (
          <Paper sx={{ p: 4, textAlign: 'center' }}>
            <NotificationsActive sx={{ fontSize: 60, color: 'text.disabled', mb: 2 }} />
            <Typography variant="h6" color="text.secondary" gutterBottom>
              No alerts found
            </Typography>
            <Typography variant="body2" color="text.disabled">
              {showUnreadOnly
                ? 'You have no unread alerts at the moment'
                : selectedTab !== 'all'
                ? `No ${selectedTab.replace('_', ' ')} alerts yet`
                : 'Start tracking products to receive price alerts'}
            </Typography>
          </Paper>
        )}
      </Stack>

      {/* Alert Settings */}
      <Card>
        <CardContent sx={{ p: 2.5 }}>
          <Stack direction="row" spacing={1} alignItems="center" mb={2}>
            <Settings color="primary" />
            <Typography variant="h6">Notification Settings</Typography>
          </Stack>
          <Divider sx={{ mb: 2 }} />

          <Typography variant="subtitle2" gutterBottom>
            Notification Channels
          </Typography>
          <FormGroup sx={{ mb: 3 }}>
            <FormControlLabel
              control={
                <Checkbox
                  checked={notificationSettings.emailNotifications}
                  onChange={(e) =>
                    setNotificationSettings({
                      ...notificationSettings,
                      emailNotifications: e.target.checked,
                    })
                  }
                />
              }
              label="Email notifications"
            />
            <FormControlLabel
              control={
                <Checkbox
                  checked={notificationSettings.pushNotifications}
                  onChange={(e) =>
                    setNotificationSettings({
                      ...notificationSettings,
                      pushNotifications: e.target.checked,
                    })
                  }
                />
              }
              label="Push notifications (browser/mobile)"
            />
          </FormGroup>

          <Typography variant="subtitle2" gutterBottom>
            Alert Types
          </Typography>
          <FormGroup sx={{ mb: 2 }}>
            <FormControlLabel
              control={
                <Checkbox
                  checked={notificationSettings.priceDropAlerts}
                  onChange={(e) =>
                    setNotificationSettings({
                      ...notificationSettings,
                      priceDropAlerts: e.target.checked,
                    })
                  }
                />
              }
              label={
                <Stack direction="row" spacing={1} alignItems="center">
                  <TrendingDown fontSize="small" color="success" />
                  <Typography variant="body2">Price drop alerts</Typography>
                </Stack>
              }
            />
            <FormControlLabel
              control={
                <Checkbox
                  checked={notificationSettings.priceIncreaseAlerts}
                  onChange={(e) =>
                    setNotificationSettings({
                      ...notificationSettings,
                      priceIncreaseAlerts: e.target.checked,
                    })
                  }
                />
              }
              label={
                <Stack direction="row" spacing={1} alignItems="center">
                  <TrendingUp fontSize="small" color="error" />
                  <Typography variant="body2">Price increase alerts</Typography>
                </Stack>
              }
            />
            <FormControlLabel
              control={
                <Checkbox
                  checked={notificationSettings.festivalAlerts}
                  onChange={(e) =>
                    setNotificationSettings({
                      ...notificationSettings,
                      festivalAlerts: e.target.checked,
                    })
                  }
                />
              }
              label={
                <Stack direction="row" spacing={1} alignItems="center">
                  <Celebration fontSize="small" color="warning" />
                  <Typography variant="body2">Festival deal alerts</Typography>
                </Stack>
              }
            />
            <FormControlLabel
              control={
                <Checkbox
                  checked={notificationSettings.backInStockAlerts}
                  onChange={(e) =>
                    setNotificationSettings({
                      ...notificationSettings,
                      backInStockAlerts: e.target.checked,
                    })
                  }
                />
              }
              label={
                <Stack direction="row" spacing={1} alignItems="center">
                  <CheckCircle fontSize="small" color="info" />
                  <Typography variant="body2">Back in stock alerts</Typography>
                </Stack>
              }
            />
          </FormGroup>

          <Button variant="contained" fullWidth>
            Save Settings
          </Button>
        </CardContent>
      </Card>
    </Container>
  );
};

export default AlertsPage;
</file>

<file path="src/pages/ChatPage.tsx">
import { useState, useEffect, useRef } from 'react';
import {
  Box,
  Container,
  Paper,
  TextField,
  Typography,
  Avatar,
  Chip,
  Card,
  CardContent,
  Stack,
  IconButton,
  alpha,
} from '@mui/material';
import {
  Send as SendIcon,
  Star as StarIcon,
  AutoAwesome,
} from '@mui/icons-material';
import type { ChatMessage, Product } from '../types';
import { formatINR, getPlatformColor, getPlatformName } from '../utils/formatters';
import { generateAIResponse } from '../utils/chatResponses';
import { sampleProducts } from '../data/sampleData';

export default function ChatPage() {
  const [messages, setMessages] = useState<ChatMessage[]>([]);
  const [inputValue, setInputValue] = useState('');
  const [isTyping, setIsTyping] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);
  const inputRef = useRef<HTMLInputElement>(null);

  useEffect(() => {
    const welcomeMessage: ChatMessage = {
      id: '1',
      role: 'assistant',
      content:
        "Hello! I'm your RetailIQ AI Shopping Assistant. I can help you find the best deals, compare prices across Amazon and Flipkart, and recommend products based on your budget. What are you looking for today?",
      timestamp: new Date().toISOString(),
    };
    setMessages([welcomeMessage]);
  }, []);

  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages, isTyping]);

  const handleSend = () => {
    if (!inputValue.trim() || isTyping) return;

    const userMessage: ChatMessage = {
      id: Date.now().toString(),
      role: 'user',
      content: inputValue,
      timestamp: new Date().toISOString(),
    };

    setMessages((prev) => [...prev, userMessage]);
    const query = inputValue;
    setInputValue('');
    setIsTyping(true);

    setTimeout(() => {
      const aiResponse = generateAIResponse(query, sampleProducts);
      const assistantMessage: ChatMessage = {
        id: (Date.now() + 1).toString(),
        role: 'assistant',
        content: aiResponse.text,
        timestamp: new Date().toISOString(),
        products: aiResponse.products,
      };
      setMessages((prev) => [...prev, assistantMessage]);
      setIsTyping(false);
      inputRef.current?.focus();
    }, 1200 + Math.random() * 800);
  };

  const getProductTag = (product: Product): { label: string; color: string } => {
    const discount = ((product.original_price - product.current_price) / product.original_price) * 100;
    if (discount > 20) return { label: 'BEST VALUE', color: '#10b981' };
    if (product.rating >= 4.5) return { label: 'TOP RATED', color: '#3b82f6' };
    if (product.current_price < 30000) return { label: 'BUDGET PICK', color: '#f59e0b' };
    return { label: 'POPULAR', color: '#8b5cf6' };
  };

  const quickActions = [
    'Best phone under 30k',
    'Compare earbuds',
    'Festival deals',
    'Price drop alerts',
    'Laptop recommendations',
  ];

  return (
    <Box sx={{ height: 'calc(100vh - 120px)', display: 'flex', flexDirection: 'column', mx: -3, my: -3 }}>
      {/* Messages */}
      <Box
        sx={{
          flex: 1,
          overflowY: 'auto',
          px: { xs: 2, sm: 3 },
          py: 3,
        }}
      >
        <Container maxWidth="md" disableGutters>
          {messages.map((message) => (
            <Box
              key={message.id}
              sx={{
                display: 'flex',
                justifyContent: message.role === 'user' ? 'flex-end' : 'flex-start',
                mb: 2.5,
                animation: 'fadeInUp 0.3s ease',
                '@keyframes fadeInUp': {
                  from: { opacity: 0, transform: 'translateY(8px)' },
                  to: { opacity: 1, transform: 'translateY(0)' },
                },
              }}
            >
              {message.role === 'assistant' && (
                <Avatar
                  sx={{
                    bgcolor: '#1a237e',
                    mr: 1.5,
                    mt: 0.5,
                    width: 36,
                    height: 36,
                    boxShadow: '0 2px 8px rgba(26,35,126,0.2)',
                  }}
                >
                  <AutoAwesome sx={{ fontSize: 18 }} />
                </Avatar>
              )}

              <Box sx={{ maxWidth: message.role === 'user' ? '75%' : '82%', minWidth: 0 }}>
                <Paper
                  elevation={0}
                  sx={{
                    p: 2,
                    bgcolor: message.role === 'user' ? '#1a237e' : '#fff',
                    color: message.role === 'user' ? '#fff' : 'text.primary',
                    borderRadius: message.role === 'user' ? '16px 16px 4px 16px' : '16px 16px 16px 4px',
                    border: message.role === 'user' ? 'none' : '1px solid rgba(0,0,0,0.06)',
                    boxShadow: message.role === 'user'
                      ? '0 2px 12px rgba(26,35,126,0.2)'
                      : '0 1px 4px rgba(0,0,0,0.04)',
                  }}
                >
                  <Typography
                    variant="body2"
                    sx={{ whiteSpace: 'pre-wrap', wordBreak: 'break-word', lineHeight: 1.65 }}
                  >
                    {message.content}
                  </Typography>

                  {message.products && message.products.length > 0 && (
                    <Stack spacing={1.5} mt={2}>
                      {message.products.map((product) => {
                        const tag = getProductTag(product);
                        const discount = Math.round(
                          ((product.original_price - product.current_price) / product.original_price) * 100
                        );

                        return (
                          <Card
                            key={product.product_id}
                            sx={{
                              border: '1px solid rgba(0,0,0,0.06)',
                              borderRadius: 2.5,
                              transition: 'all 0.2s ease',
                              '&:hover': { borderColor: 'primary.light', transform: 'translateY(-1px)' },
                            }}
                          >
                            <CardContent sx={{ p: 2, '&:last-child': { pb: 2 } }}>
                              <Stack direction="row" spacing={1} mb={1} flexWrap="wrap" gap={0.5}>
                                <Chip
                                  label={tag.label}
                                  size="small"
                                  sx={{ bgcolor: tag.color, color: '#fff', fontWeight: 700, fontSize: '0.625rem', height: 22 }}
                                />
                                <Chip
                                  label={getPlatformName(product.platform)}
                                  size="small"
                                  sx={{ bgcolor: getPlatformColor(product.platform), color: '#fff', fontSize: '0.625rem', height: 22 }}
                                />
                                <Stack direction="row" spacing={0.5} alignItems="center">
                                  <StarIcon sx={{ fontSize: 14, color: '#f59e0b' }} />
                                  <Typography variant="caption" fontWeight={700}>{product.rating}</Typography>
                                  <Typography variant="caption" color="text.secondary">
                                    ({product.review_count.toLocaleString()})
                                  </Typography>
                                </Stack>
                              </Stack>

                              <Typography variant="body2" fontWeight={600} sx={{ mb: 1 }}>
                                {product.product_name}
                              </Typography>

                              <Stack direction="row" alignItems="baseline" spacing={1}>
                                <Typography variant="h6" fontWeight={800} color="success.main">
                                  {formatINR(product.current_price)}
                                </Typography>
                                {product.original_price > product.current_price && (
                                  <>
                                    <Typography variant="body2" sx={{ textDecoration: 'line-through' }} color="text.secondary">
                                      {formatINR(product.original_price)}
                                    </Typography>
                                    <Chip
                                      label={`${discount}% OFF`}
                                      size="small"
                                      color="error"
                                      sx={{ height: 20, fontSize: '0.625rem', fontWeight: 700 }}
                                    />
                                  </>
                                )}
                              </Stack>
                            </CardContent>
                          </Card>
                        );
                      })}
                    </Stack>
                  )}
                </Paper>
                <Typography
                  variant="caption"
                  color="text.disabled"
                  sx={{ ml: 1, mt: 0.5, display: 'block', fontSize: '0.625rem' }}
                >
                  {new Date(message.timestamp).toLocaleTimeString('en-IN', { hour: '2-digit', minute: '2-digit' })}
                </Typography>
              </Box>

              {message.role === 'user' && (
                <Avatar
                  sx={{
                    bgcolor: 'secondary.main',
                    ml: 1.5,
                    mt: 0.5,
                    width: 36,
                    height: 36,
                    fontWeight: 700,
                    fontSize: '0.875rem',
                  }}
                >
                  U
                </Avatar>
              )}
            </Box>
          ))}

          {isTyping && (
            <Box sx={{ display: 'flex', mb: 3, animation: 'fadeInUp 0.3s ease',
              '@keyframes fadeInUp': { from: { opacity: 0, transform: 'translateY(8px)' }, to: { opacity: 1, transform: 'translateY(0)' } },
            }}>
              <Avatar sx={{ bgcolor: '#1a237e', mr: 1.5, mt: 0.5, width: 36, height: 36 }}>
                <AutoAwesome sx={{ fontSize: 18 }} />
              </Avatar>
              <Paper
                elevation={0}
                sx={{
                  px: 2.5,
                  py: 1.5,
                  bgcolor: '#fff',
                  borderRadius: '16px 16px 16px 4px',
                  border: '1px solid rgba(0,0,0,0.06)',
                }}
              >
                <Stack direction="row" spacing={0.75} alignItems="center">
                  {[0, 1, 2].map((i) => (
                    <Box
                      key={i}
                      sx={{
                        width: 7,
                        height: 7,
                        borderRadius: '50%',
                        bgcolor: '#1a237e',
                        opacity: 0.5,
                        animation: `bounce 1.2s infinite ${i * 0.15}s`,
                        '@keyframes bounce': {
                          '0%, 60%, 100%': { transform: 'translateY(0)' },
                          '30%': { transform: 'translateY(-8px)' },
                        },
                      }}
                    />
                  ))}
                </Stack>
              </Paper>
            </Box>
          )}
          <div ref={messagesEndRef} />
        </Container>
      </Box>

      {/* Input */}
      <Paper
        elevation={0}
        sx={{
          p: 2,
          borderTop: '1px solid rgba(0,0,0,0.06)',
          bgcolor: '#fff',
        }}
      >
        <Container maxWidth="md" disableGutters>
          <Stack direction="row" spacing={1} mb={1.5} sx={{ overflowX: 'auto', pb: 0.5 }}>
            {quickActions.map((action) => (
              <Chip
                key={action}
                label={action}
                size="small"
                onClick={() => setInputValue(action)}
                sx={{
                  flexShrink: 0,
                  transition: 'all 0.15s ease',
                  '&:hover': { bgcolor: (theme) => alpha(theme.palette.primary.main, 0.08) },
                  cursor: 'pointer',
                }}
              />
            ))}
          </Stack>
          <Stack direction="row" spacing={1} alignItems="flex-end">
            <TextField
              fullWidth
              placeholder="Ask about products, prices, deals..."
              value={inputValue}
              onChange={(e) => setInputValue(e.target.value)}
              inputRef={inputRef}
              onKeyDown={(e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                  e.preventDefault();
                  handleSend();
                }
              }}
              variant="outlined"
              multiline
              maxRows={3}
              disabled={isTyping}
              size="small"
              sx={{ '& .MuiOutlinedInput-root': { borderRadius: '12px', bgcolor: '#f8f9fb' } }}
            />
            <IconButton
              onClick={handleSend}
              disabled={!inputValue.trim() || isTyping}
              sx={{
                bgcolor: 'primary.main',
                color: '#fff',
                width: 44,
                height: 44,
                borderRadius: '12px',
                '&:hover': { bgcolor: 'primary.dark' },
                '&.Mui-disabled': { bgcolor: 'rgba(0,0,0,0.08)', color: 'rgba(0,0,0,0.26)' },
                transition: 'all 0.2s ease',
              }}
            >
              <SendIcon sx={{ fontSize: 20 }} />
            </IconButton>
          </Stack>
        </Container>
      </Paper>
    </Box>
  );
}
</file>

<file path="src/pages/CompetitiveIntel.tsx">
import React from 'react';
import {
  Box,
  Container,
  Typography,
  Grid,
  Card,
  CardContent,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Chip,
  List,
  ListItem,
  ListItemText,
  Divider,
  Stack,
  LinearProgress,
} from '@mui/material';
import {
  TrendingUp as TrendingUpIcon,
  Store as StoreIcon,
  AttachMoney as MoneyIcon,
  Warning as WarningIcon,
  Lightbulb as LightbulbIcon,
} from '@mui/icons-material';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  BarElement,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
} from 'chart.js';
import { Bar } from 'react-chartjs-2';
import { formatINR } from '../utils/formatters';
import { sampleCompetitors, sampleOpportunities, sampleThreats, priceDistribution } from '../data/sampleData';

// Register Chart.js components
ChartJS.register(CategoryScale, LinearScale, BarElement, PointElement, LineElement, Title, Tooltip, Legend);

export default function CompetitiveIntel() {
  const userPosition = 25200; // User's average price
  const marketAvg = 23500;

  // Price Distribution Chart Data
  const chartData = {
    labels: priceDistribution.map((d) => d.range),
    datasets: [
      {
        label: 'Number of Competitors',
        data: priceDistribution.map((d) => d.count),
        backgroundColor: priceDistribution.map((d) =>
          d.range === '25k-30k' ? 'rgba(33, 150, 243, 0.7)' : 'rgba(158, 158, 158, 0.5)'
        ),
        borderColor: priceDistribution.map((d) => (d.range === '25k-30k' ? '#2196f3' : '#9e9e9e')),
        borderWidth: 2,
      },
    ],
  };

  const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false,
      },
      title: {
        display: true,
        text: 'Market Price Distribution (Your position highlighted)',
        font: {
          size: 14,
          weight: 'bold' as const,
        },
      },
      tooltip: {
        callbacks: {
          label: (context: any) => {
            return `${context.parsed.y} retailers in this range`;
          },
        },
      },
    },
    scales: {
      y: {
        beginAtZero: true,
        title: {
          display: true,
          text: 'Number of Retailers',
        },
        ticks: {
          stepSize: 10,
        },
      },
      x: {
        title: {
          display: true,
          text: 'Price Range',
        },
      },
    },
  };

  return (
    <Container maxWidth="xl" disableGutters>
      {/* Page Header */}
      <Box sx={{ mb: 3 }}>
        <Typography variant="h4" fontWeight={800} sx={{ mb: 1 }}>
          Competitive Intelligence Dashboard
        </Typography>
        <Box sx={{ display: 'flex', gap: 2, alignItems: 'center' }}>
          <Typography variant="body2" color="text.secondary">
            Market: Mumbai
          </Typography>
          <Divider orientation="vertical" flexItem />
          <Typography variant="body2" color="text.secondary">
            Period: Last 30 Days
          </Typography>
        </Box>
      </Box>

      {/* Market Overview KPIs */}
      <Grid container spacing={3} sx={{ mb: 3 }}>
        {/* Market Size */}
        <Grid size={{ xs: 12, md: 4 }}>
          <Card sx={{ height: '100%' }}>
            <CardContent sx={{ p: 2.5 }}>
              <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                <MoneyIcon sx={{ color: 'primary.main', mr: 1 }} />
                <Typography variant="subtitle2" color="text.secondary">
                  Market Size
                </Typography>
              </Box>
              <Typography variant="h4" sx={{ fontWeight: 700, mb: 0.5 }}>
                45.2 Cr
              </Typography>
              <Typography variant="body2" color="text.secondary">
                Monthly Transaction Volume
              </Typography>
            </CardContent>
          </Card>
        </Grid>

        {/* Competitors */}
        <Grid size={{ xs: 12, md: 4 }}>
          <Card sx={{ height: '100%' }}>
            <CardContent sx={{ p: 2.5 }}>
              <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                <StoreIcon sx={{ color: 'warning.main', mr: 1 }} />
                <Typography variant="subtitle2" color="text.secondary">
                  Active Competitors
                </Typography>
              </Box>
              <Box sx={{ display: 'flex', alignItems: 'baseline', gap: 1, mb: 0.5 }}>
                <Typography variant="h4" sx={{ fontWeight: 700 }}>
                  23
                </Typography>
                <Typography variant="body1" color="text.secondary">
                  in your area
                </Typography>
              </Box>
              <Chip label="Your Rank: #8" color="info" size="small" sx={{ fontWeight: 600 }} />
            </CardContent>
          </Card>
        </Grid>

        {/* Market Growth */}
        <Grid size={{ xs: 12, md: 4 }}>
          <Card sx={{ height: '100%' }}>
            <CardContent sx={{ p: 2.5 }}>
              <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>
                <TrendingUpIcon sx={{ color: 'success.main', mr: 1 }} />
                <Typography variant="subtitle2" color="text.secondary">
                  Market Growth
                </Typography>
              </Box>
              <Box sx={{ display: 'flex', alignItems: 'center', gap: 1, mb: 0.5 }}>
                <Typography variant="h4" sx={{ fontWeight: 700, color: 'success.main' }}>
                  +12%
                </Typography>
                <TrendingUpIcon sx={{ fontSize: 32, color: 'success.main' }} />
              </Box>
              <Typography variant="body2" color="text.secondary">
                vs Previous Period
              </Typography>
            </CardContent>
          </Card>
        </Grid>
      </Grid>

      {/* Competitive Position Visualization */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
            Your Competitive Position
          </Typography>

          <Box sx={{ mb: 2 }}>
            <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 1 }}>
              <Typography variant="body2" color="text.secondary">
                Lowest Price: {formatINR(20800)}
              </Typography>
              <Typography variant="body2" sx={{ fontWeight: 600, color: 'primary.main' }}>
                Your Price: {formatINR(userPosition)}
              </Typography>
              <Typography variant="body2" color="text.secondary">
                Highest Price: {formatINR(26100)}
              </Typography>
            </Box>
            <Box sx={{ position: 'relative', height: 40, bgcolor: 'grey.300', borderRadius: 1, overflow: 'visible' }}>
              {/* Market Average Marker */}
              <Box
                sx={{
                  position: 'absolute',
                  left: `${((marketAvg - 20800) / (26100 - 20800)) * 100}%`,
                  top: -8,
                  transform: 'translateX(-50%)',
                  width: 2,
                  height: 56,
                  bgcolor: 'grey.500',
                }}
              >
                <Typography
                  variant="caption"
                  sx={{
                    position: 'absolute',
                    top: -20,
                    left: '50%',
                    transform: 'translateX(-50%)',
                    whiteSpace: 'nowrap',
                    color: 'grey.500',
                    fontWeight: 600,
                  }}
                >
                  Market Avg
                </Typography>
              </Box>

              {/* User Position Marker */}
              <Box
                sx={{
                  position: 'absolute',
                  left: `${((userPosition - 20800) / (26100 - 20800)) * 100}%`,
                  top: 0,
                  transform: 'translateX(-50%)',
                  width: 4,
                  height: 40,
                  bgcolor: 'primary.main',
                  borderRadius: 1,
                  boxShadow: 3,
                }}
              />

              {/* Price Range Bar */}
              <Box
                sx={{
                  position: 'absolute',
                  left: 0,
                  top: 15,
                  width: '100%',
                  height: 10,
                  background: 'linear-gradient(to right, #4caf50, #ffc107, #f44336)',
                  borderRadius: 1,
                }}
              />
            </Box>
            <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 1 }}>
              <Typography variant="caption" color="success.main">
                Competitive
              </Typography>
              <Typography variant="caption" color="warning.main">
                Market Average
              </Typography>
              <Typography variant="caption" color="error">
                Premium
              </Typography>
            </Box>
          </Box>

          <Grid container spacing={2} sx={{ mt: 2 }}>
            <Grid size={{ xs: 12, md: 4 }}>
              <Card variant="outlined">
                <CardContent sx={{ p: 2.5 }}>
                  <Typography variant="body2" color="text.secondary" gutterBottom>
                    Position Status
                  </Typography>
                  <Typography variant="h6" sx={{ fontWeight: 600, color: 'warning.dark' }}>
                    7% Above Market
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
            <Grid size={{ xs: 12, md: 4 }}>
              <Card variant="outlined">
                <CardContent sx={{ p: 2.5 }}>
                  <Typography variant="body2" color="text.secondary" gutterBottom>
                    Competitive Advantage
                  </Typography>
                  <Typography variant="h6" sx={{ fontWeight: 600, color: 'success.main' }}>
                    Service Quality
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
            <Grid size={{ xs: 12, md: 4 }}>
              <Card variant="outlined">
                <CardContent sx={{ p: 2.5 }}>
                  <Typography variant="body2" color="text.secondary" gutterBottom>
                    Recommended Action
                  </Typography>
                  <Typography variant="h6" sx={{ fontWeight: 600, color: 'primary.main' }}>
                    Reduce by 3-5%
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
          </Grid>
        </CardContent>
      </Card>

      {/* Top Competitors Table */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
            Top Competitors Analysis
          </Typography>

          <TableContainer>
            <Table>
              <TableHead>
                <TableRow sx={{ bgcolor: 'grey.50' }}>
                  <TableCell sx={{ fontWeight: 600 }}>Rank</TableCell>
                  <TableCell sx={{ fontWeight: 600 }}>Retailer</TableCell>
                  <TableCell sx={{ fontWeight: 600 }} align="right">
                    Avg Price
                  </TableCell>
                  <TableCell sx={{ fontWeight: 600 }} align="right">
                    Market Share
                  </TableCell>
                  <TableCell sx={{ fontWeight: 600 }}>Strategy</TableCell>
                </TableRow>
              </TableHead>
              <TableBody>
                {sampleCompetitors.map((competitor) => (
                  <TableRow
                    key={competitor.rank}
                    sx={{
                      bgcolor: competitor.isUser ? 'primary.50' : 'transparent',
                      fontWeight: competitor.isUser ? 600 : 400,
                      '&:hover': { bgcolor: competitor.isUser ? 'primary.50' : 'grey.50' },
                    }}
                  >
                    <TableCell>
                      {competitor.isUser ? (
                        <Chip label={`#${competitor.rank}`} color="primary" size="small" sx={{ fontWeight: 700 }} />
                      ) : (
                        `#${competitor.rank}`
                      )}
                    </TableCell>
                    <TableCell>
                      <Typography sx={{ fontWeight: competitor.isUser ? 600 : 400 }}>
                        {competitor.name}
                        {competitor.isUser && (
                          <Chip label="YOU" color="primary" size="small" sx={{ ml: 1, fontWeight: 700 }} />
                        )}
                      </Typography>
                    </TableCell>
                    <TableCell align="right">{formatINR(competitor.avg_price)}</TableCell>
                    <TableCell align="right">
                      <Box>
                        <Typography variant="body2" sx={{ mb: 0.5 }}>
                          {competitor.market_share.toFixed(1)}%
                        </Typography>
                        <LinearProgress
                          variant="determinate"
                          value={competitor.market_share}
                          sx={{ height: 6, borderRadius: 1 }}
                        />
                      </Box>
                    </TableCell>
                    <TableCell>{competitor.strategy}</TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          </TableContainer>
        </CardContent>
      </Card>

      {/* Price Distribution Chart */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
            Market Price Distribution
          </Typography>

          <Box sx={{ height: 350 }}>
            <Bar data={chartData} options={chartOptions} />
          </Box>

          <Box sx={{ mt: 2, p: 2, bgcolor: 'grey.50', borderRadius: 1 }}>
            <Typography variant="body2" color="text.secondary">
              <strong>Insight:</strong> Most competitors (78 retailers) are clustered in the 20k-25k range. Your
              pricing puts you in the 25k-30k bracket with 52 other retailers, which represents the premium segment.
              Consider competitive repositioning to capture more market share.
            </Typography>
          </Box>
        </CardContent>
      </Card>

      {/* Market Opportunities and Threats */}
      <Grid container spacing={3}>
        {/* Market Opportunities */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Card sx={{ height: '100%' }}>
            <CardContent sx={{ p: 2.5 }}>
              <Box sx={{ display: 'flex', alignItems: 'center', mb: 3 }}>
                <LightbulbIcon sx={{ color: 'success.main', mr: 1 }} />
                <Typography variant="h6" sx={{ fontWeight: 600 }}>
                  Market Opportunities
                </Typography>
              </Box>

              <Stack spacing={2}>
                {sampleOpportunities.map((opp, index) => (
                  <Card
                    key={index}
                    variant="outlined"
                    sx={{
                      bgcolor: 'success.50',
                      borderColor: 'success.main',
                    }}
                  >
                    <CardContent sx={{ p: 2.5 }}>
                      <Typography variant="subtitle1" sx={{ fontWeight: 600, mb: 1 }}>
                        {opp.product}
                      </Typography>
                      <Grid container spacing={1}>
                        <Grid size={{ xs: 6 }}>
                          <Typography variant="body2" color="text.secondary" sx={{ fontSize: '0.875rem' }}>
                            Demand Change
                          </Typography>
                          <Typography variant="body2" sx={{ fontWeight: 600, color: 'success.main' }}>
                            {opp.demand_change}
                          </Typography>
                        </Grid>
                        <Grid size={{ xs: 6 }}>
                          <Typography variant="body2" color="text.secondary" sx={{ fontSize: '0.875rem' }}>
                            Competition
                          </Typography>
                          <Chip
                            label={opp.competition}
                            size="small"
                            color={opp.competition === 'Low' ? 'success' : 'warning'}
                          />
                        </Grid>
                        <Grid size={{ xs: 6 }}>
                          <Typography variant="body2" color="text.secondary" sx={{ fontSize: '0.875rem' }}>
                            Avg Price
                          </Typography>
                          <Typography variant="body2" sx={{ fontWeight: 600 }}>
                            {formatINR(opp.avg_price)}
                          </Typography>
                        </Grid>
                        <Grid size={{ xs: 6 }}>
                          <Typography variant="body2" color="text.secondary" sx={{ fontSize: '0.875rem' }}>
                            Potential Margin
                          </Typography>
                          <Typography variant="body2" sx={{ fontWeight: 600, color: 'success.main' }}>
                            {opp.potential_margin}
                          </Typography>
                        </Grid>
                      </Grid>
                    </CardContent>
                  </Card>
                ))}
              </Stack>
            </CardContent>
          </Card>
        </Grid>

        {/* Competitive Threats */}
        <Grid size={{ xs: 12, md: 6 }}>
          <Card sx={{ height: '100%' }}>
            <CardContent sx={{ p: 2.5 }}>
              <Box sx={{ display: 'flex', alignItems: 'center', mb: 3 }}>
                <WarningIcon sx={{ color: 'error.main', mr: 1 }} />
                <Typography variant="h6" sx={{ fontWeight: 600 }}>
                  Competitive Threats
                </Typography>
              </Box>

              <List>
                {sampleThreats.map((threat, index) => (
                  <React.Fragment key={index}>
                    <ListItem
                      sx={{
                        px: 0,
                        alignItems: 'flex-start',
                        bgcolor: 'error.50',
                        borderRadius: 1,
                        mb: 2,
                        p: 2,
                      }}
                    >
                      <ListItemText
                        primary={
                          <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', mb: 1 }}>
                            <Typography variant="subtitle2" sx={{ fontWeight: 600 }}>
                              {threat.competitor}
                            </Typography>
                            <Chip
                              label={`${threat.impact} Impact`}
                              size="small"
                              color={threat.impact === 'High' ? 'error' : 'warning'}
                            />
                          </Box>
                        }
                        secondary={
                          <>
                            <Typography variant="body2" sx={{ mb: 0.5 }}>
                              {threat.action}
                            </Typography>
                            <Typography variant="caption" color="text.secondary">
                              {threat.date}
                            </Typography>
                          </>
                        }
                      />
                    </ListItem>
                  </React.Fragment>
                ))}
              </List>
            </CardContent>
          </Card>
        </Grid>
      </Grid>
    </Container>
  );
}
</file>

<file path="src/pages/ConsumerDashboard.tsx">
import { useState } from 'react';
import {
  Box,
  Container,
  Typography,
  Card,
  CardContent,
  Button,
  TextField,
  Chip,
  Grid,
  Paper,
  Stack,
  alpha,
  Avatar,
} from '@mui/material';
import {
  TrendingUp,
  TrendingDown,
  ChatBubbleOutline,
  AddCircleOutline,
  NotificationsActive,
  Celebration,
  ArrowForward,
  PriceChange,
  Inventory,
  AutoAwesome,
  LocalFireDepartment,
  Shield,
  Speed,
} from '@mui/icons-material';
import { Link } from 'react-router-dom';
import { formatINR, formatPercentage, formatRelativeTime } from '../utils/formatters';
import {
  watchlistProducts,
  getRecentAlerts,
  getNextFestival,
  trendingProducts,
  recommendedProducts,
} from '../data/sampleData';

const ConsumerDashboard: React.FC = () => {
  const [trackUrl, setTrackUrl] = useState('');
  const nextFestival = getNextFestival();
  const recentAlerts = getRecentAlerts();

  const handleTrackProduct = () => {
    if (trackUrl) {
      setTrackUrl('');
    }
  };

  const quickStats = [
    { label: 'Products Tracked', value: watchlistProducts.length.toString(), icon: <Inventory />, color: '#1a237e' },
    { label: 'Price Drops Today', value: '3', icon: <TrendingDown />, color: '#10b981' },
    { label: 'Active Alerts', value: recentAlerts.length.toString(), icon: <NotificationsActive />, color: '#f59e0b' },
    { label: 'Avg Savings', value: '18%', icon: <Shield />, color: '#8b5cf6' },
  ];

  return (
    <Container maxWidth="xl" disableGutters>
      {/* Festival Alert Banner */}
      {nextFestival && (
        <Paper
          sx={{
            mb: 3,
            p: 2.5,
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            color: '#fff',
            borderRadius: 3,
            position: 'relative',
            overflow: 'hidden',
          }}
        >
          <Box sx={{ position: 'absolute', right: -20, top: -20, opacity: 0.1 }}>
            <Celebration sx={{ fontSize: 200 }} />
          </Box>
          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2} alignItems={{ xs: 'flex-start', sm: 'center' }} justifyContent="space-between" position="relative">
            <Stack direction="row" spacing={2} alignItems="center">
              <Avatar sx={{ bgcolor: 'rgba(255,255,255,0.2)', width: 48, height: 48 }}>
                <Celebration />
              </Avatar>
              <Box>
                <Typography variant="h6" fontWeight={700} sx={{ mb: 0.25 }}>
                  {nextFestival.name} in {nextFestival.days_until} days
                </Typography>
                <Stack direction="row" spacing={1} alignItems="center" flexWrap="wrap">
                  <Chip
                    label={`Up to ${nextFestival.historical_discount_avg}% OFF`}
                    size="small"
                    sx={{ bgcolor: 'rgba(255,255,255,0.2)', color: '#fff', fontWeight: 700 }}
                  />
                  <Typography variant="body2" sx={{ opacity: 0.85 }}>
                    on {nextFestival.affected_categories.slice(0, 3).join(', ')}
                  </Typography>
                </Stack>
              </Box>
            </Stack>
            <Button
              component={Link}
              to="/consumer/festivals"
              variant="contained"
              endIcon={<ArrowForward />}
              sx={{
                bgcolor: 'rgba(255,255,255,0.2)',
                color: '#fff',
                '&:hover': { bgcolor: 'rgba(255,255,255,0.3)' },
                backdropFilter: 'blur(10px)',
                fontWeight: 600,
                flexShrink: 0,
              }}
            >
              View Deals
            </Button>
          </Stack>
        </Paper>
      )}

      {/* Quick Stats */}
      <Grid container spacing={2} sx={{ mb: 3 }} className="stagger-children">
        {quickStats.map((stat) => (
          <Grid key={stat.label} size={{ xs: 6, md: 3 }}>
            <Card sx={{ height: '100%' }}>
              <CardContent sx={{ p: 2, '&:last-child': { pb: 2 } }}>
                <Stack direction="row" spacing={1.5} alignItems="center">
                  <Avatar
                    sx={{
                      width: 40,
                      height: 40,
                      bgcolor: alpha(stat.color, 0.08),
                      color: stat.color,
                    }}
                  >
                    {stat.icon}
                  </Avatar>
                  <Box>
                    <Typography variant="h5" fontWeight={800} color={stat.color}>
                      {stat.value}
                    </Typography>
                    <Typography variant="caption" color="text.secondary" fontWeight={500}>
                      {stat.label}
                    </Typography>
                  </Box>
                </Stack>
              </CardContent>
            </Card>
          </Grid>
        ))}
      </Grid>

      {/* Main 2-Column Layout */}
      <Grid container spacing={3}>
        {/* Left Column */}
        <Grid size={{ xs: 12, md: 7 }}>
          <Stack spacing={3}>
            {/* AI Shopping Agent */}
            <Card
              sx={{
                background: 'linear-gradient(135deg, #0d1642 0%, #1a237e 60%, #283593 100%)',
                color: '#fff',
                position: 'relative',
                overflow: 'hidden',
              }}
            >
              <Box sx={{ position: 'absolute', right: -30, bottom: -30, opacity: 0.06 }}>
                <AutoAwesome sx={{ fontSize: 240 }} />
              </Box>
              <CardContent sx={{ p: 3, position: 'relative' }}>
                <Stack direction="row" spacing={2} alignItems="center" mb={2}>
                  <Avatar sx={{ bgcolor: 'rgba(255,255,255,0.15)', width: 48, height: 48 }}>
                    <AutoAwesome />
                  </Avatar>
                  <Box>
                    <Typography variant="h5" fontWeight={700}>
                      AI Shopping Agent
                    </Typography>
                    <Typography variant="body2" sx={{ opacity: 0.75 }}>
                      Your personal deal finder across Amazon & Flipkart
                    </Typography>
                  </Box>
                </Stack>
                <Stack direction="row" spacing={1} mb={2.5} flexWrap="wrap" gap={0.5}>
                  {['Best phone under 50k', 'Compare prices', 'When to buy?'].map((q) => (
                    <Chip
                      key={q}
                      label={q}
                      size="small"
                      sx={{
                        bgcolor: 'rgba(255,255,255,0.1)',
                        color: '#fff',
                        border: '1px solid rgba(255,255,255,0.15)',
                        '&:hover': { bgcolor: 'rgba(255,255,255,0.2)' },
                        cursor: 'pointer',
                      }}
                    />
                  ))}
                </Stack>
                <Button
                  component={Link}
                  to="/consumer/chat"
                  variant="contained"
                  fullWidth
                  size="large"
                  startIcon={<ChatBubbleOutline />}
                  sx={{
                    bgcolor: 'rgba(255,255,255,0.15)',
                    color: '#fff',
                    '&:hover': { bgcolor: 'rgba(255,255,255,0.25)', transform: 'translateY(-1px)' },
                    backdropFilter: 'blur(10px)',
                    fontWeight: 700,
                    py: 1.5,
                  }}
                >
                  Start Shopping Chat
                </Button>
              </CardContent>
            </Card>

            {/* Track New Product */}
            <Card>
              <CardContent sx={{ p: 2.5 }}>
                <Stack direction="row" spacing={1.5} alignItems="center" mb={1.5}>
                  <Avatar sx={{ width: 36, height: 36, bgcolor: (theme) => alpha(theme.palette.primary.main, 0.08) }}>
                    <AddCircleOutline color="primary" sx={{ fontSize: 20 }} />
                  </Avatar>
                  <Box>
                    <Typography variant="h6" fontWeight={700}>Track New Product</Typography>
                    <Typography variant="caption" color="text.secondary">
                      Paste a URL from Amazon India or Flipkart
                    </Typography>
                  </Box>
                </Stack>
                <Stack direction={{ xs: 'column', sm: 'row' }} spacing={1}>
                  <TextField
                    fullWidth
                    size="small"
                    placeholder="https://amazon.in/product... or https://flipkart.com/..."
                    value={trackUrl}
                    onChange={(e) => setTrackUrl(e.target.value)}
                    sx={{ '& .MuiOutlinedInput-root': { bgcolor: '#f8f9fb' } }}
                  />
                  <Button
                    variant="contained"
                    onClick={handleTrackProduct}
                    disabled={!trackUrl}
                    sx={{ minWidth: 110, fontWeight: 700 }}
                  >
                    Track
                  </Button>
                </Stack>
              </CardContent>
            </Card>

            {/* Trending Products */}
            <Card>
              <CardContent sx={{ p: 2.5 }}>
                <Stack direction="row" spacing={1} alignItems="center" mb={2}>
                  <LocalFireDepartment sx={{ color: '#ef4444' }} />
                  <Typography variant="h6" fontWeight={700}>Trending Now</Typography>
                </Stack>
                <Stack spacing={1}>
                  {trendingProducts.map((item) => (
                    <Paper
                      key={item.rank}
                      variant="outlined"
                      sx={{
                        p: 1.5,
                        cursor: 'pointer',
                        transition: 'all 0.15s ease',
                        '&:hover': { bgcolor: 'rgba(26,35,126,0.02)', borderColor: 'primary.light' },
                      }}
                    >
                      <Stack direction="row" spacing={1.5} alignItems="center">
                        <Avatar
                          sx={{
                            width: 32,
                            height: 32,
                            fontSize: '0.75rem',
                            fontWeight: 800,
                            bgcolor: item.rank <= 3 ? alpha('#1a237e', 0.08) : 'rgba(0,0,0,0.04)',
                            color: item.rank <= 3 ? '#1a237e' : 'text.secondary',
                          }}
                        >
                          {item.rank}
                        </Avatar>
                        <Box flex={1} minWidth={0}>
                          <Typography variant="body2" fontWeight={600} noWrap>
                            {item.product.product_name}
                          </Typography>
                          <Stack direction="row" spacing={1} alignItems="center">
                            <Typography variant="caption" color="primary" fontWeight={700}>
                              {formatINR(item.product.current_price)}
                            </Typography>
                            <Chip label={item.product.brand} size="small" sx={{ height: 20, fontSize: '0.625rem' }} />
                          </Stack>
                        </Box>
                        <Speed sx={{ color: 'text.disabled', fontSize: 18 }} />
                      </Stack>
                    </Paper>
                  ))}
                </Stack>
              </CardContent>
            </Card>
          </Stack>
        </Grid>

        {/* Right Column */}
        <Grid size={{ xs: 12, md: 5 }}>
          <Stack spacing={3}>
            {/* Watchlist */}
            <Card>
              <CardContent sx={{ p: 2.5 }}>
                <Stack direction="row" justifyContent="space-between" alignItems="center" mb={2}>
                  <Stack direction="row" spacing={1} alignItems="center">
                    <Inventory color="primary" sx={{ fontSize: 22 }} />
                    <Typography variant="h6" fontWeight={700}>My Watchlist</Typography>
                  </Stack>
                  <Chip label={`${watchlistProducts.length} items`} size="small" color="primary" variant="outlined" />
                </Stack>
                <Stack spacing={1} sx={{ maxHeight: 420, overflowY: 'auto', pr: 0.5 }}>
                  {watchlistProducts.slice(0, 8).map((product) => {
                    const priceChange =
                      ((product.current_price - product.original_price) / product.original_price) * 100;
                    const isPriceDown = priceChange < 0;

                    return (
                      <Paper
                        key={product.product_id}
                        variant="outlined"
                        sx={{
                          p: 1.5,
                          cursor: 'pointer',
                          transition: 'all 0.15s ease',
                          '&:hover': { bgcolor: 'rgba(26,35,126,0.02)', borderColor: 'primary.light' },
                        }}
                      >
                        <Typography variant="body2" fontWeight={600} noWrap sx={{ mb: 0.75 }}>
                          {product.product_name}
                        </Typography>
                        <Stack direction="row" justifyContent="space-between" alignItems="center">
                          <Typography variant="body2" color="primary" fontWeight={700}>
                            {formatINR(product.current_price)}
                          </Typography>
                          <Chip
                            icon={isPriceDown ? <TrendingDown sx={{ fontSize: '14px !important' }} /> : <TrendingUp sx={{ fontSize: '14px !important' }} />}
                            label={formatPercentage(priceChange)}
                            size="small"
                            color={isPriceDown ? 'success' : 'error'}
                            sx={{ fontWeight: 700, height: 24, '& .MuiChip-label': { px: 0.75 } }}
                          />
                        </Stack>
                      </Paper>
                    );
                  })}
                </Stack>
                <Button
                  component={Link}
                  to="/consumer/track"
                  fullWidth
                  variant="text"
                  sx={{ mt: 1.5, fontWeight: 600 }}
                >
                  View All Products
                </Button>
              </CardContent>
            </Card>

            {/* Recent Alerts */}
            <Card>
              <CardContent sx={{ p: 2.5 }}>
                <Stack direction="row" justifyContent="space-between" alignItems="center" mb={2}>
                  <Stack direction="row" spacing={1} alignItems="center">
                    <NotificationsActive color="warning" sx={{ fontSize: 22 }} />
                    <Typography variant="h6" fontWeight={700}>Recent Alerts</Typography>
                  </Stack>
                  <Chip label={`${recentAlerts.length} new`} size="small" color="warning" />
                </Stack>
                <Stack spacing={1}>
                  {recentAlerts.length > 0 ? (
                    recentAlerts.map((alert) => {
                      const isPriceDrop = alert.alert_type === 'price_drop';
                      const isFestival = alert.alert_type === 'festival';
                      const borderColor = isPriceDrop ? '#10b981' : isFestival ? '#f59e0b' : '#ef4444';

                      return (
                        <Paper
                          key={alert.alert_id}
                          variant="outlined"
                          sx={{
                            p: 1.5,
                            borderLeft: `3px solid ${borderColor}`,
                            transition: 'all 0.15s ease',
                            '&:hover': { bgcolor: 'rgba(0,0,0,0.01)' },
                          }}
                        >
                          <Stack direction="row" spacing={1.5} alignItems="flex-start">
                            <Avatar
                              sx={{
                                width: 28,
                                height: 28,
                                bgcolor: alpha(borderColor, 0.1),
                                mt: 0.25,
                              }}
                            >
                              {isPriceDrop ? (
                                <TrendingDown sx={{ color: borderColor, fontSize: 16 }} />
                              ) : isFestival ? (
                                <Celebration sx={{ color: borderColor, fontSize: 16 }} />
                              ) : (
                                <TrendingUp sx={{ color: borderColor, fontSize: 16 }} />
                              )}
                            </Avatar>
                            <Box flex={1} minWidth={0}>
                              <Typography variant="body2" fontWeight={600} noWrap>
                                {alert.product_name}
                              </Typography>
                              <Stack direction="row" spacing={0.75} alignItems="center" mt={0.25}>
                                <Typography variant="caption" color="text.secondary" sx={{ textDecoration: 'line-through' }}>
                                  {formatINR(alert.old_price)}
                                </Typography>
                                <Typography variant="caption" fontWeight={700} color={isPriceDrop ? 'success.main' : 'error.main'}>
                                  {formatINR(alert.new_price)}
                                </Typography>
                                <Chip
                                  label={formatPercentage(alert.percentage_change)}
                                  size="small"
                                  sx={{
                                    height: 18,
                                    fontSize: '0.625rem',
                                    fontWeight: 700,
                                    bgcolor: isPriceDrop ? '#ecfdf5' : '#fef2f2',
                                    color: isPriceDrop ? '#10b981' : '#ef4444',
                                  }}
                                />
                              </Stack>
                              <Typography variant="caption" color="text.disabled" sx={{ mt: 0.25, display: 'block' }}>
                                {formatRelativeTime(alert.timestamp)}
                              </Typography>
                            </Box>
                          </Stack>
                        </Paper>
                      );
                    })
                  ) : (
                    <Box textAlign="center" py={3}>
                      <NotificationsActive sx={{ fontSize: 40, color: 'text.disabled', mb: 1 }} />
                      <Typography variant="body2" color="text.secondary">
                        No new alerts yet
                      </Typography>
                    </Box>
                  )}
                </Stack>
                <Button
                  component={Link}
                  to="/consumer/alerts"
                  fullWidth
                  variant="text"
                  sx={{ mt: 1.5, fontWeight: 600 }}
                  endIcon={<ArrowForward sx={{ fontSize: '16px !important' }} />}
                >
                  View All Alerts
                </Button>
              </CardContent>
            </Card>
          </Stack>
        </Grid>
      </Grid>

      {/* Smart Recommendations */}
      <Box mt={4}>
        <Stack direction="row" spacing={1.5} alignItems="center" mb={2}>
          <PriceChange color="primary" />
          <Typography variant="h5" fontWeight={700}>Smart Recommendations</Typography>
          <Chip label="Based on your interests" size="small" variant="outlined" />
        </Stack>
        <Box
          sx={{
            display: 'flex',
            gap: 2,
            overflowX: 'auto',
            pb: 2,
            scrollSnapType: 'x mandatory',
            '&::-webkit-scrollbar': { height: 4 },
            '&::-webkit-scrollbar-thumb': { backgroundColor: 'rgba(0,0,0,.12)', borderRadius: 2 },
          }}
        >
          {recommendedProducts.map((product) => {
            const discount = product.original_price > product.current_price
              ? Math.round(((product.original_price - product.current_price) / product.original_price) * 100)
              : 0;

            return (
              <Card
                key={product.product_id}
                sx={{
                  minWidth: 260,
                  maxWidth: 260,
                  scrollSnapAlign: 'start',
                  flexShrink: 0,
                }}
              >
                <Box
                  sx={{
                    height: 180,
                    bgcolor: '#f8f9fb',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    position: 'relative',
                  }}
                >
                  <img
                    src={product.image_url}
                    alt={product.product_name}
                    style={{ maxWidth: '80%', maxHeight: '80%', objectFit: 'contain' }}
                  />
                  {discount > 0 && (
                    <Chip
                      label={`${discount}% OFF`}
                      size="small"
                      color="error"
                      sx={{
                        position: 'absolute',
                        top: 10,
                        right: 10,
                        fontWeight: 700,
                        fontSize: '0.625rem',
                      }}
                    />
                  )}
                </Box>
                <CardContent sx={{ p: 2, '&:last-child': { pb: 2 } }}>
                  <Typography variant="body2" noWrap fontWeight={600} gutterBottom>
                    {product.product_name}
                  </Typography>
                  <Stack direction="row" justifyContent="space-between" alignItems="center" mb={1.5}>
                    <Typography variant="h6" color="primary" fontWeight={800}>
                      {formatINR(product.current_price)}
                    </Typography>
                    {product.original_price > product.current_price && (
                      <Typography variant="caption" sx={{ textDecoration: 'line-through' }} color="text.secondary">
                        {formatINR(product.original_price)}
                      </Typography>
                    )}
                  </Stack>
                  <Stack direction="row" spacing={0.75} mb={1.5}>
                    <Chip label={product.brand} size="small" variant="outlined" sx={{ height: 22, fontSize: '0.625rem' }} />
                    <Chip
                      label={product.platform === 'amazon_india' ? 'Amazon' : 'Flipkart'}
                      size="small"
                      color="primary"
                      sx={{ height: 22, fontSize: '0.625rem' }}
                    />
                  </Stack>
                  <Button fullWidth variant="outlined" size="small" sx={{ fontWeight: 600 }}>
                    View Details
                  </Button>
                </CardContent>
              </Card>
            );
          })}
        </Box>
      </Box>
    </Container>
  );
};

export default ConsumerDashboard;
</file>

<file path="src/pages/FestivalDeals.tsx">
import React, { useMemo } from 'react';
import {
  Box,
  Container,
  Typography,
  Card,
  CardContent,
  Chip,
  Stack,
  Paper,
  Grid,
  LinearProgress,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Rating,
} from '@mui/material';
import {
  Celebration,
  TrendingDown,
  AccessTime,
  Category,
} from '@mui/icons-material';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  BarElement,
  Title,
  Tooltip,
  Legend,
} from 'chart.js';
import { Bar } from 'react-chartjs-2';
import { formatINR, calculateSavings } from '../utils/formatters';
import { sampleFestivals, watchlistProducts } from '../data/sampleData';
// Register Chart.js components
ChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);

const FestivalDeals: React.FC = () => {
  // Get next upcoming festival
  const nextFestival = useMemo(() => {
    return sampleFestivals.sort((a, b) => a.days_until - b.days_until)[0];
  }, []);

  // Calculate expected savings for watchlist products
  const expectedSavings = useMemo(() => {
    if (!nextFestival) return [];

    return watchlistProducts.slice(0, 8).map((product) => {
      const expectedDiscount = nextFestival.historical_discount_avg;
      const expectedPrice = product.current_price * (1 - expectedDiscount / 100);
      const savings = calculateSavings(product.current_price, expectedPrice);

      // Confidence rating (1-5 stars) based on category match and historical consistency
      const categoryMatch = nextFestival.affected_categories.some((cat) =>
        product.category.toLowerCase().includes(cat.toLowerCase())
      );
      const historicalVariance =
        Math.max(...nextFestival.historical_discounts.map((h) => h.discount)) -
        Math.min(...nextFestival.historical_discounts.map((h) => h.discount));

      let confidence = 3; // Default
      if (categoryMatch) confidence += 1;
      if (historicalVariance <= 5) confidence += 1;
      if (!categoryMatch) confidence -= 1;

      return {
        product,
        currentPrice: product.current_price,
        expectedPrice: Math.round(expectedPrice),
        savings: savings.amount,
        savingsPercentage: savings.percentage,
        confidence: Math.max(1, Math.min(5, confidence)),
      };
    });
  }, [nextFestival, watchlistProducts]);

  // Prepare bar chart data for historical trends
  const historicalTrendsChart = useMemo(() => {
    if (!nextFestival) return null;

    const labels = nextFestival.historical_discounts.map((h) => h.year.toString());
    const data = nextFestival.historical_discounts.map((h) => h.discount);

    return {
      labels,
      datasets: [
        {
          label: 'Average Discount (%)',
          data,
          backgroundColor: 'rgba(255, 152, 0, 0.7)',
          borderColor: 'rgba(255, 152, 0, 1)',
          borderWidth: 2,
        },
      ],
    };
  }, [nextFestival]);

  const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false,
      },
      title: {
        display: false,
      },
    },
    scales: {
      y: {
        beginAtZero: true,
        ticks: {
          callback: function (value: any) {
            return value + '%';
          },
        },
      },
    },
  };

  if (!nextFestival) {
    return (
      <Container maxWidth="xl" disableGutters>
        <Typography variant="h5" color="text.secondary">
          No upcoming festivals found
        </Typography>
      </Container>
    );
  }

  return (
    <Container maxWidth="xl" disableGutters>
      <Typography variant="h4" fontWeight={800} gutterBottom>
        Festival Deals Tracker
      </Typography>
      <Typography variant="body2" color="text.secondary" mb={3}>
        Track upcoming festivals and plan your purchases to maximize savings
      </Typography>

      {/* Featured Festival Card */}
      <Card
        sx={{
          mb: 3,
          background: (theme) =>
            `linear-gradient(135deg, ${theme.palette.primary.main} 0%, ${theme.palette.secondary.main} 100%)`,
          color: 'white',
        }}
      >
        <CardContent sx={{ p: 2.5 }}>
          <Stack spacing={3}>
            <Stack direction="row" spacing={2} alignItems="center">
              <Celebration sx={{ fontSize: 48 }} />
              <Box>
                <Typography variant="h4" fontWeight="bold">
                  {nextFestival.name}
                </Typography>
                <Chip
                  label={nextFestival.type.replace('_', ' ').toUpperCase()}
                  size="small"
                  sx={{ mt: 1, bgcolor: 'rgba(255,255,255,0.2)', color: 'white' }}
                />
              </Box>
            </Stack>

            <Grid container spacing={3}>
              <Grid size={{ xs: 12, sm: 4 }}>
                <Paper sx={{ p: 2, bgcolor: 'rgba(255,255,255,0.15)', color: 'white' }}>
                  <Stack direction="row" spacing={1} alignItems="center" mb={1}>
                    <AccessTime />
                    <Typography variant="subtitle2">Countdown</Typography>
                  </Stack>
                  <Typography variant="h3" fontWeight="bold">
                    {nextFestival.days_until}
                  </Typography>
                  <Typography variant="body2">days remaining</Typography>
                </Paper>
              </Grid>
              <Grid size={{ xs: 12, sm: 4 }}>
                <Paper sx={{ p: 2, bgcolor: 'rgba(255,255,255,0.15)', color: 'white' }}>
                  <Stack direction="row" spacing={1} alignItems="center" mb={1}>
                    <TrendingDown />
                    <Typography variant="subtitle2">Avg Discount</Typography>
                  </Stack>
                  <Typography variant="h3" fontWeight="bold">
                    {nextFestival.historical_discount_avg}%
                  </Typography>
                  <Typography variant="body2">based on history</Typography>
                </Paper>
              </Grid>
              <Grid size={{ xs: 12, sm: 4 }}>
                <Paper sx={{ p: 2, bgcolor: 'rgba(255,255,255,0.15)', color: 'white' }}>
                  <Stack direction="row" spacing={1} alignItems="center" mb={1}>
                    <Category />
                    <Typography variant="subtitle2">Affected Categories</Typography>
                  </Stack>
                  <Typography variant="h5" fontWeight="bold">
                    {nextFestival.affected_categories.length}+
                  </Typography>
                  <Typography variant="body2" noWrap>
                    {nextFestival.affected_categories.slice(0, 2).join(', ')}...
                  </Typography>
                </Paper>
              </Grid>
            </Grid>

            <Box>
              <Typography variant="subtitle2" mb={1}>
                Affected Categories:
              </Typography>
              <Stack direction="row" spacing={1} flexWrap="wrap" gap={1}>
                {nextFestival.affected_categories.map((category) => (
                  <Chip
                    key={category}
                    label={category}
                    size="small"
                    sx={{ bgcolor: 'rgba(255,255,255,0.2)', color: 'white' }}
                  />
                ))}
              </Stack>
            </Box>
          </Stack>
        </CardContent>
      </Card>

      {/* Expected Savings Table */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" gutterBottom>
            Expected Savings on Your Watchlist
          </Typography>
          <Typography variant="body2" color="text.secondary" mb={2}>
            Based on historical {nextFestival.name} discounts
          </Typography>
          <TableContainer>
            <Table>
              <TableHead>
                <TableRow>
                  <TableCell>Product</TableCell>
                  <TableCell align="right">Current Price</TableCell>
                  <TableCell align="right">Expected Price</TableCell>
                  <TableCell align="right">Potential Savings</TableCell>
                  <TableCell align="center">Confidence</TableCell>
                </TableRow>
              </TableHead>
              <TableBody>
                {expectedSavings.map((item) => (
                  <TableRow key={item.product.product_id} hover>
                    <TableCell>
                      <Typography variant="body2" fontWeight="medium" noWrap maxWidth={300}>
                        {item.product.product_name}
                      </Typography>
                      <Stack direction="row" spacing={1} mt={0.5}>
                        <Chip label={item.product.brand} size="small" />
                        <Chip label={item.product.category} size="small" variant="outlined" />
                      </Stack>
                    </TableCell>
                    <TableCell align="right">
                      <Typography variant="body2">{formatINR(item.currentPrice)}</Typography>
                    </TableCell>
                    <TableCell align="right">
                      <Typography variant="body2" color="success.main" fontWeight="bold">
                        {formatINR(item.expectedPrice)}
                      </Typography>
                    </TableCell>
                    <TableCell align="right">
                      <Stack alignItems="flex-end">
                        <Typography variant="body2" fontWeight="bold" color="success.main">
                          {formatINR(item.savings)}
                        </Typography>
                        <Chip
                          label={`${item.savingsPercentage.toFixed(1)}% OFF`}
                          size="small"
                          color="success"
                          sx={{ mt: 0.5 }}
                        />
                      </Stack>
                    </TableCell>
                    <TableCell align="center">
                      <Rating value={item.confidence} readOnly size="small" />
                    </TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          </TableContainer>
          <Paper variant="outlined" sx={{ p: 2, mt: 2, bgcolor: 'success.50' }}>
            <Stack direction="row" justifyContent="space-between" alignItems="center">
              <Typography variant="subtitle1" fontWeight="bold">
                Total Potential Savings:
              </Typography>
              <Typography variant="h5" color="success.main" fontWeight="bold">
                {formatINR(expectedSavings.reduce((sum, item) => sum + item.savings, 0))}
              </Typography>
            </Stack>
          </Paper>
        </CardContent>
      </Card>

      {/* Historical Trends */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" gutterBottom>
            Historical Discount Trends
          </Typography>
          <Typography variant="body2" color="text.secondary" mb={3}>
            Average discount percentages for {nextFestival.name} over the years
          </Typography>
          {historicalTrendsChart && (
            <Box sx={{ height: 300 }}>
              <Bar data={historicalTrendsChart} options={chartOptions} />
            </Box>
          )}
        </CardContent>
      </Card>

      {/* Upcoming Festivals List */}
      <Card>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" gutterBottom>
            All Upcoming Festivals
          </Typography>
          <Typography variant="body2" color="text.secondary" mb={2}>
            Plan your purchases around these major sale events
          </Typography>
          <Stack spacing={2}>
            {sampleFestivals
              .sort((a, b) => a.days_until - b.days_until)
              .map((festival) => (
                <Paper
                  key={festival.festival_id}
                  variant="outlined"
                  sx={{
                    p: 2,
                    '&:hover': { bgcolor: 'action.hover', cursor: 'pointer' },
                    borderLeft:
                      festival.festival_id === nextFestival.festival_id
                        ? '4px solid'
                        : undefined,
                    borderColor: 'primary.main',
                  }}
                >
                  <Grid container spacing={2} alignItems="center">
                    <Grid size={{ xs: 12, sm: 5 }}>
                      <Stack direction="row" spacing={1} alignItems="center" mb={1}>
                        <Celebration color="primary" />
                        <Typography variant="subtitle1" fontWeight="bold">
                          {festival.name}
                        </Typography>
                        {festival.festival_id === nextFestival.festival_id && (
                          <Chip label="NEXT" size="small" color="primary" />
                        )}
                      </Stack>
                      <Typography variant="body2" color="text.secondary">
                        {new Date(festival.date).toLocaleDateString('en-IN', {
                          year: 'numeric',
                          month: 'long',
                          day: 'numeric',
                        })}
                      </Typography>
                    </Grid>
                    <Grid size={{ xs: 6, sm: 2 }}>
                      <Typography variant="caption" color="text.secondary">
                        Days Until
                      </Typography>
                      <Typography variant="h6" fontWeight="bold" color="primary">
                        {festival.days_until}
                      </Typography>
                    </Grid>
                    <Grid size={{ xs: 6, sm: 2 }}>
                      <Typography variant="caption" color="text.secondary">
                        Avg Discount
                      </Typography>
                      <Stack direction="row" spacing={0.5} alignItems="center">
                        <TrendingDown color="success" fontSize="small" />
                        <Typography variant="h6" fontWeight="bold" color="success.main">
                          {festival.historical_discount_avg}%
                        </Typography>
                      </Stack>
                    </Grid>
                    <Grid size={{ xs: 12, sm: 3 }}>
                      <Typography variant="caption" color="text.secondary" display="block" mb={0.5}>
                        Categories
                      </Typography>
                      <Stack direction="row" spacing={0.5} flexWrap="wrap" gap={0.5}>
                        {festival.affected_categories.slice(0, 3).map((cat) => (
                          <Chip key={cat} label={cat} size="small" />
                        ))}
                        {festival.affected_categories.length > 3 && (
                          <Chip
                            label={`+${festival.affected_categories.length - 3}`}
                            size="small"
                            variant="outlined"
                          />
                        )}
                      </Stack>
                    </Grid>
                  </Grid>
                  {festival.days_until <= 30 && (
                    <Box mt={2}>
                      <Stack direction="row" spacing={1} alignItems="center" mb={0.5}>
                        <Typography variant="caption" color="text.secondary">
                          Time until festival
                        </Typography>
                      </Stack>
                      <LinearProgress
                        variant="determinate"
                        value={Math.max(0, 100 - (festival.days_until / 30) * 100)}
                        sx={{ height: 6, borderRadius: 3 }}
                      />
                    </Box>
                  )}
                </Paper>
              ))}
          </Stack>
        </CardContent>
      </Card>
    </Container>
  );
};

export default FestivalDeals;
</file>

<file path="src/pages/MSMEDashboard.tsx">
import { useState } from 'react';
import {
  Box,
  Container,
  Paper,
  Typography,
  Grid,
  Card,
  CardContent,
  TextField,
  Button,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  Chip,
  Alert,
  Stack,
  Avatar,
  alpha,
} from '@mui/material';
import {
  TrendingUp as TrendingUpIcon,
  TrendingDown as TrendingDownIcon,
  Warning as WarningIcon,
  Lightbulb as LightbulbIcon,
  Celebration as CelebrationIcon,
  Search as SearchIcon,
  Analytics as AnalyticsIcon,
  ArrowUpward as ArrowUpwardIcon,
  ArrowDownward as ArrowDownwardIcon,
  AutoGraph,
  Speed,
  EmojiEvents,
} from '@mui/icons-material';
import { formatINR } from '../utils/formatters';
import { msmeProducts, topPerformers, needsAttention } from '../data/sampleData';

export default function MSMEDashboard() {
  const [aiQuery, setAiQuery] = useState('');

  const sampleQuestions = [
    'Why is my smartphone category underperforming?',
    'What pricing strategy should I use for Diwali?',
    'How can I improve my market position?',
    'Which products should I focus on this month?',
  ];

  const handleAskAI = () => {
    if (aiQuery.trim()) {
      setAiQuery('');
    }
  };

  const kpis = [
    {
      label: 'Market Position',
      value: '65th',
      subtitle: 'Percentile',
      badge: 'Above Average',
      badgeColor: 'success' as const,
      icon: <AutoGraph />,
      color: '#3b82f6',
      trend: '+5 pts',
    },
    {
      label: 'Revenue (30 Days)',
      value: formatINR(1245000),
      subtitle: 'vs Previous Period',
      badge: '+15%',
      badgeColor: 'success' as const,
      icon: <TrendingUpIcon />,
      color: '#10b981',
      trend: 'Growing',
    },
    {
      label: '30-Day Trend',
      value: '+8%',
      subtitle: 'Rising Trend',
      badge: 'Positive',
      badgeColor: 'success' as const,
      icon: <Speed />,
      color: '#8b5cf6',
      trend: 'Accelerating',
    },
  ];

  return (
    <Container maxWidth="xl" disableGutters>
      {/* Header */}
      <Stack direction="row" justifyContent="space-between" alignItems="flex-start" mb={3}>
        <Box>
          <Typography variant="h4" fontWeight={800} sx={{ mb: 0.5 }}>
            MSME Analytics
          </Typography>
          <Typography variant="body2" color="text.secondary">
            AI-powered insights for your retail business
          </Typography>
        </Box>
        <Chip label="Pro" color="secondary" size="small" sx={{ fontWeight: 700, letterSpacing: '0.05em' }} />
      </Stack>

      {/* AI Analyst */}
      <Paper
        elevation={0}
        sx={{
          p: 3,
          mb: 3,
          borderRadius: 3,
          background: 'linear-gradient(135deg, #0d1642 0%, #1a237e 60%, #283593 100%)',
          color: '#fff',
          position: 'relative',
          overflow: 'hidden',
        }}
      >
        <Box sx={{ position: 'absolute', right: -30, bottom: -30, opacity: 0.05 }}>
          <AnalyticsIcon sx={{ fontSize: 250 }} />
        </Box>
        <Stack direction="row" spacing={1.5} alignItems="center" mb={2}>
          <Avatar sx={{ bgcolor: 'rgba(255,255,255,0.15)', width: 40, height: 40 }}>
            <AnalyticsIcon sx={{ fontSize: 22 }} />
          </Avatar>
          <Box>
            <Typography variant="h6" fontWeight={700}>Ask AI Analyst</Typography>
            <Typography variant="body2" sx={{ opacity: 0.7 }}>
              Get instant insights about performance, pricing & market position
            </Typography>
          </Box>
        </Stack>

        <Stack direction="row" spacing={1} mb={2} flexWrap="wrap" gap={0.5}>
          {sampleQuestions.map((q) => (
            <Chip
              key={q}
              label={q}
              size="small"
              onClick={() => setAiQuery(q)}
              sx={{
                bgcolor: 'rgba(255,255,255,0.1)',
                color: '#fff',
                border: '1px solid rgba(255,255,255,0.15)',
                '&:hover': { bgcolor: 'rgba(255,255,255,0.2)' },
                cursor: 'pointer',
                fontSize: '0.6875rem',
              }}
            />
          ))}
        </Stack>

        <Stack direction="row" spacing={1} position="relative">
          <TextField
            fullWidth
            placeholder="Ask me anything about your business..."
            value={aiQuery}
            onChange={(e) => setAiQuery(e.target.value)}
            onKeyDown={(e) => { if (e.key === 'Enter') handleAskAI(); }}
            size="small"
            sx={{
              '& .MuiOutlinedInput-root': {
                bgcolor: 'rgba(255,255,255,0.1)',
                borderRadius: '10px',
                color: '#fff',
                '& fieldset': { borderColor: 'rgba(255,255,255,0.15)' },
                '&:hover fieldset': { borderColor: 'rgba(255,255,255,0.3)' },
                '&.Mui-focused fieldset': { borderColor: 'rgba(255,255,255,0.5)' },
              },
              '& .MuiInputBase-input::placeholder': { color: 'rgba(255,255,255,0.5)' },
            }}
          />
          <Button
            variant="contained"
            startIcon={<SearchIcon />}
            onClick={handleAskAI}
            disabled={!aiQuery.trim()}
            sx={{
              bgcolor: 'rgba(255,255,255,0.2)',
              color: '#fff',
              '&:hover': { bgcolor: 'rgba(255,255,255,0.3)' },
              minWidth: 90,
              fontWeight: 700,
            }}
          >
            Ask
          </Button>
        </Stack>
      </Paper>

      {/* KPI Cards */}
      <Grid container spacing={2.5} sx={{ mb: 3 }} className="stagger-children">
        {kpis.map((kpi) => (
          <Grid key={kpi.label} size={{ xs: 12, md: 4 }}>
            <Card sx={{ height: '100%' }}>
              <CardContent sx={{ p: 2.5 }}>
                <Stack direction="row" justifyContent="space-between" alignItems="flex-start" mb={1.5}>
                  <Typography variant="subtitle2" color="text.secondary" sx={{ textTransform: 'uppercase', letterSpacing: '0.06em', fontSize: '0.6875rem' }}>
                    {kpi.label}
                  </Typography>
                  <Avatar sx={{ width: 36, height: 36, bgcolor: alpha(kpi.color, 0.08), color: kpi.color }}>
                    {kpi.icon}
                  </Avatar>
                </Stack>
                <Typography variant="h3" fontWeight={800} sx={{ color: kpi.color, mb: 0.5, fontSize: '2rem' }}>
                  {kpi.value}
                </Typography>
                <Stack direction="row" spacing={1} alignItems="center">
                  <Typography variant="body2" color="text.secondary">{kpi.subtitle}</Typography>
                  <Chip label={kpi.badge} color={kpi.badgeColor} size="small" sx={{ height: 22, fontWeight: 700, fontSize: '0.625rem' }} />
                </Stack>
              </CardContent>
            </Card>
          </Grid>
        ))}
      </Grid>

      {/* AI Insights */}
      <Paper elevation={0} sx={{ p: 2.5, mb: 3, border: '1px solid rgba(0,0,0,0.06)' }}>
        <Typography variant="h6" fontWeight={700} mb={2}>
          AI Insights & Recommendations
        </Typography>
        <Stack spacing={1.5}>
          <Alert
            severity="warning"
            icon={<WarningIcon />}
            sx={{ '& .MuiAlert-message': { width: '100%' } }}
          >
            <Stack direction={{ xs: 'column', sm: 'row' }} justifyContent="space-between" alignItems={{ xs: 'flex-start', sm: 'center' }} spacing={1}>
              <Box>
                <Typography variant="subtitle1" fontWeight={700} gutterBottom>
                  Pricing Alert: Products Overpriced
                </Typography>
                <Typography variant="body2">
                  2 products are priced 12% above market average, affecting sales velocity.
                </Typography>
              </Box>
              <Button variant="outlined" size="small" sx={{ flexShrink: 0 }}>Review</Button>
            </Stack>
          </Alert>

          <Alert
            severity="success"
            icon={<LightbulbIcon />}
            sx={{ '& .MuiAlert-message': { width: '100%' } }}
          >
            <Stack direction={{ xs: 'column', sm: 'row' }} justifyContent="space-between" alignItems={{ xs: 'flex-start', sm: 'center' }} spacing={1}>
              <Box>
                <Typography variant="subtitle1" fontWeight={700} gutterBottom>
                  Opportunity: Wireless Earbuds Category
                </Typography>
                <Typography variant="body2">
                  Demand up 45% in 30 days. Low competition (3 competitors). Potential margin: 35-40%.
                </Typography>
              </Box>
              <Button variant="contained" size="small" color="success" sx={{ flexShrink: 0 }}>Explore</Button>
            </Stack>
          </Alert>

          <Alert
            severity="info"
            icon={<CelebrationIcon />}
            sx={{ '& .MuiAlert-message': { width: '100%' } }}
          >
            <Stack direction={{ xs: 'column', sm: 'row' }} justifyContent="space-between" alignItems={{ xs: 'flex-start', sm: 'center' }} spacing={1}>
              <Box>
                <Typography variant="subtitle1" fontWeight={700} gutterBottom>
                  Festival Prep: Diwali Sale Strategy
                </Typography>
                <Typography variant="body2">
                  Diwali is 45 days away. Historical data shows 35% sales increase. Plan now.
                </Typography>
              </Box>
              <Button variant="outlined" size="small" color="info" sx={{ flexShrink: 0 }}>Plan Now</Button>
            </Stack>
          </Alert>
        </Stack>
      </Paper>

      {/* Product Portfolio */}
      <Paper elevation={0} sx={{ p: 2.5, mb: 3, border: '1px solid rgba(0,0,0,0.06)' }}>
        <Typography variant="h6" fontWeight={700} mb={2}>
          Product Portfolio
        </Typography>
        <TableContainer>
          <Table>
            <TableHead>
              <TableRow>
                <TableCell>Product</TableCell>
                <TableCell align="right">Your Price</TableCell>
                <TableCell align="right">Market Avg</TableCell>
                <TableCell>Position</TableCell>
                <TableCell>Status</TableCell>
                <TableCell align="right">Action</TableCell>
              </TableRow>
            </TableHead>
            <TableBody>
              {msmeProducts.map((product) => {
                const isAbove = product.yourPrice > product.marketAvg;

                return (
                  <TableRow key={product.id} sx={{ '&:hover': { bgcolor: 'rgba(0,0,0,0.01)' } }}>
                    <TableCell>
                      <Typography variant="body2" fontWeight={600}>{product.name}</Typography>
                    </TableCell>
                    <TableCell align="right">
                      <Typography fontWeight={700}>{formatINR(product.yourPrice)}</Typography>
                    </TableCell>
                    <TableCell align="right">
                      <Typography color="text.secondary">{formatINR(product.marketAvg)}</Typography>
                    </TableCell>
                    <TableCell>
                      <Stack direction="row" spacing={0.5} alignItems="center">
                        {isAbove ? (
                          <ArrowUpwardIcon sx={{ fontSize: 14, color: '#f59e0b' }} />
                        ) : (
                          <ArrowDownwardIcon sx={{ fontSize: 14, color: '#10b981' }} />
                        )}
                        <Typography variant="body2" fontWeight={500}>{product.position}</Typography>
                      </Stack>
                    </TableCell>
                    <TableCell>
                      <Chip
                        label={product.status === 'success' ? 'Competitive' : 'Review'}
                        color={product.status === 'success' ? 'success' : 'warning'}
                        size="small"
                        sx={{ fontWeight: 700 }}
                      />
                    </TableCell>
                    <TableCell align="right">
                      <Button variant="outlined" size="small" sx={{ fontWeight: 600 }}>Optimize</Button>
                    </TableCell>
                  </TableRow>
                );
              })}
            </TableBody>
          </Table>
        </TableContainer>
      </Paper>

      {/* Top Performers & Needs Attention */}
      <Grid container spacing={2.5}>
        <Grid size={{ xs: 12, md: 6 }}>
          <Paper elevation={0} sx={{ p: 2.5, border: '1px solid rgba(0,0,0,0.06)', height: '100%' }}>
            <Stack direction="row" spacing={1} alignItems="center" mb={2}>
              <EmojiEvents sx={{ color: '#f59e0b' }} />
              <Typography variant="h6" fontWeight={700}>Top Performers</Typography>
            </Stack>
            <Stack spacing={1.5}>
              {topPerformers.map((product, index) => (
                <Card
                  key={product.name}
                  variant="outlined"
                  sx={{
                    bgcolor: index === 0 ? alpha('#f59e0b', 0.04) : 'transparent',
                    borderColor: index === 0 ? alpha('#f59e0b', 0.3) : 'rgba(0,0,0,0.08)',
                  }}
                >
                  <CardContent sx={{ p: 2, '&:last-child': { pb: 2 } }}>
                    <Stack direction="row" justifyContent="space-between" alignItems="center">
                      <Box>
                        <Typography variant="body2" fontWeight={700}>{product.name}</Typography>
                        <Typography variant="caption" color="text.secondary">
                          {product.sales} units sold this month
                        </Typography>
                      </Box>
                      <Stack alignItems="flex-end" spacing={0.5}>
                        <Chip label={`${product.margin} margin`} color="success" size="small" sx={{ height: 22, fontWeight: 700, fontSize: '0.625rem' }} />
                        <Stack direction="row" spacing={0.5} alignItems="center">
                          {product.trend === 'up' ? (
                            <TrendingUpIcon sx={{ fontSize: 14, color: '#10b981' }} />
                          ) : (
                            <TrendingDownIcon sx={{ fontSize: 14, color: '#64748b' }} />
                          )}
                          <Typography variant="caption" color="text.secondary">
                            {product.trend === 'up' ? 'Growing' : 'Stable'}
                          </Typography>
                        </Stack>
                      </Stack>
                    </Stack>
                  </CardContent>
                </Card>
              ))}
            </Stack>
          </Paper>
        </Grid>

        <Grid size={{ xs: 12, md: 6 }}>
          <Paper elevation={0} sx={{ p: 2.5, border: '1px solid rgba(0,0,0,0.06)', height: '100%' }}>
            <Stack direction="row" spacing={1} alignItems="center" mb={2}>
              <WarningIcon sx={{ color: '#f59e0b' }} />
              <Typography variant="h6" fontWeight={700}>Needs Attention</Typography>
            </Stack>
            <Stack spacing={1.5}>
              {needsAttention.map((product) => (
                <Card
                  key={product.name}
                  variant="outlined"
                  sx={{ bgcolor: alpha('#f59e0b', 0.03), borderColor: alpha('#f59e0b', 0.2) }}
                >
                  <CardContent sx={{ p: 2, '&:last-child': { pb: 2 } }}>
                    <Typography variant="body2" fontWeight={700} mb={1}>{product.name}</Typography>
                    <Stack direction="row" justifyContent="space-between" alignItems="center" flexWrap="wrap" gap={1}>
                      <Box>
                        <Typography variant="caption" color="text.secondary" display="block">
                          Issue: {product.issue}
                        </Typography>
                        <Typography variant="caption" color="error" fontWeight={700}>
                          Impact: {product.impact}
                        </Typography>
                      </Box>
                      <Button variant="contained" size="small" color="warning" sx={{ fontWeight: 700 }}>
                        Fix Now
                      </Button>
                    </Stack>
                  </CardContent>
                </Card>
              ))}
            </Stack>
          </Paper>
        </Grid>
      </Grid>
    </Container>
  );
}
</file>

<file path="src/pages/PriceHistory.tsx">
import React, { useState, useMemo } from 'react';
import {
  Box,
  Container,
  Typography,
  Card,
  CardContent,
  Button,
  Select,
  MenuItem,
  FormControl,
  InputLabel,
  Stack,
  Paper,
  Chip,
  Grid,
  TextField,
  Switch,
  FormControlLabel,
  Divider,
} from '@mui/material';
import {
  TrendingUp,
  TrendingDown,
  ShowChart,
  Celebration,
  NotificationsActive,
  EmojiEvents,
} from '@mui/icons-material';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
  Filler,
} from 'chart.js';
import { Line } from 'react-chartjs-2';
import { formatINR } from '../utils/formatters';
import { sampleProducts, samplePriceHistory, getNextFestival } from '../data/sampleData';

// Register Chart.js components
ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
  Filler
);

const PriceHistory: React.FC = () => {
  const [selectedProductId, setSelectedProductId] = useState(sampleProducts[0].product_id);
  const [enableAlerts, setEnableAlerts] = useState(true);
  const [targetPrice, setTargetPrice] = useState('');

  const selectedProduct = sampleProducts.find((p) => p.product_id === selectedProductId)!;
  const nextFestival = getNextFestival();

  // Get price history for selected product
  const priceHistory = useMemo(() => {
    const history = samplePriceHistory.filter((h) => h.product_id === selectedProductId);

    // Group by platform
    const amazonHistory = history.filter((h) => h.platform === 'amazon_india');
    const flipkartHistory = history.filter((h) => h.platform === 'flipkart');

    return {
      amazon: amazonHistory,
      flipkart: flipkartHistory,
      all: history,
    };
  }, [selectedProductId]);

  // Calculate statistics
  const statistics = useMemo(() => {
    const allPrices = priceHistory.all.map((h) => h.price);
    if (allPrices.length === 0) {
      return { lowest: 0, highest: 0, average: 0, trend: 'stable' as const };
    }

    const lowest = Math.min(...allPrices);
    const highest = Math.max(...allPrices);
    const average = allPrices.reduce((a, b) => a + b, 0) / allPrices.length;

    // Determine trend
    const recentPrices = allPrices.slice(-3);
    const olderPrices = allPrices.slice(0, 3);
    const recentAvg = recentPrices.reduce((a, b) => a + b, 0) / recentPrices.length;
    const olderAvg = olderPrices.reduce((a, b) => a + b, 0) / olderPrices.length;

    let trend: 'rising' | 'falling' | 'stable' = 'stable';
    if (recentAvg < olderAvg * 0.95) trend = 'falling';
    else if (recentAvg > olderAvg * 1.05) trend = 'rising';

    return { lowest, highest, average, trend };
  }, [priceHistory]);

  // Current prices on different platforms
  const currentPrices = useMemo(() => {
    const amazonPrice =
      priceHistory.amazon.length > 0
        ? priceHistory.amazon[priceHistory.amazon.length - 1].price
        : null;
    const flipkartPrice =
      priceHistory.flipkart.length > 0
        ? priceHistory.flipkart[priceHistory.flipkart.length - 1].price
        : null;

    const bestPrice =
      amazonPrice && flipkartPrice
        ? Math.min(amazonPrice, flipkartPrice)
        : amazonPrice || flipkartPrice || selectedProduct.current_price;

    return { amazon: amazonPrice, flipkart: flipkartPrice, best: bestPrice };
  }, [priceHistory, selectedProduct]);

  // Chart data
  const chartData = useMemo(() => {
    const labels = priceHistory.amazon.map((h) => {
      const date = new Date(h.timestamp);
      return `${date.getDate()}/${date.getMonth() + 1}`;
    });

    return {
      labels,
      datasets: [
        {
          label: 'Amazon India',
          data: priceHistory.amazon.map((h) => h.price),
          borderColor: '#FF9900',
          backgroundColor: 'rgba(255, 153, 0, 0.1)',
          fill: true,
          tension: 0.4,
          pointRadius: 4,
          pointHoverRadius: 6,
        },
        {
          label: 'Flipkart',
          data: priceHistory.flipkart.map((h) => h.price),
          borderColor: '#2874F0',
          backgroundColor: 'rgba(40, 116, 240, 0.1)',
          fill: true,
          tension: 0.4,
          pointRadius: 4,
          pointHoverRadius: 6,
        },
      ],
    };
  }, [priceHistory]);

  const chartOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        position: 'top' as const,
      },
      title: {
        display: false,
      },
      tooltip: {
        callbacks: {
          label: function (context: any) {
            return context.dataset.label + ': ' + formatINR(context.parsed.y);
          },
        },
      },
    },
    scales: {
      y: {
        ticks: {
          callback: function (value: any) {
            return '' + (value / 1000).toFixed(0) + 'k';
          },
        },
      },
    },
  };

  return (
    <Container maxWidth="xl" disableGutters>
      <Box mb={3}>
        <Typography variant="h4" fontWeight={800} gutterBottom>
          Price History & Comparison
        </Typography>
        <Typography variant="body2" color="text.secondary">
          Track and compare prices across platforms over time
        </Typography>
      </Box>

      {/* Product Selector */}
      <FormControl fullWidth sx={{ mb: 3 }}>
        <InputLabel>Select Product</InputLabel>
        <Select
          value={selectedProductId}
          label="Select Product"
          onChange={(e) => setSelectedProductId(e.target.value)}
        >
          {sampleProducts.slice(0, 12).map((product) => (
            <MenuItem key={product.product_id} value={product.product_id}>
              {product.product_name}
            </MenuItem>
          ))}
        </Select>
      </FormControl>

      {/* Product Info Card */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Stack direction={{ xs: 'column', sm: 'row' }} spacing={3} alignItems="center">
            <Box
              sx={{
                width: 120,
                height: 120,
                bgcolor: 'grey.100',
                borderRadius: 2,
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                overflow: 'hidden',
              }}
            >
              <img
                src={selectedProduct.image_url}
                alt={selectedProduct.product_name}
                style={{
                  maxWidth: '100%',
                  maxHeight: '100%',
                  objectFit: 'contain',
                }}
              />
            </Box>
            <Box flex={1}>
              <Typography variant="h6" gutterBottom>
                {selectedProduct.product_name}
              </Typography>
              <Stack direction="row" spacing={1} mb={1} flexWrap="wrap">
                <Chip label={selectedProduct.brand} size="small" />
                <Chip label={selectedProduct.category} size="small" variant="outlined" />
                <Chip
                  label={`${selectedProduct.rating}  (${selectedProduct.review_count} reviews)`}
                  size="small"
                  color="primary"
                />
              </Stack>
            </Box>
          </Stack>
        </CardContent>
      </Card>

      {/* Current Prices Comparison */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" gutterBottom>
            Current Prices
          </Typography>
          <Grid container spacing={2}>
            {currentPrices.amazon && (
              <Grid size={{ xs: 12, sm: 6 }}>
                <Paper
                  variant="outlined"
                  sx={{
                    p: 2,
                    borderLeft:
                      currentPrices.amazon === currentPrices.best
                        ? '4px solid'
                        : undefined,
                    borderLeftColor: currentPrices.amazon === currentPrices.best ? 'success.main' : undefined,
                  }}
                >
                  <Stack direction="row" justifyContent="space-between" alignItems="center">
                    <Box>
                      <Typography variant="body2" color="text.secondary">
                        Amazon India
                      </Typography>
                      <Typography variant="h5" color="primary" fontWeight="bold">
                        {formatINR(currentPrices.amazon)}
                      </Typography>
                    </Box>
                    {currentPrices.amazon === currentPrices.best && (
                      <Chip
                        label="BEST PRICE"
                        color="success"
                        size="small"
                        icon={<EmojiEvents />}
                      />
                    )}
                  </Stack>
                  <Button
                    variant="contained"
                    fullWidth
                    size="small"
                    sx={{ mt: 2, bgcolor: '#FF9900', '&:hover': { bgcolor: '#e68a00' } }}
                  >
                    Buy Now
                  </Button>
                </Paper>
              </Grid>
            )}
            {currentPrices.flipkart && (
              <Grid size={{ xs: 12, sm: 6 }}>
                <Paper
                  variant="outlined"
                  sx={{
                    p: 2,
                    borderLeft:
                      currentPrices.flipkart === currentPrices.best
                        ? '4px solid'
                        : undefined,
                    borderLeftColor: currentPrices.flipkart === currentPrices.best ? 'success.main' : undefined,
                  }}
                >
                  <Stack direction="row" justifyContent="space-between" alignItems="center">
                    <Box>
                      <Typography variant="body2" color="text.secondary">
                        Flipkart
                      </Typography>
                      <Typography variant="h5" color="primary" fontWeight="bold">
                        {formatINR(currentPrices.flipkart)}
                      </Typography>
                    </Box>
                    {currentPrices.flipkart === currentPrices.best && (
                      <Chip
                        label="BEST PRICE"
                        color="success"
                        size="small"
                        icon={<EmojiEvents />}
                      />
                    )}
                  </Stack>
                  <Button
                    variant="contained"
                    fullWidth
                    size="small"
                    sx={{ mt: 2, bgcolor: '#2874F0', '&:hover': { bgcolor: '#1c5db8' } }}
                  >
                    Buy Now
                  </Button>
                </Paper>
              </Grid>
            )}
          </Grid>
          {currentPrices.amazon && currentPrices.flipkart && (
            <Typography variant="body2" color="text.secondary" mt={2} textAlign="center">
              Price difference:{' '}
              {formatINR(Math.abs(currentPrices.amazon - currentPrices.flipkart))}
            </Typography>
          )}
        </CardContent>
      </Card>

      {/* 30-Day Price History Chart */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Stack direction="row" spacing={1} alignItems="center" mb={2}>
            <ShowChart color="primary" />
            <Typography variant="h6">30-Day Price History</Typography>
          </Stack>
          <Box sx={{ height: 400, mb: 3 }}>
            <Line data={chartData} options={chartOptions} />
          </Box>

          {/* Statistics */}
          <Grid container spacing={2}>
            <Grid size={{ xs: 6, sm: 3 }}>
              <Paper variant="outlined" sx={{ p: 2, textAlign: 'center' }}>
                <Typography variant="caption" color="text.secondary">
                  Lowest
                </Typography>
                <Typography variant="h6" color="success.main" fontWeight="bold">
                  {formatINR(statistics.lowest)}
                </Typography>
              </Paper>
            </Grid>
            <Grid size={{ xs: 6, sm: 3 }}>
              <Paper variant="outlined" sx={{ p: 2, textAlign: 'center' }}>
                <Typography variant="caption" color="text.secondary">
                  Highest
                </Typography>
                <Typography variant="h6" color="error.main" fontWeight="bold">
                  {formatINR(statistics.highest)}
                </Typography>
              </Paper>
            </Grid>
            <Grid size={{ xs: 6, sm: 3 }}>
              <Paper variant="outlined" sx={{ p: 2, textAlign: 'center' }}>
                <Typography variant="caption" color="text.secondary">
                  Average
                </Typography>
                <Typography variant="h6" fontWeight="bold">
                  {formatINR(Math.round(statistics.average))}
                </Typography>
              </Paper>
            </Grid>
            <Grid size={{ xs: 6, sm: 3 }}>
              <Paper variant="outlined" sx={{ p: 2, textAlign: 'center' }}>
                <Typography variant="caption" color="text.secondary">
                  Trend
                </Typography>
                <Stack direction="row" spacing={0.5} justifyContent="center" alignItems="center">
                  {statistics.trend === 'falling' ? (
                    <>
                      <TrendingDown sx={{ color: 'success.main' }} />
                      <Typography variant="h6" color="success.main" fontWeight="bold">
                        Falling
                      </Typography>
                    </>
                  ) : statistics.trend === 'rising' ? (
                    <>
                      <TrendingUp sx={{ color: 'error.main' }} />
                      <Typography variant="h6" color="error.main" fontWeight="bold">
                        Rising
                      </Typography>
                    </>
                  ) : (
                    <Typography variant="h6" fontWeight="bold">
                      Stable
                    </Typography>
                  )}
                </Stack>
              </Paper>
            </Grid>
          </Grid>
        </CardContent>
      </Card>

      {/* Festival Intelligence */}
      {nextFestival && (
        <Card sx={{ mb: 3 }}>
          <CardContent sx={{ p: 2.5 }}>
            <Stack direction="row" spacing={1} alignItems="center" mb={2}>
              <Celebration color="warning" />
              <Typography variant="h6">Festival Intelligence</Typography>
            </Stack>
            <Paper variant="outlined" sx={{ p: 2, bgcolor: 'warning.lighter' }}>
              <Typography variant="subtitle1" fontWeight="bold" gutterBottom>
                {nextFestival.name} - {nextFestival.days_until} days away
              </Typography>
              <Typography variant="body2" color="text.secondary" mb={2}>
                Historical average discount: {nextFestival.historical_discount_avg}%
              </Typography>
              <Stack spacing={1}>
                {nextFestival.historical_discounts.map((h) => (
                  <Stack key={h.year} direction="row" justifyContent="space-between">
                    <Typography variant="body2">{h.year}</Typography>
                    <Chip label={`${h.discount}% OFF`} size="small" color="warning" />
                  </Stack>
                ))}
              </Stack>
              <Divider sx={{ my: 2 }} />
              <Typography variant="body2" fontWeight="bold" color="primary">
                AI Recommendation: Wait for {nextFestival.name} to potentially save around{' '}
                {formatINR(
                  Math.round((currentPrices.best * nextFestival.historical_discount_avg) / 100)
                )}
              </Typography>
            </Paper>
          </CardContent>
        </Card>
      )}

      {/* Price Alerts Settings */}
      <Card>
        <CardContent sx={{ p: 2.5 }}>
          <Stack direction="row" spacing={1} alignItems="center" mb={2}>
            <NotificationsActive color="primary" />
            <Typography variant="h6">Price Alerts</Typography>
          </Stack>
          <FormControlLabel
            control={
              <Switch checked={enableAlerts} onChange={(e) => setEnableAlerts(e.target.checked)} />
            }
            label="Enable price alerts for this product"
          />
          {enableAlerts && (
            <Box mt={2}>
              <Typography variant="body2" color="text.secondary" mb={1}>
                Set a target price to get notified when the price drops below this amount
              </Typography>
              <Stack direction="row" spacing={2} alignItems="flex-start">
                <TextField
                  label="Target Price"
                  placeholder="Enter target price"
                  value={targetPrice}
                  onChange={(e) => setTargetPrice(e.target.value)}
                  type="number"
                  size="small"
                  sx={{ flex: 1 }}
                  InputProps={{
                    startAdornment: <Typography sx={{ mr: 1 }}></Typography>,
                  }}
                />
                <Button variant="contained" size="medium">
                  Set Alert
                </Button>
              </Stack>
              {targetPrice && Number(targetPrice) > 0 && (
                <Typography variant="caption" color="text.secondary" mt={1} display="block">
                  You'll be notified when the price drops to or below {formatINR(Number(targetPrice))}
                </Typography>
              )}
            </Box>
          )}
        </CardContent>
      </Card>
    </Container>
  );
};

export default PriceHistory;
</file>

<file path="src/pages/PricingStrategy.tsx">
import { useState } from 'react';
import {
  Box,
  Container,
  Card,
  CardContent,
  Typography,
  Grid,
  TextField,
  Button,
  MenuItem,
  Divider,
  Chip,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow,
  List,
  ListItem,
  ListItemIcon,
  ListItemText,
  Stack,
} from '@mui/material';
import {
  Star as StarIcon,
  CheckCircle as CheckCircleIcon,
  Cancel as CancelIcon,
  TrendingUp as TrendingUpIcon,
  Psychology as PsychologyIcon,
  Calculate as CalculateIcon,
} from '@mui/icons-material';
import { formatINR } from '../utils/formatters';
import { msmeProducts } from '../data/sampleData';

interface CostInputs {
  costBasis: number;
  minimumMargin: number;
  shipping: number;
  overhead: number;
}

interface Scenario {
  label: string;
  price: number;
  margin: number;
  position: string;
  demand: number;
  risk: string;
  pros: string[];
  cons: string[];
  recommended: boolean;
}

export default function PricingStrategy() {
  const [selectedProduct, setSelectedProduct] = useState('');
  const [costs, setCosts] = useState<CostInputs>({
    costBasis: 15000,
    minimumMargin: 15,
    shipping: 200,
    overhead: 300,
  });
  const [showAnalysis, setShowAnalysis] = useState(false);

  const totalCost = costs.costBasis + costs.shipping + costs.overhead;
  const floorPrice = totalCost * (1 + costs.minimumMargin / 100);

  const handleGenerateStrategy = () => {
    if (!selectedProduct) return;
    setShowAnalysis(true);
  };

  const recommendedPrice = 18999;
  const marketAvg = 19500;

  const scenarios: Scenario[] = [
    {
      label: 'Aggressive',
      price: 17499,
      margin: 14.2,
      position: 'Below Market (-10%)',
      demand: 5,
      risk: 'Medium',
      pros: ['High sales volume', 'Market penetration', 'Competitive edge'],
      cons: ['Lower margins', 'Price war risk', 'Brand perception'],
      recommended: false,
    },
    {
      label: 'Recommended',
      price: 18999,
      margin: 22.5,
      position: 'Competitive (-3%)',
      demand: 4,
      risk: 'Low',
      pros: ['Balanced margin & volume', 'Market aligned', 'Sustainable growth', 'Good ROI'],
      cons: ['Not the cheapest option'],
      recommended: true,
    },
    {
      label: 'Premium',
      price: 20999,
      margin: 35.8,
      position: 'Above Market (+8%)',
      demand: 2,
      risk: 'High',
      pros: ['High profit margins', 'Premium positioning', 'Value perception'],
      cons: ['Lower sales volume', 'Price sensitivity', 'Competition risk'],
      recommended: false,
    },
  ];

  const elasticityData = [
    { price: 16999, units: 85, revenue: 1444915, profit: 364915, roi: 33.8 },
    { price: 17999, units: 68, revenue: 1223932, profit: 383932, roi: 45.7 },
    { price: 18999, units: 52, revenue: 987948, profit: 347948, roi: 54.3 },
    { price: 19999, units: 38, revenue: 759962, profit: 279962, roi: 58.4 },
    { price: 20999, units: 25, revenue: 524975, profit: 184975, roi: 54.5 },
  ];

  const recommendations = [
    'Start with recommended price and monitor sales velocity for 2 weeks',
    'Set up automated price tracking for top 5 competitors',
    'Plan seasonal discounts (5-8%) during festival sales',
    'Bundle with accessories to increase perceived value',
    'Highlight unique features to justify pricing position',
  ];

  return (
    <Container maxWidth="xl" disableGutters>
      {/* Page Header */}
      <Box sx={{ mb: 3 }}>
        <Typography variant="h4" fontWeight={800} sx={{ mb: 1 }}>
          AI Pricing Strategy Tool
        </Typography>
        <Typography variant="body2" color="text.secondary">
          Data-driven pricing recommendations for optimal profitability
        </Typography>
      </Box>

      {/* Step 1: Product Selector */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" sx={{ fontWeight: 600, mb: 2 }}>
            Step 1: Select Product
          </Typography>
          <TextField
            select
            fullWidth
            label="Choose a product"
            value={selectedProduct}
            onChange={(e) => setSelectedProduct(e.target.value)}
          >
            {msmeProducts.map((product) => (
              <MenuItem key={product.id} value={product.name}>
                {product.name}
              </MenuItem>
            ))}
          </TextField>
        </CardContent>
      </Card>

      {/* Step 2: Cost Inputs */}
      <Card sx={{ mb: 3 }}>
        <CardContent sx={{ p: 2.5 }}>
          <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
            Step 2: Cost Structure
          </Typography>

          <Grid container spacing={3}>
            <Grid size={{ xs: 12, md: 6 }}>
              <TextField
                fullWidth
                label="Cost Basis (Product Cost)"
                type="number"
                value={costs.costBasis}
                onChange={(e) => setCosts({ ...costs, costBasis: parseFloat(e.target.value) || 0 })}
                InputProps={{
                  startAdornment: <Typography sx={{ mr: 1 }}></Typography>,
                }}
              />
            </Grid>
            <Grid size={{ xs: 12, md: 6 }}>
              <TextField
                fullWidth
                label="Minimum Margin"
                type="number"
                value={costs.minimumMargin}
                onChange={(e) => setCosts({ ...costs, minimumMargin: parseFloat(e.target.value) || 0 })}
                InputProps={{
                  endAdornment: <Typography sx={{ ml: 1 }}>%</Typography>,
                }}
              />
            </Grid>
            <Grid size={{ xs: 12, md: 6 }}>
              <TextField
                fullWidth
                label="Shipping Cost"
                type="number"
                value={costs.shipping}
                onChange={(e) => setCosts({ ...costs, shipping: parseFloat(e.target.value) || 0 })}
                InputProps={{
                  startAdornment: <Typography sx={{ mr: 1 }}></Typography>,
                }}
              />
            </Grid>
            <Grid size={{ xs: 12, md: 6 }}>
              <TextField
                fullWidth
                label="Overhead Cost"
                type="number"
                value={costs.overhead}
                onChange={(e) => setCosts({ ...costs, overhead: parseFloat(e.target.value) || 0 })}
                InputProps={{
                  startAdornment: <Typography sx={{ mr: 1 }}></Typography>,
                }}
              />
            </Grid>
          </Grid>

          <Divider sx={{ my: 3 }} />

          <Grid container spacing={2}>
            <Grid size={{ xs: 12, md: 6 }}>
              <Card variant="outlined">
                <CardContent>
                  <Typography variant="subtitle2" color="text.secondary" gutterBottom>
                    Total Cost
                  </Typography>
                  <Typography variant="h5" sx={{ fontWeight: 700 }}>
                    {formatINR(totalCost)}
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
            <Grid size={{ xs: 12, md: 6 }}>
              <Card variant="outlined">
                <CardContent>
                  <Typography variant="subtitle2" color="text.secondary" gutterBottom>
                    Floor Price (Min {costs.minimumMargin}% margin)
                  </Typography>
                  <Typography variant="h5" sx={{ fontWeight: 700, color: 'warning.main' }}>
                    {formatINR(floorPrice)}
                  </Typography>
                </CardContent>
              </Card>
            </Grid>
          </Grid>
        </CardContent>
      </Card>

      {/* Generate Button */}
      <Box sx={{ textAlign: 'center', mb: 3 }}>
        <Button
          variant="contained"
          size="large"
          startIcon={<PsychologyIcon />}
          onClick={handleGenerateStrategy}
          disabled={!selectedProduct}
          sx={{ minWidth: 300, py: 1.5 }}
        >
          Generate AI Pricing Strategy
        </Button>
      </Box>

      {/* Analysis Results */}
      {showAnalysis && (
        <>
          {/* AI-Powered Pricing Analysis */}
          <Card sx={{ mb: 3, bgcolor: 'info.lighter' }}>
            <CardContent sx={{ p: 2.5 }}>
              <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>
                <CalculateIcon sx={{ fontSize: 32, color: 'primary.main', mr: 1 }} />
                <Typography variant="h6" sx={{ fontWeight: 600 }}>
                  AI-Powered Pricing Analysis
                </Typography>
              </Box>

              <Grid container spacing={3}>
                <Grid size={{ xs: 12, md: 4 }}>
                  <Box sx={{ textAlign: 'center' }}>
                    <Box sx={{ display: 'flex', alignItems: 'center', justifyContent: 'center', mb: 1 }}>
                      <StarIcon sx={{ fontSize: 32, color: 'warning.main', mr: 1 }} />
                      <Typography variant="h4" sx={{ fontWeight: 700, color: 'primary.main' }}>
                        {formatINR(recommendedPrice)}
                      </Typography>
                    </Box>
                    <Typography variant="subtitle1" sx={{ fontWeight: 600 }}>
                      Recommended Price
                    </Typography>
                  </Box>
                </Grid>
                <Grid size={{ xs: 12, md: 8 }}>
                  <Typography variant="subtitle2" sx={{ fontWeight: 600, mb: 1 }}>
                    Rationale
                  </Typography>
                  <Typography variant="body2" sx={{ mb: 2 }}>
                    Based on competitive analysis of 23 retailers in Mumbai market, this price positions you 3% below
                    market average while maintaining healthy 22.5% margin. Expected sales velocity: 52 units/month with
                    54.3% ROI.
                  </Typography>
                  <Box sx={{ display: 'flex', gap: 2, flexWrap: 'wrap' }}>
                    <Chip label={`Market Avg: ${formatINR(marketAvg)}`} size="small" />
                    <Chip label="22.5% Margin" color="success" size="small" />
                    <Chip label="54.3% ROI" color="success" size="small" />
                    <Chip label="3% Below Market" color="info" size="small" />
                  </Box>
                </Grid>
              </Grid>
            </CardContent>
          </Card>

          {/* Scenario Analysis */}
          <Card sx={{ mb: 3 }}>
            <CardContent sx={{ p: 2.5 }}>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
                Scenario Analysis
              </Typography>

              <Grid container spacing={3}>
                {scenarios.map((scenario) => (
                  <Grid size={{ xs: 12, md: 4 }} key={scenario.label}>
                    <Card
                      variant="outlined"
                      sx={{
                        height: '100%',
                        border: scenario.recommended ? 2 : 1,
                        borderColor: scenario.recommended ? 'success.main' : 'divider',
                        bgcolor: scenario.recommended ? 'success.lighter' : 'transparent',
                        position: 'relative',
                      }}
                    >
                      {scenario.recommended && (
                        <Chip
                          label="RECOMMENDED"
                          color="success"
                          size="small"
                          sx={{
                            position: 'absolute',
                            top: 8,
                            right: 8,
                            fontWeight: 700,
                          }}
                        />
                      )}
                      <CardContent>
                        <Typography variant="h6" sx={{ fontWeight: 600, mb: 2 }}>
                          {scenario.label}
                        </Typography>

                        <Box sx={{ mb: 2 }}>
                          <Typography variant="h4" sx={{ fontWeight: 700, color: 'info.main', mb: 0.5 }}>
                            {formatINR(scenario.price)}
                          </Typography>
                          <Typography variant="body2" color="text.secondary">
                            {scenario.margin}% Margin
                          </Typography>
                        </Box>

                        <Stack spacing={1} sx={{ mb: 2 }}>
                          <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                            <Typography variant="body2" color="text.secondary">
                              Position:
                            </Typography>
                            <Typography variant="body2" sx={{ fontWeight: 600 }}>
                              {scenario.position}
                            </Typography>
                          </Box>
                          <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                            <Typography variant="body2" color="text.secondary">
                              Demand:
                            </Typography>
                            <Box>
                              {[...Array(5)].map((_, i) => (
                                <StarIcon
                                  key={i}
                                  sx={{
                                    fontSize: 16,
                                    color: i < scenario.demand ? 'warning.main' : 'action.disabled',
                                  }}
                                />
                              ))}
                            </Box>
                          </Box>
                          <Box sx={{ display: 'flex', justifyContent: 'space-between' }}>
                            <Typography variant="body2" color="text.secondary">
                              Risk:
                            </Typography>
                            <Chip
                              label={scenario.risk}
                              size="small"
                              color={
                                scenario.risk === 'Low' ? 'success' : scenario.risk === 'Medium' ? 'warning' : 'error'
                              }
                            />
                          </Box>
                        </Stack>

                        <Divider sx={{ my: 2 }} />

                        <Typography variant="subtitle2" sx={{ fontWeight: 600, mb: 1 }}>
                          Pros:
                        </Typography>
                        {scenario.pros.map((pro, idx) => (
                          <Box key={idx} sx={{ display: 'flex', alignItems: 'flex-start', mb: 0.5 }}>
                            <CheckCircleIcon sx={{ fontSize: 16, color: 'success.main', mr: 0.5, mt: 0.25 }} />
                            <Typography variant="body2">{pro}</Typography>
                          </Box>
                        ))}

                        <Typography variant="subtitle2" sx={{ fontWeight: 600, mb: 1, mt: 2 }}>
                          Cons:
                        </Typography>
                        {scenario.cons.map((con, idx) => (
                          <Box key={idx} sx={{ display: 'flex', alignItems: 'flex-start', mb: 0.5 }}>
                            <CancelIcon sx={{ fontSize: 16, color: 'error.main', mr: 0.5, mt: 0.25 }} />
                            <Typography variant="body2">{con}</Typography>
                          </Box>
                        ))}
                      </CardContent>
                    </Card>
                  </Grid>
                ))}
              </Grid>
            </CardContent>
          </Card>

          {/* Price Elasticity Analysis */}
          <Card sx={{ mb: 3 }}>
            <CardContent sx={{ p: 2.5 }}>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
                Price Elasticity Analysis
              </Typography>

              <TableContainer>
                <Table>
                  <TableHead>
                    <TableRow sx={{ bgcolor: 'action.hover' }}>
                      <TableCell sx={{ fontWeight: 600 }}>Price Point</TableCell>
                      <TableCell sx={{ fontWeight: 600 }} align="right">
                        Est. Units/Month
                      </TableCell>
                      <TableCell sx={{ fontWeight: 600 }} align="right">
                        Revenue
                      </TableCell>
                      <TableCell sx={{ fontWeight: 600 }} align="right">
                        Profit
                      </TableCell>
                      <TableCell sx={{ fontWeight: 600 }} align="right">
                        ROI
                      </TableCell>
                    </TableRow>
                  </TableHead>
                  <TableBody>
                    {elasticityData.map((row) => (
                      <TableRow
                        key={row.price}
                        sx={{
                          bgcolor: row.price === recommendedPrice ? 'success.lighter' : 'transparent',
                          '&:hover': { bgcolor: row.price === recommendedPrice ? 'success.lighter' : 'action.hover' },
                        }}
                      >
                        <TableCell>
                          <Typography sx={{ fontWeight: row.price === recommendedPrice ? 600 : 400 }}>
                            {formatINR(row.price)}
                          </Typography>
                        </TableCell>
                        <TableCell align="right">{row.units}</TableCell>
                        <TableCell align="right">{formatINR(row.revenue)}</TableCell>
                        <TableCell align="right">
                          <Typography sx={{ color: 'success.main', fontWeight: 600 }}>
                            {formatINR(row.profit)}
                          </Typography>
                        </TableCell>
                        <TableCell align="right">
                          <Chip label={`${row.roi}%`} size="small" color="success" />
                        </TableCell>
                      </TableRow>
                    ))}
                  </TableBody>
                </Table>
              </TableContainer>
            </CardContent>
          </Card>

          {/* Additional Recommendations */}
          <Card sx={{ mb: 3 }}>
            <CardContent sx={{ p: 2.5 }}>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 2 }}>
                Additional Recommendations
              </Typography>

              <List>
                {recommendations.map((rec, idx) => (
                  <ListItem key={idx} sx={{ px: 0 }}>
                    <ListItemIcon sx={{ minWidth: 40 }}>
                      <TrendingUpIcon sx={{ color: 'info.main' }} />
                    </ListItemIcon>
                    <ListItemText primary={rec} />
                  </ListItem>
                ))}
              </List>
            </CardContent>
          </Card>

          {/* Action Buttons */}
          <Card>
            <CardContent sx={{ p: 2.5 }}>
              <Grid container spacing={2}>
                <Grid size={{ xs: 12, md: 4 }}>
                  <Button variant="contained" fullWidth size="large" color="success">
                    Apply Recommended Price
                  </Button>
                </Grid>
                <Grid size={{ xs: 12, md: 4 }}>
                  <Button variant="outlined" fullWidth size="large">
                    Save Strategy
                  </Button>
                </Grid>
                <Grid size={{ xs: 12, md: 4 }}>
                  <Button variant="outlined" fullWidth size="large">
                    Export Report
                  </Button>
                </Grid>
              </Grid>
            </CardContent>
          </Card>
        </>
      )}
    </Container>
  );
}
</file>

<file path="src/pages/ProductTracking.tsx">
import React, { useState } from 'react';
import { Link } from 'react-router-dom';
import {
  Box,
  Container,
  Typography,
  Card,
  CardContent,
  Button,
  TextField,
  Chip,
  Stack,
  Paper,
  Checkbox,
  FormControlLabel,
  FormGroup,
  Alert,
  Divider,
  InputAdornment,
} from '@mui/material';
import {
  Link as LinkIcon,
  CheckCircle,
  TrendingDown,
  TrendingUp,
  Celebration,
  Inventory,
} from '@mui/icons-material';
import { formatINR } from '../utils/formatters';
import { sampleProducts } from '../data/sampleData';

const ProductTracking: React.FC = () => {
  const [step, setStep] = useState<1 | 2 | 3 | 4>(1);
  const [productUrl, setProductUrl] = useState('');
  const [detectedPlatform, setDetectedPlatform] = useState<'amazon_india' | 'flipkart' | null>(
    null
  );
  const [selectedProduct] = useState(sampleProducts[0]);
  const [alertSettings, setAlertSettings] = useState({
    priceDrop: true,
    priceIncrease: false,
    festivalDeals: true,
  });
  const [targetPrice, setTargetPrice] = useState('');
  const [trackingSuccess, setTrackingSuccess] = useState(false);

  const handleUrlChange = (url: string) => {
    setProductUrl(url);
    if (url.includes('amazon.in') || url.includes('amazon.com')) {
      setDetectedPlatform('amazon_india');
    } else if (url.includes('flipkart.com')) {
      setDetectedPlatform('flipkart');
    } else {
      setDetectedPlatform(null);
    }
  };

  const handleFetchProduct = () => {
    if (productUrl && detectedPlatform) {
      // Simulate fetching product details
      setTimeout(() => {
        setStep(2);
      }, 500);
    }
  };

  const handleContinueToSettings = () => {
    setStep(3);
  };

  const handleStartTracking = () => {
    setTrackingSuccess(true);
    setStep(4);
  };

  const handleTrackAnother = () => {
    setStep(1);
    setProductUrl('');
    setDetectedPlatform(null);
    setTargetPrice('');
    setTrackingSuccess(false);
    setAlertSettings({
      priceDrop: true,
      priceIncrease: false,
      festivalDeals: true,
    });
  };

  return (
    <Container maxWidth="md" disableGutters>
      <Typography variant="h4" fontWeight={800} gutterBottom>
        Track Product Price
      </Typography>
      <Typography variant="body2" color="text.secondary" mb={3}>
        Enter a product URL from Amazon or Flipkart to start tracking price changes
      </Typography>

      {/* Step Indicators */}
      <Stack direction="row" spacing={2} mb={3} justifyContent="center">
        {[1, 2, 3].map((s) => (
          <Stack key={s} direction="row" alignItems="center" spacing={1}>
            <Chip
              label={s}
              color={step >= s ? 'primary' : 'default'}
              size="small"
              sx={{
                width: 32,
                height: 32,
                borderRadius: '50%',
                fontWeight: 'bold',
              }}
            />
            {s < 3 && (
              <Box
                sx={{
                  width: 40,
                  height: 2,
                  bgcolor: step > s ? 'primary.main' : 'grey.300',
                }}
              />
            )}
          </Stack>
        ))}
      </Stack>

      {/* Step 1: URL Input */}
      {step >= 1 && (
        <Card sx={{ mb: 3 }}>
          <CardContent sx={{ p: 2.5 }}>
            <Stack direction="row" spacing={1} alignItems="center" mb={2}>
              <Chip label="Step 1" color="primary" size="small" />
              <Typography variant="h6">Enter Product URL</Typography>
            </Stack>
            <TextField
              fullWidth
              label="Product URL"
              placeholder="https://amazon.in/product-name or https://flipkart.com/product-name"
              value={productUrl}
              onChange={(e) => handleUrlChange(e.target.value)}
              disabled={step > 1}
              InputProps={{
                startAdornment: (
                  <InputAdornment position="start">
                    <LinkIcon />
                  </InputAdornment>
                ),
              }}
              sx={{ mb: 2 }}
            />
            {detectedPlatform && (
              <Stack direction="row" spacing={1} mb={2}>
                <Chip
                  label={detectedPlatform === 'amazon_india' ? 'Amazon India' : 'Flipkart'}
                  color="primary"
                  size="small"
                />
                <Typography variant="caption" color="text.secondary" alignSelf="center">
                  Platform detected
                </Typography>
              </Stack>
            )}
            {step === 1 && (
              <Button
                variant="contained"
                fullWidth
                size="large"
                onClick={handleFetchProduct}
                disabled={!productUrl || !detectedPlatform}
              >
                Fetch Product Details
              </Button>
            )}
          </CardContent>
        </Card>
      )}

      {/* Step 2: Product Details */}
      {step >= 2 && (
        <Card sx={{ mb: 3 }}>
          <CardContent sx={{ p: 2.5 }}>
            <Stack direction="row" spacing={1} alignItems="center" mb={2}>
              <Chip label="Step 2" color="primary" size="small" />
              <Typography variant="h6">Product Details</Typography>
            </Stack>
            <Paper variant="outlined" sx={{ p: 2 }}>
              <Stack direction={{ xs: 'column', sm: 'row' }} spacing={3}>
                <Box
                  sx={{
                    width: { xs: '100%', sm: 150 },
                    height: 150,
                    bgcolor: 'grey.100',
                    borderRadius: 1,
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    overflow: 'hidden',
                  }}
                >
                  <img
                    src={selectedProduct.image_url}
                    alt={selectedProduct.product_name}
                    style={{
                      maxWidth: '100%',
                      maxHeight: '100%',
                      objectFit: 'contain',
                    }}
                  />
                </Box>
                <Box flex={1}>
                  <Typography variant="h6" gutterBottom>
                    {selectedProduct.product_name}
                  </Typography>
                  <Stack spacing={1}>
                    <Stack direction="row" spacing={1} flexWrap="wrap">
                      <Chip label={selectedProduct.brand} size="small" />
                      <Chip label={selectedProduct.category} size="small" variant="outlined" />
                      <Chip
                        label={
                          selectedProduct.platform === 'amazon_india'
                            ? 'Amazon India'
                            : 'Flipkart'
                        }
                        size="small"
                        color="primary"
                      />
                    </Stack>
                    <Typography variant="h5" color="primary" fontWeight="bold">
                      {formatINR(selectedProduct.current_price)}
                    </Typography>
                    {selectedProduct.original_price > selectedProduct.current_price && (
                      <Stack direction="row" spacing={1} alignItems="center">
                        <Typography
                          variant="body2"
                          sx={{ textDecoration: 'line-through' }}
                          color="text.secondary"
                        >
                          {formatINR(selectedProduct.original_price)}
                        </Typography>
                        <Chip
                          label={`${Math.round(
                            ((selectedProduct.original_price - selectedProduct.current_price) /
                              selectedProduct.original_price) *
                              100
                          )}% OFF`}
                          size="small"
                          color="success"
                        />
                      </Stack>
                    )}
                    <Chip
                      label={
                        selectedProduct.availability === 'in_stock' ? 'In Stock' : 'Out of Stock'
                      }
                      size="small"
                      color={selectedProduct.availability === 'in_stock' ? 'success' : 'error'}
                      sx={{ alignSelf: 'flex-start' }}
                    />
                  </Stack>
                </Box>
              </Stack>
            </Paper>
            {step === 2 && (
              <Button
                variant="contained"
                fullWidth
                size="large"
                onClick={handleContinueToSettings}
                sx={{ mt: 2 }}
              >
                Continue to Alert Settings
              </Button>
            )}
          </CardContent>
        </Card>
      )}

      {/* Step 3: Alert Settings */}
      {step >= 3 && (
        <Card sx={{ mb: 3 }}>
          <CardContent sx={{ p: 2.5 }}>
            <Stack direction="row" spacing={1} alignItems="center" mb={2}>
              <Chip label="Step 3" color="primary" size="small" />
              <Typography variant="h6">Alert Settings</Typography>
            </Stack>
            <Typography variant="body2" color="text.secondary" mb={2}>
              Choose when you want to be notified about this product
            </Typography>
            <FormGroup sx={{ mb: 3 }}>
              <FormControlLabel
                control={
                  <Checkbox
                    checked={alertSettings.priceDrop}
                    onChange={(e) =>
                      setAlertSettings({ ...alertSettings, priceDrop: e.target.checked })
                    }
                    disabled={step > 3}
                  />
                }
                label={
                  <Stack direction="row" spacing={1} alignItems="center">
                    <TrendingDown color="success" fontSize="small" />
                    <Typography variant="body2">Price Drop Alerts</Typography>
                  </Stack>
                }
              />
              <FormControlLabel
                control={
                  <Checkbox
                    checked={alertSettings.priceIncrease}
                    onChange={(e) =>
                      setAlertSettings({ ...alertSettings, priceIncrease: e.target.checked })
                    }
                    disabled={step > 3}
                  />
                }
                label={
                  <Stack direction="row" spacing={1} alignItems="center">
                    <TrendingUp color="error" fontSize="small" />
                    <Typography variant="body2">Price Increase Alerts</Typography>
                  </Stack>
                }
              />
              <FormControlLabel
                control={
                  <Checkbox
                    checked={alertSettings.festivalDeals}
                    onChange={(e) =>
                      setAlertSettings({ ...alertSettings, festivalDeals: e.target.checked })
                    }
                    disabled={step > 3}
                  />
                }
                label={
                  <Stack direction="row" spacing={1} alignItems="center">
                    <Celebration color="warning" fontSize="small" />
                    <Typography variant="body2">Festival Deal Alerts</Typography>
                  </Stack>
                }
              />
            </FormGroup>

            <Divider sx={{ my: 2 }} />

            <Typography variant="subtitle2" gutterBottom>
              Target Price (Optional)
            </Typography>
            <Typography variant="body2" color="text.secondary" mb={2}>
              Get notified when the price drops to or below this amount
            </Typography>
            <TextField
              fullWidth
              label="Target Price"
              placeholder="Enter your target price"
              value={targetPrice}
              onChange={(e) => setTargetPrice(e.target.value)}
              disabled={step > 3}
              type="number"
              InputProps={{
                startAdornment: <InputAdornment position="start"></InputAdornment>,
              }}
              sx={{ mb: 2 }}
            />

            {step === 3 && (
              <Button
                variant="contained"
                fullWidth
                size="large"
                onClick={handleStartTracking}
                startIcon={<Inventory />}
              >
                Start Tracking Product
              </Button>
            )}
          </CardContent>
        </Card>
      )}

      {/* Step 4: Success Confirmation */}
      {step === 4 && trackingSuccess && (
        <Card sx={{ mb: 3 }}>
          <CardContent sx={{ p: 2.5 }}>
            <Stack spacing={3} alignItems="center" textAlign="center">
              <CheckCircle sx={{ fontSize: 80, color: 'success.main' }} />
              <Typography variant="h5" fontWeight="bold" color="success.main">
                Product Tracking Started!
              </Typography>
              <Alert severity="success" sx={{ width: '100%' }}>
                <Typography variant="body2">
                  We're now monitoring <strong>{selectedProduct.product_name}</strong> for you.
                  You'll receive alerts based on your preferences.
                </Typography>
              </Alert>
              <Paper variant="outlined" sx={{ p: 2, width: '100%' }}>
                <Typography variant="subtitle2" gutterBottom color="text.secondary">
                  Your Alert Settings:
                </Typography>
                <Stack spacing={1} mt={1}>
                  {alertSettings.priceDrop && (
                    <Stack direction="row" spacing={1} alignItems="center">
                      <CheckCircle fontSize="small" color="success" />
                      <Typography variant="body2">Price drop notifications enabled</Typography>
                    </Stack>
                  )}
                  {alertSettings.priceIncrease && (
                    <Stack direction="row" spacing={1} alignItems="center">
                      <CheckCircle fontSize="small" color="success" />
                      <Typography variant="body2">
                        Price increase notifications enabled
                      </Typography>
                    </Stack>
                  )}
                  {alertSettings.festivalDeals && (
                    <Stack direction="row" spacing={1} alignItems="center">
                      <CheckCircle fontSize="small" color="success" />
                      <Typography variant="body2">Festival deal notifications enabled</Typography>
                    </Stack>
                  )}
                  {targetPrice && (
                    <Stack direction="row" spacing={1} alignItems="center">
                      <CheckCircle fontSize="small" color="success" />
                      <Typography variant="body2">
                        Target price set to {formatINR(Number(targetPrice))}
                      </Typography>
                    </Stack>
                  )}
                </Stack>
              </Paper>
              <Stack direction="row" spacing={2} width="100%">
                <Button variant="outlined" fullWidth onClick={handleTrackAnother}>
                  Track Another Product
                </Button>
                <Button variant="contained" fullWidth component={Link} to="/consumer/dashboard">
                  Go to Dashboard
                </Button>
              </Stack>
            </Stack>
          </CardContent>
        </Card>
      )}
    </Container>
  );
};

export default ProductTracking;
</file>

<file path="src/theme/theme.ts">
import { createTheme } from '@mui/material/styles';

declare module '@mui/material/styles' {
  interface Theme {
    status: { danger: string };
  }
  interface ThemeOptions {
    status?: { danger?: string };
  }
}

const theme = createTheme({
  palette: {
    mode: 'light',
    primary: {
      main: '#1a237e',
      light: '#534bae',
      dark: '#000051',
      contrastText: '#ffffff',
    },
    secondary: {
      main: '#ff6f00',
      light: '#ffa040',
      dark: '#c43e00',
      contrastText: '#ffffff',
    },
    background: {
      default: '#f8f9fb',
      paper: '#ffffff',
    },
    text: {
      primary: '#1a1a2e',
      secondary: '#64748b',
    },
    error: { main: '#ef4444', light: '#fca5a5' },
    warning: { main: '#f59e0b', light: '#fde68a' },
    info: { main: '#3b82f6', light: '#93c5fd' },
    success: { main: '#10b981', light: '#6ee7b7' },
    divider: 'rgba(0, 0, 0, 0.06)',
  },
  typography: {
    fontFamily: "'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif",
    h1: { fontSize: '2.25rem', fontWeight: 800, lineHeight: 1.2, letterSpacing: '-0.025em' },
    h2: { fontSize: '1.875rem', fontWeight: 700, lineHeight: 1.25, letterSpacing: '-0.02em' },
    h3: { fontSize: '1.5rem', fontWeight: 700, lineHeight: 1.3, letterSpacing: '-0.015em' },
    h4: { fontSize: '1.25rem', fontWeight: 700, lineHeight: 1.35, letterSpacing: '-0.01em' },
    h5: { fontSize: '1.125rem', fontWeight: 600, lineHeight: 1.4 },
    h6: { fontSize: '1rem', fontWeight: 600, lineHeight: 1.5 },
    subtitle1: { fontSize: '0.9375rem', fontWeight: 500, lineHeight: 1.5 },
    subtitle2: { fontSize: '0.75rem', fontWeight: 700, lineHeight: 1.5, letterSpacing: '0.06em', textTransform: 'uppercase' as const },
    body1: { fontSize: '0.9375rem', fontWeight: 400, lineHeight: 1.6 },
    body2: { fontSize: '0.8125rem', fontWeight: 400, lineHeight: 1.55 },
    button: { fontSize: '0.8125rem', fontWeight: 600, lineHeight: 1.75, letterSpacing: '0.02em', textTransform: 'none' as const },
    caption: { fontSize: '0.6875rem', fontWeight: 500, lineHeight: 1.5, letterSpacing: '0.02em' },
    overline: { fontSize: '0.625rem', fontWeight: 700, lineHeight: 2, letterSpacing: '0.1em', textTransform: 'uppercase' as const },
  },
  shape: { borderRadius: 12 },
  shadows: [
    'none',
    '0 1px 2px 0 rgba(0,0,0,0.05)',
    '0 1px 3px 0 rgba(0,0,0,0.07), 0 1px 2px -1px rgba(0,0,0,0.07)',
    '0 4px 6px -1px rgba(0,0,0,0.07), 0 2px 4px -2px rgba(0,0,0,0.07)',
    '0 10px 15px -3px rgba(0,0,0,0.07), 0 4px 6px -4px rgba(0,0,0,0.07)',
    '0 20px 25px -5px rgba(0,0,0,0.07), 0 8px 10px -6px rgba(0,0,0,0.07)',
    '0 25px 50px -12px rgba(0,0,0,0.15)',
    '0 25px 50px -12px rgba(0,0,0,0.18)',
    '0 25px 50px -12px rgba(0,0,0,0.2)',
    '0 25px 50px -12px rgba(0,0,0,0.22)',
    '0 25px 50px -12px rgba(0,0,0,0.24)',
    '0 25px 50px -12px rgba(0,0,0,0.26)',
    '0 25px 50px -12px rgba(0,0,0,0.28)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
    '0 25px 50px -12px rgba(0,0,0,0.3)',
  ],
  components: {
    MuiCssBaseline: {
      styleOverrides: { body: { scrollbarWidth: 'thin', scrollbarColor: 'rgba(0,0,0,0.15) transparent' } },
    },
    MuiButton: {
      styleOverrides: {
        root: {
          borderRadius: 10,
          textTransform: 'none',
          fontWeight: 600,
          padding: '8px 20px',
          boxShadow: 'none',
          transition: 'all 0.2s cubic-bezier(0.22, 1, 0.36, 1)',
          '&:hover': { boxShadow: '0 4px 12px rgba(0,0,0,0.12)', transform: 'translateY(-1px)' },
          '&:active': { transform: 'translateY(0)' },
        },
        contained: { '&:hover': { boxShadow: '0 6px 16px rgba(26, 35, 126, 0.25)' } },
        sizeLarge: { padding: '12px 28px', fontSize: '0.9375rem', borderRadius: 12 },
        sizeSmall: { padding: '6px 14px', fontSize: '0.75rem', borderRadius: 8 },
      },
      defaultProps: { disableElevation: true },
    },
    MuiCard: {
      styleOverrides: {
        root: {
          borderRadius: 16,
          boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06)',
          border: '1px solid rgba(0,0,0,0.04)',
          transition: 'all 0.25s cubic-bezier(0.22, 1, 0.36, 1)',
          '&:hover': { boxShadow: '0 10px 25px -5px rgba(0,0,0,0.08), 0 4px 6px -4px rgba(0,0,0,0.06)', transform: 'translateY(-2px)' },
        },
      },
    },
    MuiChip: {
      styleOverrides: {
        root: { borderRadius: 8, fontWeight: 600, fontSize: '0.75rem', height: 28 },
        sizeSmall: { height: 24, fontSize: '0.6875rem' },
        outlined: { borderWidth: 1.5 },
      },
    },
    MuiPaper: {
      styleOverrides: {
        root: { borderRadius: 12, backgroundImage: 'none' },
        elevation1: { boxShadow: '0 1px 3px rgba(0,0,0,0.04), 0 1px 2px rgba(0,0,0,0.06)', border: '1px solid rgba(0,0,0,0.04)' },
        elevation2: { boxShadow: '0 4px 6px -1px rgba(0,0,0,0.05), 0 2px 4px -2px rgba(0,0,0,0.05)', border: '1px solid rgba(0,0,0,0.04)' },
        elevation3: { boxShadow: '0 10px 15px -3px rgba(0,0,0,0.06), 0 4px 6px -4px rgba(0,0,0,0.06)' },
        elevation4: { boxShadow: '0 20px 25px -5px rgba(0,0,0,0.07), 0 8px 10px -6px rgba(0,0,0,0.07)' },
        outlined: { borderColor: 'rgba(0,0,0,0.08)' },
      },
    },
    MuiAppBar: {
      styleOverrides: { root: { backgroundImage: 'none' } },
    },
    MuiTextField: {
      styleOverrides: {
        root: {
          '& .MuiOutlinedInput-root': {
            borderRadius: 10,
            transition: 'box-shadow 0.2s ease',
            '&:hover .MuiOutlinedInput-notchedOutline': { borderColor: '#534bae' },
            '&.Mui-focused': { boxShadow: '0 0 0 3px rgba(26, 35, 126, 0.08)' },
            '&.Mui-focused .MuiOutlinedInput-notchedOutline': { borderWidth: 2 },
          },
        },
      },
    },
    MuiDialog: {
      styleOverrides: { paper: { borderRadius: 20, boxShadow: '0 25px 50px -12px rgba(0,0,0,0.25)' } },
    },
    MuiTooltip: {
      styleOverrides: {
        tooltip: { backgroundColor: '#1a1a2e', fontSize: '0.75rem', fontWeight: 500, padding: '6px 12px', borderRadius: 8, boxShadow: '0 4px 12px rgba(0,0,0,0.15)' },
        arrow: { color: '#1a1a2e' },
      },
    },
    MuiAlert: {
      styleOverrides: {
        root: { borderRadius: 12, fontSize: '0.8125rem', fontWeight: 500, border: '1px solid' },
        standardSuccess: { backgroundColor: '#ecfdf5', borderColor: '#a7f3d0', color: '#065f46' },
        standardError: { backgroundColor: '#fef2f2', borderColor: '#fecaca', color: '#991b1b' },
        standardWarning: { backgroundColor: '#fffbeb', borderColor: '#fde68a', color: '#92400e' },
        standardInfo: { backgroundColor: '#eff6ff', borderColor: '#bfdbfe', color: '#1e40af' },
      },
    },
    MuiTableCell: {
      styleOverrides: {
        root: { borderBottom: '1px solid rgba(0,0,0,0.06)', padding: '14px 16px' },
        head: { fontWeight: 700, fontSize: '0.6875rem', letterSpacing: '0.05em', textTransform: 'uppercase', backgroundColor: '#f8f9fb', color: '#64748b' },
      },
    },
    MuiTab: {
      styleOverrides: { root: { textTransform: 'none', fontWeight: 600, fontSize: '0.8125rem', minHeight: 48 } },
    },
    MuiLinearProgress: {
      styleOverrides: {
        root: { borderRadius: 4, height: 6, backgroundColor: 'rgba(0,0,0,0.06)' },
        bar: { borderRadius: 4 },
      },
    },
  },
});

export default theme;
</file>

<file path="src/types/index.ts">
export interface Product {
  product_id: string;
  product_name: string;
  category: string;
  platform: 'amazon_india' | 'flipkart';
  product_url: string;
  current_price: number;
  original_price: number;
  currency: string;
  availability: 'in_stock' | 'out_of_stock';
  last_updated: string;
  image_url: string;
  brand: string;
  rating: number;
  review_count: number;
  features: Record<string, string>;
  description: string;
}

export interface PriceRecord {
  product_id: string;
  platform: string;
  price: number;
  timestamp: string;
  availability: string;
}

export interface Alert {
  alert_id: string;
  user_id: string;
  product_id: string;
  product_name: string;
  alert_type: 'price_drop' | 'price_increase' | 'festival' | 'back_in_stock';
  old_price: number;
  new_price: number;
  percentage_change: number;
  timestamp: string;
  read: boolean;
  platform: string;
}

export interface Festival {
  festival_id: string;
  name: string;
  date: string;
  type: 'religious' | 'national' | 'sale_event';
  days_until: number;
  historical_discount_avg: number;
  affected_categories: string[];
  description: string;
  historical_discounts: { year: number; discount: number }[];
}

export interface ChatMessage {
  id: string;
  role: 'user' | 'assistant';
  content: string;
  timestamp: string;
  products?: Product[];
}

export interface MarketStats {
  category: string;
  avg_price: number;
  median_price: number;
  std_dev: number;
  price_range: [number, number];
  trend: 'rising' | 'falling' | 'stable';
  volatility: 'high' | 'medium' | 'low';
  product_count: number;
}

export interface Competitor {
  rank: number;
  name: string;
  avg_price: number;
  market_share: number;
  strategy: string;
  isUser?: boolean;
}

export interface PricingScenario {
  label: string;
  price: number;
  margin_pct: number;
  position: string;
  estimated_demand: string;
  risk: string;
  pros: string[];
  cons: string[];
  recommended?: boolean;
  units_per_month: number;
  revenue: number;
  profit: number;
}

export interface PricingStrategy {
  recommended_price: number;
  min_price: number;
  competitive_position: string;
  percentile: number;
  rationale: string;
  scenarios: PricingScenario[];
}

export interface MarketOpportunity {
  product: string;
  demand_change: string;
  competition: 'Low' | 'Medium' | 'High';
  avg_price: number;
  potential_margin: string;
}

export type ViewMode = 'consumer' | 'msme';
</file>

<file path="src/utils/chatResponses.ts">
import type { Product } from '../types/index';
import { formatINR, calculateSavings } from './formatters';

interface AIResponse {
  text: string;
  products?: Product[];
  followUpQuestions: string[];
}

/**
 * Generate an AI response based on user message and available products
 * @param message - User's message
 * @param products - Array of available products
 * @returns AI response with text, products, and follow-up questions
 */
export function generateAIResponse(message: string, products: Product[]): AIResponse {
  const lowerMessage = message.toLowerCase().trim();

  // Greeting patterns
  if (isGreeting(lowerMessage)) {
    return {
      text: "Hello! I'm your RetailIQ AI assistant. I'm here to help you find the best deals on products across Amazon and Flipkart in India. I can help you compare prices, track deals, and recommend the best time to buy. What are you looking for today?",
      followUpQuestions: [
        'Find me a laptop under 50,000',
        'What are the trending products today?',
        'Should I buy a smartphone now or wait?',
        'Compare iPhone vs Samsung phones',
      ],
    };
  }

  // Help or capabilities query
  if (isHelpQuery(lowerMessage)) {
    return {
      text: "I can assist you with:\n\n Finding products based on your budget and preferences\n Comparing prices across Amazon India and Flipkart\n Tracking price history and trends\n Recommending the best time to purchase\n Alerting you about price drops and festival sales\n Providing insights on trending products\n\nJust tell me what you're looking for, and I'll help you find the best deal!",
      followUpQuestions: [
        'Find me the best smartphone under 20,000',
        'What phones are trending right now?',
        'When is the next big sale?',
        'Compare prices for gaming laptops',
      ],
    };
  }

  // Product search with price range
  if (isPriceRangeQuery(lowerMessage)) {
    return handlePriceRangeQuery(lowerMessage, products);
  }

  // Compare prices query
  if (isComparisonQuery(lowerMessage)) {
    return handleComparisonQuery(lowerMessage, products);
  }

  // Best product recommendation
  if (isBestProductQuery(lowerMessage)) {
    return handleBestProductQuery(lowerMessage, products);
  }

  // Trending products query
  if (isTrendingQuery(lowerMessage)) {
    return handleTrendingQuery(products);
  }

  // Purchase timing advice
  if (isPurchaseTimingQuery(lowerMessage)) {
    return handlePurchaseTimingQuery(lowerMessage);
  }

  // Category-specific queries
  if (isCategoryQuery(lowerMessage)) {
    return handleCategoryQuery(lowerMessage, products);
  }

  // Price drop queries
  if (isPriceDropQuery(lowerMessage)) {
    return handlePriceDropQuery(products);
  }

  // Festival and sale queries
  if (isFestivalQuery(lowerMessage)) {
    return handleFestivalQuery();
  }

  // Brand-specific queries
  if (isBrandQuery(lowerMessage)) {
    return handleBrandQuery(lowerMessage, products);
  }

  // Rating-based queries
  if (isRatingQuery(lowerMessage)) {
    return handleRatingQuery(lowerMessage, products);
  }

  // Default fallback
  return {
    text: "I'd be happy to help you with that! Could you provide more details about what you're looking for? For example, you can:\n\n Specify a product category and budget (e.g., 'laptop under 60,000')\n Ask for comparisons (e.g., 'compare iPhone prices')\n Request trending products (e.g., 'what's trending in electronics')\n Ask about purchase timing (e.g., 'should I buy now or wait')",
    followUpQuestions: [
      'Show me laptops under 50,000',
      'What are the best deals today?',
      'Find me highly-rated smartphones',
      'When is the next sale?',
    ],
  };
}

// Helper function to check if message is a greeting
function isGreeting(message: string): boolean {
  const greetings = ['hello', 'hi', 'hey', 'namaste', 'good morning', 'good afternoon', 'good evening'];
  return greetings.some((greeting) => message === greeting || message.startsWith(greeting + ' '));
}

// Helper function to check if message is a help query
function isHelpQuery(message: string): boolean {
  return (
    message.includes('help') ||
    message.includes('what can you do') ||
    message.includes('how can you help') ||
    message.includes('capabilities')
  );
}

// Helper function to check if message contains price range
function isPriceRangeQuery(message: string): boolean {
  return (
    (message.includes('under') || message.includes('below') || message.includes('less than')) &&
    (message.includes('') || message.includes('rs') || message.includes('rupees') || /\d{3,}/.test(message))
  );
}

// Helper function to check if message is asking for comparison
function isComparisonQuery(message: string): boolean {
  return (
    message.includes('compare') ||
    message.includes('comparison') ||
    message.includes('vs') ||
    message.includes('versus') ||
    message.includes('difference between')
  );
}

// Helper function to check if asking for best product
function isBestProductQuery(message: string): boolean {
  return (
    message.includes('best') ||
    message.includes('top') ||
    message.includes('recommend') ||
    message.includes('suggest') ||
    message.includes('good')
  );
}

// Helper function to check if asking about trending products
function isTrendingQuery(message: string): boolean {
  return (
    message.includes('trending') ||
    message.includes('popular') ||
    message.includes('hot') ||
    message.includes("what's selling") ||
    message.includes('most bought')
  );
}

// Helper function to check if asking about purchase timing
function isPurchaseTimingQuery(message: string): boolean {
  return (
    message.includes('should i buy') ||
    message.includes('buy now') ||
    message.includes('wait') ||
    message.includes('right time') ||
    message.includes('when to buy')
  );
}

// Helper function to check if asking about specific category
function isCategoryQuery(message: string): boolean {
  const categories = [
    'laptop',
    'phone',
    'smartphone',
    'tablet',
    'headphone',
    'earbuds',
    'watch',
    'tv',
    'camera',
    'gaming',
  ];
  return categories.some((cat) => message.includes(cat));
}

// Helper function to check if asking about price drops
function isPriceDropQuery(message: string): boolean {
  return (
    message.includes('price drop') ||
    message.includes('discount') ||
    message.includes('deal') ||
    message.includes('offer') ||
    message.includes('sale')
  );
}

// Helper function to check if asking about festivals
function isFestivalQuery(message: string): boolean {
  return (
    message.includes('festival') ||
    message.includes('diwali') ||
    message.includes('holi') ||
    message.includes('sale event') ||
    message.includes('big billion') ||
    message.includes('great indian')
  );
}

// Helper function to check if asking about specific brand
function isBrandQuery(message: string): boolean {
  const brands = ['apple', 'samsung', 'oneplus', 'xiaomi', 'realme', 'oppo', 'vivo', 'dell', 'hp', 'lenovo', 'asus'];
  return brands.some((brand) => message.includes(brand));
}

// Helper function to check if asking about ratings
function isRatingQuery(message: string): boolean {
  return (
    message.includes('highly rated') ||
    message.includes('best rated') ||
    message.includes('top rated') ||
    message.includes('rating') ||
    message.includes('reviews')
  );
}

// Handler for price range queries
function handlePriceRangeQuery(message: string, products: Product[]): AIResponse {
  // Extract price from message
  const priceMatch = message.match(/\d+[,\d]*/);
  const maxPrice = priceMatch ? parseInt(priceMatch[0].replace(/,/g, '')) : 50000;

  // Extract category if mentioned
  let category = '';
  const categories = ['laptop', 'phone', 'smartphone', 'tablet', 'headphone', 'earbuds', 'watch', 'tv', 'camera'];
  for (const cat of categories) {
    if (message.includes(cat)) {
      category = cat;
      break;
    }
  }

  // Filter products
  let filtered = products.filter((p) => p.current_price <= maxPrice);

  if (category) {
    filtered = filtered.filter((p) => p.category.toLowerCase().includes(category));
  }

  // Sort by rating and reviews
  filtered.sort((a, b) => {
    const scoreA = a.rating * Math.log10(a.review_count + 1);
    const scoreB = b.rating * Math.log10(b.review_count + 1);
    return scoreB - scoreA;
  });

  const topProducts = filtered.slice(0, 6);

  if (topProducts.length === 0) {
    return {
      text: `I couldn't find any ${category || 'products'} under ${formatINR(maxPrice)} in our current inventory. Would you like me to:\n\n Increase the budget range\n Look at different categories\n Set up a price alert for when products become available`,
      followUpQuestions: [
        `Find products under ${formatINR(maxPrice * 1.5)}`,
        'Show me all available products',
        'What are the cheapest options?',
        'Set up a price alert',
      ],
    };
  }

  const categoryText = category ? ` ${category}s` : ' products';
  const savingsInfo =
    topProducts[0].original_price > topProducts[0].current_price
      ? ` The top option has ${formatINR(topProducts[0].original_price - topProducts[0].current_price)} off!`
      : '';

  return {
    text: `Great! I found ${filtered.length} excellent${categoryText} under ${formatINR(maxPrice)} for you.${savingsInfo}\n\nHere are the top-rated options based on customer reviews and ratings. All prices are current as of today across Amazon India and Flipkart.`,
    products: topProducts,
    followUpQuestions: [
      'Compare prices for these products',
      'Show me more options',
      'Which one would you recommend?',
      'Set price alerts for these',
    ],
  };
}

// Handler for comparison queries
function handleComparisonQuery(message: string, products: Product[]): AIResponse {
  // Try to extract brand or product type
  const brands = ['apple', 'samsung', 'oneplus', 'xiaomi', 'realme', 'iphone'];
  const mentionedBrands = brands.filter((brand) => message.includes(brand));

  if (mentionedBrands.length > 0) {
    const filtered = products.filter((p) =>
      mentionedBrands.some((brand) => p.brand.toLowerCase().includes(brand) || p.product_name.toLowerCase().includes(brand))
    );

    const topProducts = filtered.slice(0, 6);

    if (topProducts.length < 2) {
      return {
        text: `I found limited products to compare. Let me show you what's available and suggest some alternatives in the same category.`,
        products: topProducts.length > 0 ? topProducts : products.slice(0, 6),
        followUpQuestions: [
          'Show me more options',
          'Compare different brands',
          'What are the best deals?',
          'Find products under 30,000',
        ],
      };
    }

    // Calculate average prices and savings
    const avgPrice = topProducts.reduce((sum, p) => sum + p.current_price, 0) / topProducts.length;
    const totalSavings = topProducts.reduce(
      (sum, p) => sum + (p.original_price > p.current_price ? p.original_price - p.current_price : 0),
      0
    );

    return {
      text: `Here's a comparison of ${mentionedBrands.join(' vs ')} products:\n\n Found ${filtered.length} products\n Average price: ${formatINR(avgPrice)}\n Total savings available: ${formatINR(totalSavings)}\n\nI'm showing you the best options based on ratings, reviews, and current deals. You can compare prices, features, and availability across both Amazon India and Flipkart.`,
      products: topProducts,
      followUpQuestions: [
        'Which one offers the best value?',
        'Show me the cheapest option',
        'Which has the best reviews?',
        'Set alerts for price drops',
      ],
    };
  }

  // Generic comparison
  const topProducts = products.slice(0, 6);
  return {
    text: "I can help you compare products! Here are some popular options across different categories and platforms. Each product card shows the current price, discount, ratings, and platform availability.\n\nLet me know which specific products or categories you'd like to compare in detail.",
    products: topProducts,
    followUpQuestions: [
      'Compare laptops under 60,000',
      'Compare iPhone vs Samsung phones',
      'Compare prices across platforms',
      'Show me the best deals',
    ],
  };
}

// Handler for best product queries
function handleBestProductQuery(message: string, products: Product[]): AIResponse {
  // Extract category if mentioned
  const categories = ['laptop', 'phone', 'smartphone', 'tablet', 'headphone', 'earbuds', 'watch', 'tv', 'camera'];
  let category = '';

  for (const cat of categories) {
    if (message.includes(cat)) {
      category = cat;
      break;
    }
  }

  let filtered = products;
  if (category) {
    filtered = products.filter((p) => p.category.toLowerCase().includes(category));
  }

  // Sort by a combination of rating, reviews, and discount
  filtered.sort((a, b) => {
    const discountA = ((a.original_price - a.current_price) / a.original_price) * 100;
    const discountB = ((b.original_price - b.current_price) / b.original_price) * 100;

    const scoreA = a.rating * 0.4 + Math.log10(a.review_count + 1) * 0.3 + discountA * 0.3;
    const scoreB = b.rating * 0.4 + Math.log10(b.review_count + 1) * 0.3 + discountB * 0.3;

    return scoreB - scoreA;
  });

  const topProducts = filtered.slice(0, 6);
  const categoryText = category ? ` ${category}` : '';

  if (topProducts.length === 0) {
    return {
      text: `I don't have any${categoryText} products in the current inventory. Let me show you what's available in other categories.`,
      products: products.slice(0, 6),
      followUpQuestions: [
        'Show me all categories',
        'What are the trending products?',
        'Find me the best deals',
        'Set up product alerts',
      ],
    };
  }

  const bestProduct = topProducts[0];
  const savings = calculateSavings(bestProduct.original_price, bestProduct.current_price);

  return {
    text: `Based on customer ratings, reviews, and current discounts, here are the best${categoryText} options for you:\n\n Top Pick: ${bestProduct.product_name}\n Rating: ${bestProduct.rating} (${bestProduct.review_count.toLocaleString('en-IN')} reviews)\n Price: ${formatINR(bestProduct.current_price)}${savings.amount > 0 ? ` (Save ${formatINR(savings.amount)} - ${savings.percentage}% off!)` : ''}\n Platform: ${bestProduct.platform === 'amazon_india' ? 'Amazon India' : 'Flipkart'}\n\nI've also included other highly-rated alternatives for you to compare!`,
    products: topProducts,
    followUpQuestions: [
      'Why is this the best option?',
      'Show me cheaper alternatives',
      'Compare with other brands',
      'Set a price alert',
    ],
  };
}

// Handler for trending queries
function handleTrendingQuery(products: Product[]): AIResponse {
  // Sort by a combination of recent reviews and high ratings
  const trending = [...products]
    .sort((a, b) => {
      const scoreA = a.rating * Math.log10(a.review_count + 10);
      const scoreB = b.rating * Math.log10(b.review_count + 10);
      return scoreB - scoreA;
    })
    .slice(0, 6);

  const totalProducts = products.length;
  const avgDiscount =
    products.reduce((sum, p) => {
      const discount = ((p.original_price - p.current_price) / p.original_price) * 100;
      return sum + discount;
    }, 0) / products.length;

  return {
    text: ` Here are the trending products right now across Amazon India and Flipkart!\n\nThese ${trending.length} products are getting the most attention from buyers:\n Total products tracked: ${totalProducts}\n Average discount: ${avgDiscount.toFixed(1)}%\n All products shown have 4+ star ratings\n\nThese trending items are popular due to their great reviews, competitive pricing, and high demand. Many have limited stock, so it's a good time to check them out!`,
    products: trending,
    followUpQuestions: [
      'Which one is the best deal?',
      'Show me more trending items',
      'Set alerts for these products',
      'Compare prices across platforms',
    ],
  };
}

// Handler for purchase timing queries
function handlePurchaseTimingQuery(_message: string): AIResponse {
  const currentMonth = new Date().getMonth();
  const upcomingSales = getUpcomingSales(currentMonth);

  if (upcomingSales.length > 0) {
    const nextSale = upcomingSales[0];
    return {
      text: `Great question! Here's my purchase timing advice:\n\n ${nextSale.message}\n\n General Tips:\n Prices typically drop 15-40% during major sales\n Best deals are on Day 1 and last day of sales\n Electronics see bigger discounts during Diwali and Republic Day sales\n Set up price alerts so you don't miss drops\n\nIf you need the product urgently, current prices are reasonable. But if you can wait, ${nextSale.recommendation}`,
      followUpQuestions: [
        'Show me current best deals',
        'Set price alerts for specific products',
        'What categories have best discounts?',
        'Compare prices across platforms',
      ],
    };
  }

  return {
    text: "Here's my advice on purchase timing:\n\n Should you buy now?\n If you need the product immediately: Yes, go ahead!\n If you can wait: Consider waiting for upcoming sales\n\n Price Patterns in India:\n Major sales: Republic Day (Jan), Amazon Prime Day (Jul), Diwali (Oct-Nov), Black Friday (Nov)\n Best discounts: Diwali and Republic Day sales (20-40% off)\n Electronics peak during festival seasons\n\nI recommend setting up price alerts so you're notified immediately when prices drop!",
    followUpQuestions: [
      'Set up price alerts',
      'Show me current deals',
      'Compare prices now',
      'What products are likely to drop?',
    ],
  };
}

// Handler for category queries
function handleCategoryQuery(message: string, products: Product[]): AIResponse {
  const categories = ['laptop', 'phone', 'smartphone', 'tablet', 'headphone', 'earbuds', 'watch', 'tv', 'camera'];
  let category = '';

  for (const cat of categories) {
    if (message.includes(cat)) {
      category = cat;
      break;
    }
  }

  const filtered = products.filter((p) => p.category.toLowerCase().includes(category));
  const topProducts = filtered.slice(0, 6);

  if (topProducts.length === 0) {
    return {
      text: `I don't have any ${category} products in the current inventory. Let me show you what's available in other popular categories.`,
      products: products.slice(0, 6),
      followUpQuestions: [
        'Show me all categories',
        'What products do you track?',
        'Find me the best deals',
        'Show trending products',
      ],
    };
  }

  const avgPrice = filtered.reduce((sum, p) => sum + p.current_price, 0) / filtered.length;
  const avgRating = filtered.reduce((sum, p) => sum + p.rating, 0) / filtered.length;

  return {
    text: `I found ${filtered.length} ${category} products for you!\n\n Category Insights:\n Average price: ${formatINR(avgPrice)}\n Average rating: ${avgRating.toFixed(1)}\n Available on: Amazon India & Flipkart\n\nHere are the top-rated options based on customer reviews and current deals:`,
    products: topProducts,
    followUpQuestions: [
      `Find ${category} under 50,000`,
      `Compare top ${category} brands`,
      `What are the best deals?`,
      `Set price alerts`,
    ],
  };
}

// Handler for price drop queries
function handlePriceDropQuery(products: Product[]): AIResponse {
  // Filter products with discounts
  const dealsProducts = products
    .filter((p) => p.original_price > p.current_price)
    .sort((a, b) => {
      const discountA = ((a.original_price - a.current_price) / a.original_price) * 100;
      const discountB = ((b.original_price - b.current_price) / b.original_price) * 100;
      return discountB - discountA;
    })
    .slice(0, 6);

  if (dealsProducts.length === 0) {
    return {
      text: "Currently, most products are at their regular prices. However, I'm continuously tracking prices across platforms. Let me show you some highly-rated products that offer great value:\n\n Tip: Set up price alerts to get notified immediately when prices drop!",
      products: products.slice(0, 6),
      followUpQuestions: [
        'Set up price alerts',
        'When is the next sale?',
        'Show me trending products',
        'Find products under budget',
      ],
    };
  }

  const avgDiscount =
    dealsProducts.reduce((sum, p) => {
      const discount = ((p.original_price - p.current_price) / p.original_price) * 100;
      return sum + discount;
    }, 0) / dealsProducts.length;

  const totalSavings = dealsProducts.reduce((sum, p) => sum + (p.original_price - p.current_price), 0);

  return {
    text: ` Great news! I found ${dealsProducts.length} products with active price drops:\n\n Average discount: ${avgDiscount.toFixed(1)}%\n Total potential savings: ${formatINR(totalSavings)}\n Best deal: ${dealsProducts[0].product_name} at ${((dealsProducts[0].original_price - dealsProducts[0].current_price) / dealsProducts[0].original_price * 100).toFixed(1)}% off\n\nThese are the best deals available right now across Amazon India and Flipkart!`,
    products: dealsProducts,
    followUpQuestions: [
      'Show me more deals',
      'Set alerts for similar products',
      'Compare these deals',
      'Which deal is the best?',
    ],
  };
}

// Handler for festival queries
function handleFestivalQuery(): AIResponse {
  const currentMonth = new Date().getMonth();
  const upcomingSales = getUpcomingSales(currentMonth);

  if (upcomingSales.length > 0) {
    const salesText = upcomingSales.map((sale, idx) => `${idx + 1}. ${sale.name} - ${sale.timing}`).join('\n');

    return {
      text: ` Upcoming Festival Sales in India:\n\n${salesText}\n\n Expected Discounts:\n Electronics: 20-40% off\n Fashion: 30-70% off\n Home & Kitchen: 40-60% off\n Smartphones: 15-35% off\n\n Major Sale Events:\n Amazon Great Indian Festival\n Flipkart Big Billion Days\n Republic Day Sale (January)\n Independence Day Sale (August)\n\nI recommend setting up price alerts now so you're notified the moment deals go live!`,
      followUpQuestions: [
        'Set price alerts for next sale',
        'What products have best festival discounts?',
        'Show me current deals',
        'Compare platform sales',
      ],
    };
  }

  return {
    text: " Festival & Sale Calendar for India:\n\nMajor annual sales you shouldn't miss:\n\n1. Republic Day Sale (January) - 20-40% off electronics\n2. Amazon Prime Day (July) - Exclusive member deals\n3. Independence Day Sale (August) - 15-50% off all categories\n4. Diwali Sales (October-November) - Biggest discounts of the year!\n5. Black Friday/Cyber Monday (November) - 25-60% off\n6. Year-End Sale (December) - Clearance deals\n\nSet up alerts now to never miss a deal!",
    followUpQuestions: [
      'Set up price alerts',
      'What products should I buy in sales?',
      'Compare Amazon vs Flipkart sales',
      'Show me current best deals',
    ],
  };
}

// Handler for brand queries
function handleBrandQuery(message: string, products: Product[]): AIResponse {
  const brands = ['apple', 'samsung', 'oneplus', 'xiaomi', 'realme', 'oppo', 'vivo', 'dell', 'hp', 'lenovo', 'asus'];
  let brand = '';

  for (const b of brands) {
    if (message.includes(b)) {
      brand = b;
      break;
    }
  }

  const filtered = products.filter(
    (p) => p.brand.toLowerCase().includes(brand) || p.product_name.toLowerCase().includes(brand)
  );

  const topProducts = filtered.slice(0, 6);

  if (topProducts.length === 0) {
    return {
      text: `I don't have any ${brand} products in the current inventory. Let me show you similar alternatives from other popular brands.`,
      products: products.slice(0, 6),
      followUpQuestions: [
        'Show me all brands',
        'Compare different brands',
        'What are the best alternatives?',
        'Find highly-rated products',
      ],
    };
  }

  const avgPrice = filtered.reduce((sum, p) => sum + p.current_price, 0) / filtered.length;
  const avgRating = filtered.reduce((sum, p) => sum + p.rating, 0) / filtered.length;

  return {
    text: `I found ${filtered.length} ${brand.charAt(0).toUpperCase() + brand.slice(1)} products!\n\n Brand Insights:\n Average price: ${formatINR(avgPrice)}\n Average rating: ${avgRating.toFixed(1)}\n Product range: ${formatINR(Math.min(...filtered.map((p) => p.current_price)))} - ${formatINR(Math.max(...filtered.map((p) => p.current_price)))}\n\nHere are the best ${brand} products based on ratings and current deals:`,
    products: topProducts,
    followUpQuestions: [
      `Compare ${brand} with other brands`,
      `Find ${brand} products under 50,000`,
      `What are the best ${brand} deals?`,
      `Set price alerts for ${brand}`,
    ],
  };
}

// Handler for rating queries
function handleRatingQuery(_message: string, products: Product[]): AIResponse {
  // Filter for highly rated products (4+ stars)
  const highlyRated = products
    .filter((p) => p.rating >= 4.0)
    .sort((a, b) => {
      // Sort by rating first, then by number of reviews
      if (b.rating !== a.rating) {
        return b.rating - a.rating;
      }
      return b.review_count - a.review_count;
    })
    .slice(0, 6);

  if (highlyRated.length === 0) {
    return {
      text: "Let me show you the best available products based on customer feedback and reviews.",
      products: products.slice(0, 6),
      followUpQuestions: [
        'Show me all products',
        'Find products by category',
        'What are the best deals?',
        'Compare prices',
      ],
    };
  }

  const avgRating = highlyRated.reduce((sum, p) => sum + p.rating, 0) / highlyRated.length;
  const totalReviews = highlyRated.reduce((sum, p) => sum + p.review_count, 0);

  return {
    text: ` Here are the highest-rated products:\n\n ${highlyRated.length} products with 4+ star ratings\n Average rating: ${avgRating.toFixed(1)}\n Total customer reviews: ${totalReviews.toLocaleString('en-IN')}\n\nThese products are loved by customers and have consistently excellent reviews. You can trust these choices!`,
    products: highlyRated,
    followUpQuestions: [
      'Which one offers best value?',
      'Show me more highly-rated products',
      'Compare prices for these',
      'Set price alerts',
    ],
  };
}

// Helper to get upcoming sales based on current month
function getUpcomingSales(currentMonth: number): Array<{ name: string; timing: string; message: string; recommendation: string }> {
  const sales = [];

  // January - Republic Day
  if (currentMonth === 0) {
    sales.push({
      name: 'Republic Day Sale',
      timing: 'Around 26th January',
      message: 'Republic Day Sale is coming soon! Expect 20-40% discounts.',
      recommendation: "waiting a few days could save you significant money, especially on electronics.",
    });
  }

  // June-July - Prime Day
  if (currentMonth >= 5 && currentMonth <= 6) {
    sales.push({
      name: 'Amazon Prime Day',
      timing: 'Mid-July',
      message: 'Amazon Prime Day is approaching! Great deals for Prime members.',
      recommendation: "if you're an Amazon Prime member, waiting could get you exclusive deals.",
    });
  }

  // July-August - Independence Day
  if (currentMonth >= 6 && currentMonth <= 7) {
    sales.push({
      name: 'Independence Day Sale',
      timing: 'Around 15th August',
      message: 'Independence Day Sale is near! Expect 15-50% off across categories.',
      recommendation: "waiting for Independence Day could give you better prices.",
    });
  }

  // September-October - Diwali
  if (currentMonth >= 8 && currentMonth <= 10) {
    sales.push({
      name: 'Diwali Festival Sale',
      timing: 'October-November',
      message: 'Diwali Sale is approaching - the BIGGEST sale of the year!',
      recommendation: "definitely consider waiting for Diwali sales. They offer the best discounts all year (up to 40% off)!",
    });
  }

  // November - Black Friday
  if (currentMonth === 10) {
    sales.push({
      name: 'Black Friday / Cyber Monday',
      timing: 'Late November',
      message: 'Black Friday & Cyber Monday are coming! International sale season.',
      recommendation: "waiting a few weeks could get you Black Friday deals.",
    });
  }

  // December - Year End
  if (currentMonth === 11) {
    sales.push({
      name: 'Year-End Clearance Sale',
      timing: 'Throughout December',
      message: "Year-end clearance sales are active! Retailers are clearing inventory.",
      recommendation: "this is a great time to buy as sellers want to clear stock before the new year.",
    });
  }

  return sales;
}
</file>

<file path="src/utils/formatters.ts">
/**
 * Format a number as Indian Rupees with proper formatting
 * Uses Indian number system with lakhs and crores
 * @param amount - The amount to format
 * @returns Formatted string with  symbol
 */
export function formatINR(amount: number): string {
  if (amount === 0) return '0';
  if (!amount || isNaN(amount)) return '0';

  const isNegative = amount < 0;
  const absAmount = Math.abs(amount);

  // Convert to string and split into integer and decimal parts
  const parts = absAmount.toFixed(2).split('.');
  let integerPart = parts[0];
  const decimalPart = parts[1];

  // Apply Indian number system formatting
  // Last 3 digits, then groups of 2
  let lastThree = integerPart.substring(integerPart.length - 3);
  const otherNumbers = integerPart.substring(0, integerPart.length - 3);

  if (otherNumbers !== '') {
    lastThree = ',' + lastThree;
  }

  let formatted = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ',') + lastThree;

  // Remove unnecessary decimals if they are .00
  const result = decimalPart === '00' ? formatted : `${formatted}.${decimalPart}`;

  return `${isNegative ? '-' : ''}${result}`;
}

/**
 * Format a number as a percentage with sign
 * @param value - The percentage value (e.g., 15 for 15%)
 * @returns Formatted percentage string with sign
 */
export function formatPercentage(value: number): string {
  if (!value || isNaN(value)) return '0%';

  const sign = value > 0 ? '+' : '';
  const rounded = Math.round(value * 10) / 10; // Round to 1 decimal place

  return `${sign}${rounded}%`;
}

/**
 * Format an ISO date string to a human-readable format
 * @param isoString - ISO 8601 date string
 * @returns Formatted date string (e.g., "12 Feb 2026")
 */
export function formatDate(isoString: string): string {
  if (!isoString) return '';

  try {
    const date = new Date(isoString);
    if (isNaN(date.getTime())) return '';

    const day = date.getDate();
    const month = date.toLocaleString('en-US', { month: 'short' });
    const year = date.getFullYear();

    return `${day} ${month} ${year}`;
  } catch {
    return '';
  }
}

/**
 * Format an ISO date string to relative time
 * @param isoString - ISO 8601 date string
 * @returns Relative time string (e.g., "2 hours ago", "1 day ago")
 */
export function formatRelativeTime(isoString: string): string {
  if (!isoString) return '';

  try {
    const date = new Date(isoString);
    const now = new Date();

    if (isNaN(date.getTime())) return '';

    const diffMs = now.getTime() - date.getTime();
    const diffSecs = Math.floor(diffMs / 1000);
    const diffMins = Math.floor(diffSecs / 60);
    const diffHours = Math.floor(diffMins / 60);
    const diffDays = Math.floor(diffHours / 24);
    const diffWeeks = Math.floor(diffDays / 7);
    const diffMonths = Math.floor(diffDays / 30);
    const diffYears = Math.floor(diffDays / 365);

    if (diffSecs < 60) {
      return 'just now';
    } else if (diffMins < 60) {
      return `${diffMins} ${diffMins === 1 ? 'minute' : 'minutes'} ago`;
    } else if (diffHours < 24) {
      return `${diffHours} ${diffHours === 1 ? 'hour' : 'hours'} ago`;
    } else if (diffDays < 7) {
      return `${diffDays} ${diffDays === 1 ? 'day' : 'days'} ago`;
    } else if (diffWeeks < 4) {
      return `${diffWeeks} ${diffWeeks === 1 ? 'week' : 'weeks'} ago`;
    } else if (diffMonths < 12) {
      return `${diffMonths} ${diffMonths === 1 ? 'month' : 'months'} ago`;
    } else {
      return `${diffYears} ${diffYears === 1 ? 'year' : 'years'} ago`;
    }
  } catch {
    return '';
  }
}

/**
 * Get an emoji icon for a product category
 * @param category - Product category name
 * @returns Emoji representing the category
 */
export function getCategoryIcon(category: string): string {
  const normalizedCategory = category.toLowerCase().trim();

  const categoryMap: Record<string, string> = {
    electronics: '',
    mobile: '',
    smartphone: '',
    phone: '',
    laptop: '',
    computer: '',
    gaming: '',
    headphones: '',
    audio: '',
    earbuds: '',
    camera: '',
    photography: '',
    watch: '',
    smartwatch: '',
    wearable: '',
    tv: '',
    television: '',
    appliances: '',
    home: '',
    kitchen: '',
    fashion: '',
    clothing: '',
    apparel: '',
    shoes: '',
    footwear: '',
    sports: '',
    fitness: '',
    books: '',
    reading: '',
    toys: '',
    kids: '',
    beauty: '',
    cosmetics: '',
    health: '',
    medicine: '',
    furniture: '',
    decor: '',
    tools: '',
    automotive: '',
    car: '',
    grocery: '',
    food: '',
    pet: '',
    pets: '',
    music: '',
    jewelry: '',
    bag: '',
    luggage: '',
  };

  // Check for exact match first
  if (categoryMap[normalizedCategory]) {
    return categoryMap[normalizedCategory];
  }

  // Check for partial matches
  for (const [key, icon] of Object.entries(categoryMap)) {
    if (normalizedCategory.includes(key) || key.includes(normalizedCategory)) {
      return icon;
    }
  }

  // Default icon
  return '';
}

/**
 * Get a color associated with an e-commerce platform
 * @param platform - Platform name
 * @returns Hex color code
 */
export function getPlatformColor(platform: string): string {
  const normalizedPlatform = platform.toLowerCase().trim();

  const platformColors: Record<string, string> = {
    amazon: '#FF9900',
    amazon_india: '#FF9900',
    flipkart: '#2874F0',
    myntra: '#FF3F6C',
    snapdeal: '#E40046',
    paytm: '#00BAF2',
    meesho: '#9F2089',
    ajio: '#212121',
    tata_cliq: '#C41E3A',
    shopsy: '#1976D2',
    jiomart: '#0057A2',
    bigbasket: '#84C225',
    default: '#757575',
  };

  return platformColors[normalizedPlatform] || platformColors.default;
}

/**
 * Get the display name for a platform
 * @param platform - Platform identifier
 * @returns Human-readable platform name
 */
export function getPlatformName(platform: string): string {
  const normalizedPlatform = platform.toLowerCase().trim();

  const platformNames: Record<string, string> = {
    amazon: 'Amazon',
    amazon_india: 'Amazon India',
    flipkart: 'Flipkart',
    myntra: 'Myntra',
    snapdeal: 'Snapdeal',
    paytm: 'Paytm Mall',
    meesho: 'Meesho',
    ajio: 'AJIO',
    tata_cliq: 'Tata CLiQ',
    shopsy: 'Shopsy',
    jiomart: 'JioMart',
    bigbasket: 'BigBasket',
  };

  return platformNames[normalizedPlatform] || platform;
}

/**
 * Get an arrow emoji representing a trend direction
 * @param trend - Trend direction ('rising', 'falling', 'stable', 'up', 'down')
 * @returns Arrow emoji
 */
export function getTrendIcon(trend: string): string {
  const normalizedTrend = trend.toLowerCase().trim();

  const trendIcons: Record<string, string> = {
    rising: '',
    up: '',
    increase: '',
    high: '',
    falling: '',
    down: '',
    decrease: '',
    low: '',
    stable: '',
    neutral: '',
    flat: '',
    unchanged: '',
  };

  return trendIcons[normalizedTrend] || '';
}

/**
 * Calculate savings between original and current price
 * @param original - Original price
 * @param current - Current price
 * @returns Object with savings amount and percentage
 */
export function calculateSavings(
  original: number,
  current: number
): { amount: number; percentage: number } {
  if (!original || original <= 0 || !current || current < 0) {
    return { amount: 0, percentage: 0 };
  }

  const amount = original - current;
  const percentage = (amount / original) * 100;

  return {
    amount: Math.max(0, amount),
    percentage: Math.max(0, Math.round(percentage * 10) / 10),
  };
}

/**
 * Truncate text to a specified length with ellipsis
 * @param text - Text to truncate
 * @param maxLength - Maximum length before truncation
 * @returns Truncated text
 */
export function truncateText(text: string, maxLength: number): string {
  if (!text) return '';
  if (text.length <= maxLength) return text;

  return text.substring(0, maxLength - 3) + '...';
}

/**
 * Format a number in a compact form (e.g., 1.2K, 3.5M)
 * @param num - Number to format
 * @returns Compact formatted string
 */
export function formatCompactNumber(num: number): string {
  if (!num || isNaN(num)) return '0';

  const absNum = Math.abs(num);
  const sign = num < 0 ? '-' : '';

  if (absNum >= 10000000) {
    // Crores (10 million)
    return `${sign}${(absNum / 10000000).toFixed(1)}Cr`;
  } else if (absNum >= 100000) {
    // Lakhs (100 thousand)
    return `${sign}${(absNum / 100000).toFixed(1)}L`;
  } else if (absNum >= 1000) {
    // Thousands
    return `${sign}${(absNum / 1000).toFixed(1)}K`;
  }

  return `${sign}${absNum}`;
}

/**
 * Get rating color based on rating value
 * @param rating - Rating value (0-5)
 * @returns Color hex code
 */
export function getRatingColor(rating: number): string {
  if (rating >= 4.5) return '#388e3c'; // Green
  if (rating >= 4.0) return '#689f38'; // Light green
  if (rating >= 3.5) return '#fbc02d'; // Yellow
  if (rating >= 3.0) return '#f57c00'; // Orange
  return '#d32f2f'; // Red
}

/**
 * Format availability status to human-readable text
 * @param availability - Availability status
 * @returns Human-readable availability text
 */
export function formatAvailability(availability: string): string {
  const statusMap: Record<string, string> = {
    in_stock: 'In Stock',
    out_of_stock: 'Out of Stock',
    limited_stock: 'Limited Stock',
    pre_order: 'Pre-Order',
    coming_soon: 'Coming Soon',
  };

  return statusMap[availability.toLowerCase()] || availability;
}
</file>

<file path="tsconfig.app.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "target": "ES2022",
    "useDefineForClassFields": true,
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "types": ["vite/client"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}
</file>

<file path="tsconfig.json">
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ]
}
</file>

<file path="tsconfig.node.json">
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "types": ["node"],
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}
</file>

<file path="vite.config.ts">
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})
</file>

</files>
